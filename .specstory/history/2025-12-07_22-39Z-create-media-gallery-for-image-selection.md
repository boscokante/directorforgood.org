<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 1da5b656-1e16-43ef-ad7d-5311863aac8d (2025-12-07 22:39Z) -->

# Create media gallery for image selection (2025-12-07 22:39Z)

_**User (2025-12-04 21:12Z)**_

Create and upload media gallery where I can look at all of the images that have been uploaded so I can pick them and use them for other things. 

---

_**Agent (model composer-1, mode Agent)**_



---


Exploring the codebase to understand how images are stored and managed.


---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "How are images stored and managed in Supabase storage?",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 62,
            "column": 1
          },
          "endPosition": {
            "line": 110,
            "column": 1
          }
        },
        "contents": "async function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {\n  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')\n  const localPath = path.join(WP_UPLOADS_PATH, relativePath)\n  \n  // Check if file exists locally\n  if (!fs.existsSync(localPath)) {\n    console.log(&#96;  ‚ö†Ô∏è  Not found locally: ${relativePath}&#96;)\n    return null\n  }\n  \n  // Read file\n  const fileBuffer = fs.readFileSync(localPath)\n  const mimeType = getMimeType(localPath)\n  \n  // Upload to Supabase\n  const { data, error } = await supabase.storage\n    .from(BUCKET_NAME)\n    .upload(relativePath, fileBuffer, {\n      contentType: mimeType,\n      upsert: true\n    })\n  \n  if (error) {\n    console.log(&#96;  ‚ùå Upload failed: ${relativePath} - ${error.message}&#96;)\n    return null\n  }\n  \n  // Return public URL\n  const { data: urlData } = supabase.storage\n    .from(BUCKET_NAME)\n    .getPublicUrl(relativePath)\n  \n  return urlData.publicUrl\n}\n\nfunction getMimeType(filePath: string): string {\n  const ext = path.extname(filePath).toLowerCase()\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {",
            "lineNumber": 65,
            "isSignature": true
          },
          {
            "text": "  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')",
            "lineNumber": 66
          },
          {
            "text": "  const localPath = path.join(WP_UPLOADS_PATH, relativePath)",
            "lineNumber": 67
          },
          {
            "text": "  ",
            "lineNumber": 68
          },
          {
            "text": "  // Check if file exists locally",
            "lineNumber": 69
          },
          {
            "text": "  if (!fs.existsSync(localPath)) {",
            "lineNumber": 70
          },
          {
            "text": "    console.log(&#96;  ‚ö†Ô∏è  Not found locally: ${relativePath}&#96;)",
            "lineNumber": 71
          },
          {
            "text": "    return null",
            "lineNumber": 72
          },
          {
            "text": "  }",
            "lineNumber": 73
          },
          {
            "text": "  ",
            "lineNumber": 74
          },
          {
            "text": "  // Read file",
            "lineNumber": 75
          },
          {
            "text": "  const fileBuffer = fs.readFileSync(localPath)",
            "lineNumber": 76
          },
          {
            "text": "  const mimeType = getMimeType(localPath)",
            "lineNumber": 77
          },
          {
            "text": "  ",
            "lineNumber": 78
          },
          {
            "text": "  // Upload to Supabase",
            "lineNumber": 79
          },
          {
            "text": "  const { data, error } = await supabase.storage",
            "lineNumber": 80
          },
          {
            "text": "    .from(BUCKET_NAME)",
            "lineNumber": 81
          },
          {
            "text": "    .upload(relativePath, fileBuffer, {",
            "lineNumber": 82
          },
          {
            "text": "      contentType: mimeType,",
            "lineNumber": 83
          },
          {
            "text": "      upsert: true",
            "lineNumber": 84
          },
          {
            "text": "    })",
            "lineNumber": 85
          },
          {
            "text": "  ",
            "lineNumber": 86
          },
          {
            "text": "  if (error) {",
            "lineNumber": 87
          },
          {
            "text": "    console.log(&#96;  ‚ùå Upload failed: ${relativePath} - ${error.message}&#96;)",
            "lineNumber": 88
          },
          {
            "text": "    return null",
            "lineNumber": 89
          },
          {
            "text": "  }",
            "lineNumber": 90
          },
          {
            "text": "  ",
            "lineNumber": 91
          },
          {
            "text": "  // Return public URL",
            "lineNumber": 92
          },
          {
            "text": "  const { data: urlData } = supabase.storage",
            "lineNumber": 93
          },
          {
            "text": "    .from(BUCKET_NAME)",
            "lineNumber": 94
          },
          {
            "text": "    .getPublicUrl(relativePath)",
            "lineNumber": 95
          },
          {
            "text": "  ",
            "lineNumber": 96
          },
          {
            "text": "  return urlData.publicUrl",
            "lineNumber": 97
          },
          {
            "text": "}",
            "lineNumber": 98,
            "isSignature": true
          },
          {
            "lineNumber": 99
          },
          {
            "text": "function getMimeType(filePath: string): string {",
            "lineNumber": 100,
            "isSignature": true
          },
          {
            "text": "  const ext = path.extname(filePath).toLowerCase()",
            "lineNumber": 101
          },
          {
            "text": "}",
            "lineNumber": 111,
            "isSignature": true
          }
        ]
      },
      "score": 0.5309493541717529
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/setup-supabase-storage.ts",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 122,
            "column": 1
          }
        },
        "contents": "async function main() {\n\n\n  if (existingBucket) {\n    console.log(&#96;‚úÖ Bucket \"${BUCKET_NAME}\" already exists&#96;)\n    console.log(&#96;   Public: ${existingBucket.public}&#96;)\n    console.log(&#96;   Created: ${existingBucket.created_at}&#96;)\n    \n    if (!existingBucket.public) {\n      console.log('\\n‚ö†Ô∏è  Bucket is not public. Making it public...')\n      const { error: updateError } = await supabase.storage.updateBucket(BUCKET_NAME, {\n        public: true\n      })\n      if (updateError) {\n        console.error('‚ùå Failed to make bucket public:', updateError.message)\n      } else {\n        console.log('‚úÖ Bucket is now public')\n      }\n    }\n  } else {\n    // Create the bucket\n    console.log(&#96;üì¶ Creating bucket \"${BUCKET_NAME}\"...&#96;)\n    \n    const { data, error: createError } = await supabase.storage.createBucket(BUCKET_NAME, {\n      public: true,\n      fileSizeLimit: 52428800, // 50MB max file size\n      allowedMimeTypes: [\n        'image/jpeg',\n        'image/png',\n        'image/gif',\n        'image/webp',\n        'image/svg+xml',\n        'video/mp4',\n        'video/webm',\n        'application/pdf'\n      ]\n    })\n\n    if (createError) {\n      console.error('‚ùå Failed to create bucket:', createError.message)\n      process.exit(1)\n    }\n\n    console.log('‚úÖ Bucket created successfully!')\n  }\n\n  // Print helpful info\n  console.log('\\n' + '='.repeat(60))\n  console.log('üìã Storage Configuration')\n  console.log('='.repeat(60))\n  console.log(&#96;\\nBucket URL: ${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/&#96;)\n  console.log(&#96;\\nExample image URL after migration:&#96;)\n  console.log(&#96;  ${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/2024/02/image.jpg&#96;)\n  \n  console.log('\\n‚ú® Storage is ready! You can now run:')\n  console.log('   npm run wp:migrate-images')\n  \n  process.exit(0)\n}\n\nmain().catch(err =&gt; {\n  console.error('‚ùå Setup failed:', err)\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "async function main() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "  if (existingBucket) {",
            "lineNumber": 63
          },
          {
            "text": "    console.log(&#96;‚úÖ Bucket \"${BUCKET_NAME}\" already exists&#96;)",
            "lineNumber": 64
          },
          {
            "text": "    console.log(&#96;   Public: ${existingBucket.public}&#96;)",
            "lineNumber": 65
          },
          {
            "text": "    console.log(&#96;   Created: ${existingBucket.created_at}&#96;)",
            "lineNumber": 66
          },
          {
            "text": "    ",
            "lineNumber": 67
          },
          {
            "text": "    if (!existingBucket.public) {",
            "lineNumber": 68
          },
          {
            "text": "      console.log('\\n‚ö†Ô∏è  Bucket is not public. Making it public...')",
            "lineNumber": 69
          },
          {
            "text": "      const { error: updateError } = await supabase.storage.updateBucket(BUCKET_NAME, {",
            "lineNumber": 70
          },
          {
            "text": "        public: true",
            "lineNumber": 71
          },
          {
            "text": "      })",
            "lineNumber": 72
          },
          {
            "text": "      if (updateError) {",
            "lineNumber": 73
          },
          {
            "text": "        console.error('‚ùå Failed to make bucket public:', updateError.message)",
            "lineNumber": 74
          },
          {
            "text": "      } else {",
            "lineNumber": 75
          },
          {
            "text": "        console.log('‚úÖ Bucket is now public')",
            "lineNumber": 76
          },
          {
            "text": "      }",
            "lineNumber": 77
          },
          {
            "text": "    }",
            "lineNumber": 78
          },
          {
            "text": "  } else {",
            "lineNumber": 79
          },
          {
            "text": "    // Create the bucket",
            "lineNumber": 80
          },
          {
            "text": "    console.log(&#96;üì¶ Creating bucket \"${BUCKET_NAME}\"...&#96;)",
            "lineNumber": 81
          },
          {
            "text": "    ",
            "lineNumber": 82
          },
          {
            "text": "    const { data, error: createError } = await supabase.storage.createBucket(BUCKET_NAME, {",
            "lineNumber": 83
          },
          {
            "text": "      public: true,",
            "lineNumber": 84
          },
          {
            "text": "      fileSizeLimit: 52428800, // 50MB max file size",
            "lineNumber": 85
          },
          {
            "text": "      allowedMimeTypes: [",
            "lineNumber": 86
          },
          {
            "text": "        'image/jpeg',",
            "lineNumber": 87
          },
          {
            "text": "        'image/png',",
            "lineNumber": 88
          },
          {
            "text": "        'image/gif',",
            "lineNumber": 89
          },
          {
            "text": "        'image/webp',",
            "lineNumber": 90
          },
          {
            "text": "        'image/svg+xml',",
            "lineNumber": 91
          },
          {
            "text": "        'video/mp4',",
            "lineNumber": 92
          },
          {
            "text": "        'video/webm',",
            "lineNumber": 93
          },
          {
            "text": "        'application/pdf'",
            "lineNumber": 94
          },
          {
            "text": "      ]",
            "lineNumber": 95
          },
          {
            "text": "    })",
            "lineNumber": 96
          },
          {
            "lineNumber": 97
          },
          {
            "text": "    if (createError) {",
            "lineNumber": 98
          },
          {
            "text": "      console.error('‚ùå Failed to create bucket:', createError.message)",
            "lineNumber": 99
          },
          {
            "text": "      process.exit(1)",
            "lineNumber": 100
          },
          {
            "text": "    }",
            "lineNumber": 101
          },
          {
            "lineNumber": 102
          },
          {
            "text": "    console.log('‚úÖ Bucket created successfully!')",
            "lineNumber": 103
          },
          {
            "text": "  }",
            "lineNumber": 104
          },
          {
            "lineNumber": 105
          },
          {
            "text": "  // Print helpful info",
            "lineNumber": 106
          },
          {
            "text": "  console.log('\\n' + '='.repeat(60))",
            "lineNumber": 107
          },
          {
            "text": "  console.log('üìã Storage Configuration')",
            "lineNumber": 108
          },
          {
            "text": "  console.log('='.repeat(60))",
            "lineNumber": 109
          },
          {
            "text": "  console.log(&#96;\\nBucket URL: ${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/&#96;)",
            "lineNumber": 110
          },
          {
            "text": "  console.log(&#96;\\nExample image URL after migration:&#96;)",
            "lineNumber": 111
          },
          {
            "text": "  console.log(&#96;  ${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/2024/02/image.jpg&#96;)",
            "lineNumber": 112
          },
          {
            "text": "  ",
            "lineNumber": 113
          },
          {
            "text": "  console.log('\\n‚ú® Storage is ready! You can now run:')",
            "lineNumber": 114
          },
          {
            "text": "  console.log('   npm run wp:migrate-images')",
            "lineNumber": 115
          },
          {
            "text": "  ",
            "lineNumber": 116
          },
          {
            "text": "  process.exit(0)",
            "lineNumber": 117
          },
          {
            "text": "}",
            "lineNumber": 118,
            "isSignature": true
          },
          {
            "lineNumber": 119
          },
          {
            "text": "main().catch(err =&gt; {",
            "lineNumber": 120
          },
          {
            "text": "  console.error('‚ùå Setup failed:', err)",
            "lineNumber": 121
          },
          {
            "text": "}",
            "lineNumber": 123
          }
        ]
      },
      "score": 0.49141308665275574
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 164,
            "column": 1
          },
          "endPosition": {
            "line": 219,
            "column": 1
          }
        },
        "contents": "async function main() {\n  console.log('üöÄ Starting image migration to Supabase Storage\\n')\n  \n  // Dynamically import db modules after env is loaded\n  const dbModule = await import('../db')\n  const schemaModule = await import('../db/schema')\n  const drizzleModule = await import('drizzle-orm')\n  db = dbModule.db\n  posts = schemaModule.posts\n  pages = schemaModule.pages\n  eq = drizzleModule.eq\n  \n  console.log(&#96;üìÅ Local WordPress uploads: ${WP_UPLOADS_PATH}&#96;)\n  console.log(&#96;‚òÅÔ∏è  Supabase URL: ${SUPABASE_URL}&#96;)\n  console.log(&#96;ü™£ Bucket: ${BUCKET_NAME}\\n&#96;)\n  \n  // Extract all image URLs from database\n  console.log('üîç Extracting image URLs from database...')\n  const wpUrls = await extractImageUrls()\n  console.log(&#96;   Found ${wpUrls.size} unique images\\n&#96;)\n  \n  // Upload each image and build URL map\n  console.log('üì§ Uploading images to Supabase...')\n  const urlMap = new Map&lt;string, string&gt;()\n  let uploaded = 0\n  let failed = 0\n  \n  for (const wpUrl of wpUrls) {\n    const newUrl = await uploadImage(wpUrl)\n    if (newUrl) {\n      urlMap.set(wpUrl, newUrl)\n      uploaded++\n      console.log(&#96;  ‚úì [${uploaded}/${wpUrls.size}] ${path.basename(wpUrl)}&#96;)\n    } else {\n      failed++\n    }\n  }\n  \n  console.log(&#96;\\n‚úÖ Uploaded: ${uploaded}&#96;)\n  console.log(&#96;‚ùå Failed: ${failed}&#96;)\n  \n  // Update database with new URLs\n  if (urlMap.size &gt; 0) {\n    await updateDatabaseUrls(urlMap)\n  }\n  \n  console.log('\\nüéâ Migration complete!')\n  process.exit(0)\n}\n\nmain().catch(err =&gt; {\n  console.error('‚ùå Migration failed:', err)\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function main() {",
            "lineNumber": 167,
            "isSignature": true
          },
          {
            "text": "  console.log('üöÄ Starting image migration to Supabase Storage\\n')",
            "lineNumber": 168
          },
          {
            "text": "  ",
            "lineNumber": 169
          },
          {
            "text": "  // Dynamically import db modules after env is loaded",
            "lineNumber": 170
          },
          {
            "text": "  const dbModule = await import('../db')",
            "lineNumber": 171
          },
          {
            "text": "  const schemaModule = await import('../db/schema')",
            "lineNumber": 172
          },
          {
            "text": "  const drizzleModule = await import('drizzle-orm')",
            "lineNumber": 173
          },
          {
            "text": "  db = dbModule.db",
            "lineNumber": 174
          },
          {
            "text": "  posts = schemaModule.posts",
            "lineNumber": 175
          },
          {
            "text": "  pages = schemaModule.pages",
            "lineNumber": 176
          },
          {
            "text": "  eq = drizzleModule.eq",
            "lineNumber": 177
          },
          {
            "text": "  ",
            "lineNumber": 178
          },
          {
            "text": "  console.log(&#96;üìÅ Local WordPress uploads: ${WP_UPLOADS_PATH}&#96;)",
            "lineNumber": 179
          },
          {
            "text": "  console.log(&#96;‚òÅÔ∏è  Supabase URL: ${SUPABASE_URL}&#96;)",
            "lineNumber": 180
          },
          {
            "text": "  console.log(&#96;ü™£ Bucket: ${BUCKET_NAME}\\n&#96;)",
            "lineNumber": 181
          },
          {
            "text": "  ",
            "lineNumber": 182
          },
          {
            "text": "  // Extract all image URLs from database",
            "lineNumber": 183
          },
          {
            "text": "  console.log('üîç Extracting image URLs from database...')",
            "lineNumber": 184
          },
          {
            "text": "  const wpUrls = await extractImageUrls()",
            "lineNumber": 185
          },
          {
            "text": "  console.log(&#96;   Found ${wpUrls.size} unique images\\n&#96;)",
            "lineNumber": 186
          },
          {
            "text": "  ",
            "lineNumber": 187
          },
          {
            "text": "  // Upload each image and build URL map",
            "lineNumber": 188
          },
          {
            "text": "  console.log('üì§ Uploading images to Supabase...')",
            "lineNumber": 189
          },
          {
            "text": "  const urlMap = new Map&lt;string, string&gt;()",
            "lineNumber": 190
          },
          {
            "text": "  let uploaded = 0",
            "lineNumber": 191
          },
          {
            "text": "  let failed = 0",
            "lineNumber": 192
          },
          {
            "text": "  ",
            "lineNumber": 193
          },
          {
            "text": "  for (const wpUrl of wpUrls) {",
            "lineNumber": 194
          },
          {
            "text": "    const newUrl = await uploadImage(wpUrl)",
            "lineNumber": 195
          },
          {
            "text": "    if (newUrl) {",
            "lineNumber": 196
          },
          {
            "text": "      urlMap.set(wpUrl, newUrl)",
            "lineNumber": 197
          },
          {
            "text": "      uploaded++",
            "lineNumber": 198
          },
          {
            "text": "      console.log(&#96;  ‚úì [${uploaded}/${wpUrls.size}] ${path.basename(wpUrl)}&#96;)",
            "lineNumber": 199
          },
          {
            "text": "    } else {",
            "lineNumber": 200
          },
          {
            "text": "      failed++",
            "lineNumber": 201
          },
          {
            "text": "    }",
            "lineNumber": 202
          },
          {
            "text": "  }",
            "lineNumber": 203
          },
          {
            "text": "  ",
            "lineNumber": 204
          },
          {
            "text": "  console.log(&#96;\\n‚úÖ Uploaded: ${uploaded}&#96;)",
            "lineNumber": 205
          },
          {
            "text": "  console.log(&#96;‚ùå Failed: ${failed}&#96;)",
            "lineNumber": 206
          },
          {
            "text": "  ",
            "lineNumber": 207
          },
          {
            "text": "  // Update database with new URLs",
            "lineNumber": 208
          },
          {
            "text": "  if (urlMap.size &gt; 0) {",
            "lineNumber": 209
          },
          {
            "text": "    await updateDatabaseUrls(urlMap)",
            "lineNumber": 210
          },
          {
            "text": "  }",
            "lineNumber": 211
          },
          {
            "text": "  ",
            "lineNumber": 212
          },
          {
            "text": "  console.log('\\nüéâ Migration complete!')",
            "lineNumber": 213
          },
          {
            "text": "  process.exit(0)",
            "lineNumber": 214
          },
          {
            "text": "}",
            "lineNumber": 215,
            "isSignature": true
          },
          {
            "lineNumber": 216
          },
          {
            "text": "main().catch(err =&gt; {",
            "lineNumber": 217
          },
          {
            "text": "  console.error('‚ùå Migration failed:', err)",
            "lineNumber": 218
          },
          {
            "text": "}",
            "lineNumber": 220
          }
        ]
      },
      "score": 0.461590051651001
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/WORDPRESS_MIGRATION_PLAYBOOK.md",
        "range": {
          "startPosition": {
            "line": 70
          },
          "endPosition": {
            "line": 154
          }
        },
        "contents": "1. Go to https://supabase.com/dashboard\n2. Create new project\n3. Note the project ID and region\n\n**Project details:**\n- ID: &#96;pzoyeigicwgmmlngxowj&#96;\n- Region: &#96;us-west-2&#96;\n\n### 2.2 Configure Environment\n&#96;&#96;&#96;bash\n# .env.local\nDATABASE_URL=\"postgresql://postgres.[project-id]:[password]@aws-0-us-west-2.pooler.supabase.com:5432/postgres\"\n&#96;&#96;&#96;\n\n### 2.3 Push Schema\n&#96;&#96;&#96;bash\nnpm run db:push\n&#96;&#96;&#96;\n\n**Automation opportunity:** CLI tool that creates Supabase project and configures env vars automatically.\n\n---\n\n## Phase 3: Content Migration ‚úÖ\n\n### 3.1 Import Posts &amp; Pages\n&#96;&#96;&#96;bash\n# Fetches all content via WordPress REST API\nWP_BASE=https://your-site.com/wp-json/wp/v2 npm run wp:import\n&#96;&#96;&#96;\n\n**What gets imported:**\n- Posts ‚Üí &#96;posts&#96; table (title, content, excerpt, cover image URL, tags, SEO fields)\n- Pages ‚Üí &#96;pages&#96; table (title, content, SEO fields)\n\n**Content is converted:**\n- HTML ‚Üí Markdown (via Turndown)\n- Dates preserved\n- Slugs sanitized\n\n**Completed:** 21 posts, 29 pages imported\n\n### 3.2 Verify Import\n&#96;&#96;&#96;bash\nnpx tsx scripts/check-db-content.ts\n&#96;&#96;&#96;\n\n---\n\n## Phase 4: Image Migration ‚úÖ COMPLETE\n\n### 4.1 Create Storage Bucket\n1. Go to Supabase Dashboard ‚Üí Storage\n2. Create bucket named &#96;uploads&#96;\n3. Set to **Public**\n\n### 4.2 Add Storage Credentials\n&#96;&#96;&#96;bash\n# Add to .env.local\nNEXT_PUBLIC_SUPABASE_URL=\"https://[project-id].supabase.co\"\nSUPABASE_SERVICE_ROLE_KEY=\"your-service-role-key\"  # Needed for uploads (bypasses RLS)\n&#96;&#96;&#96;\n\n### 4.3 Run Image Migration\n&#96;&#96;&#96;bash\nnpm run wp:migrate-images\n&#96;&#96;&#96;\n\n**What this does:**\n1. Scans database for all &#96;hiiiwav.org/wp-content/uploads/&#96; URLs\n2. Finds corresponding files in local WordPress installation\n3. Uploads to Supabase Storage\n4. Updates all URLs in database\n\n**Completed: December 7, 2024**\n- Images uploaded: 356 ‚úÖ\n- Failed: 1 (special character in filename)\n- Posts updated: 20\n- Pages updated: 22\n- Storage URL: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/&#96;\n\n### 4.4 Automation Opportunity: Auto-Create Storage Bucket\n\n&#96;&#96;&#96;typescript",
        "signatures": {},
        "detailedLines": [
          {
            "text": "1. Go to https://supabase.com/dashboard",
            "lineNumber": 71
          },
          {
            "text": "2. Create new project",
            "lineNumber": 72
          },
          {
            "text": "3. Note the project ID and region",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "**Project details:**",
            "lineNumber": 75
          },
          {
            "text": "- ID: &#96;pzoyeigicwgmmlngxowj&#96;",
            "lineNumber": 76
          },
          {
            "text": "- Region: &#96;us-west-2&#96;",
            "lineNumber": 77
          },
          {
            "lineNumber": 78
          },
          {
            "text": "### 2.2 Configure Environment",
            "lineNumber": 79
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 80
          },
          {
            "text": "# .env.local",
            "lineNumber": 81
          },
          {
            "text": "DATABASE_URL=\"postgresql://postgres.[project-id]:[password]@aws-0-us-west-2.pooler.supabase.com:5432/postgres\"",
            "lineNumber": 82
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 83
          },
          {
            "lineNumber": 84
          },
          {
            "text": "### 2.3 Push Schema",
            "lineNumber": 85
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 86
          },
          {
            "text": "npm run db:push",
            "lineNumber": 87
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 88
          },
          {
            "lineNumber": 89
          },
          {
            "text": "**Automation opportunity:** CLI tool that creates Supabase project and configures env vars automatically.",
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "text": "---",
            "lineNumber": 92
          },
          {
            "lineNumber": 93
          },
          {
            "text": "## Phase 3: Content Migration ‚úÖ",
            "lineNumber": 94
          },
          {
            "lineNumber": 95
          },
          {
            "text": "### 3.1 Import Posts &amp; Pages",
            "lineNumber": 96
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 97
          },
          {
            "text": "# Fetches all content via WordPress REST API",
            "lineNumber": 98
          },
          {
            "text": "WP_BASE=https://your-site.com/wp-json/wp/v2 npm run wp:import",
            "lineNumber": 99
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 100
          },
          {
            "lineNumber": 101
          },
          {
            "text": "**What gets imported:**",
            "lineNumber": 102
          },
          {
            "text": "- Posts ‚Üí &#96;posts&#96; table (title, content, excerpt, cover image URL, tags, SEO fields)",
            "lineNumber": 103
          },
          {
            "text": "- Pages ‚Üí &#96;pages&#96; table (title, content, SEO fields)",
            "lineNumber": 104
          },
          {
            "lineNumber": 105
          },
          {
            "text": "**Content is converted:**",
            "lineNumber": 106
          },
          {
            "text": "- HTML ‚Üí Markdown (via Turndown)",
            "lineNumber": 107
          },
          {
            "text": "- Dates preserved",
            "lineNumber": 108
          },
          {
            "text": "- Slugs sanitized",
            "lineNumber": 109
          },
          {
            "lineNumber": 110
          },
          {
            "text": "**Completed:** 21 posts, 29 pages imported",
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "### 3.2 Verify Import",
            "lineNumber": 113
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 114
          },
          {
            "text": "npx tsx scripts/check-db-content.ts",
            "lineNumber": 115
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "---",
            "lineNumber": 118
          },
          {
            "lineNumber": 119
          },
          {
            "text": "## Phase 4: Image Migration ‚úÖ COMPLETE",
            "lineNumber": 120
          },
          {
            "lineNumber": 121
          },
          {
            "text": "### 4.1 Create Storage Bucket",
            "lineNumber": 122
          },
          {
            "text": "1. Go to Supabase Dashboard ‚Üí Storage",
            "lineNumber": 123
          },
          {
            "text": "2. Create bucket named &#96;uploads&#96;",
            "lineNumber": 124
          },
          {
            "text": "3. Set to **Public**",
            "lineNumber": 125
          },
          {
            "lineNumber": 126
          },
          {
            "text": "### 4.2 Add Storage Credentials",
            "lineNumber": 127
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 128
          },
          {
            "text": "# Add to .env.local",
            "lineNumber": 129
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_URL=\"https://[project-id].supabase.co\"",
            "lineNumber": 130
          },
          {
            "text": "SUPABASE_SERVICE_ROLE_KEY=\"your-service-role-key\"  # Needed for uploads (bypasses RLS)",
            "lineNumber": 131
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 132
          },
          {
            "lineNumber": 133
          },
          {
            "text": "### 4.3 Run Image Migration",
            "lineNumber": 134
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 135
          },
          {
            "text": "npm run wp:migrate-images",
            "lineNumber": 136
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 137
          },
          {
            "lineNumber": 138
          },
          {
            "text": "**What this does:**",
            "lineNumber": 139
          },
          {
            "text": "1. Scans database for all &#96;hiiiwav.org/wp-content/uploads/&#96; URLs",
            "lineNumber": 140
          },
          {
            "text": "2. Finds corresponding files in local WordPress installation",
            "lineNumber": 141
          },
          {
            "text": "3. Uploads to Supabase Storage",
            "lineNumber": 142
          },
          {
            "text": "4. Updates all URLs in database",
            "lineNumber": 143
          },
          {
            "lineNumber": 144
          },
          {
            "text": "**Completed: December 7, 2024**",
            "lineNumber": 145
          },
          {
            "text": "- Images uploaded: 356 ‚úÖ",
            "lineNumber": 146
          },
          {
            "text": "- Failed: 1 (special character in filename)",
            "lineNumber": 147
          },
          {
            "text": "- Posts updated: 20",
            "lineNumber": 148
          },
          {
            "text": "- Pages updated: 22",
            "lineNumber": 149
          },
          {
            "text": "- Storage URL: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/&#96;",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "### 4.4 Automation Opportunity: Auto-Create Storage Bucket",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 154
          }
        ]
      },
      "score": 0.4554573893547058
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 13,
            "column": 54
          },
          "endPosition": {
            "line": 97,
            "column": 1
          }
        },
        "contents": "// Now import everything else\nimport { createClient } from '@supabase/supabase-js'\nimport * as fs from 'fs'\nimport * as path from 'path'\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY\nconst WP_UPLOADS_PATH = '/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/app/public/wp-content/uploads'\nconst BUCKET_NAME = 'uploads'\n\nif (!SUPABASE_URL || !SUPABASE_SERVICE_KEY) {\n  console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in .env.local')\n  console.log('\\nThe service role key is needed to bypass RLS for uploads.')\n  console.log('Get it from: https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj/settings/api')\n  process.exit(1)\n}\n\n// Use service role key to bypass RLS\nconst supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {\n  auth: { persistSession: false }\n})\n\n// Dynamically import db after env is loaded\nlet db: Awaited&lt;typeof import('../db')&gt;['db']\nlet posts: typeof import('../db/schema')['posts']\nlet pages: typeof import('../db/schema')['pages']\nlet eq: typeof import('drizzle-orm')['eq']\n\nasync function extractImageUrls(): Promise&lt;Set&lt;string&gt;&gt; {\n  const allPosts = await db.select().from(posts)\n  const allPages = await db.select().from(pages)\n  \n  const urls = new Set&lt;string&gt;()\n  \n  ;[...allPosts, ...allPages].forEach(item =&gt; {\n    // Cover images\n    if ('coverImage' in item &amp;&amp; item.coverImage?.includes('hiiiwav.org/wp-content/uploads')) {\n      urls.add(item.coverImage)\n    }\n    \n    // Images in content\n    const imgRegex = /https?:\\/\\/hiiiwav\\.org\\/wp-content\\/uploads\\/[^\\s\\)\\\"\\']+/g\n    const matches = item.content.match(imgRegex) || []\n    matches.forEach(m =&gt; urls.add(m.replace(/[)\\]\"']$/, ''))) // Clean trailing chars\n  })\n  \n  return urls\n}\n\nasync function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {\n  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// Now import everything else",
            "lineNumber": 16
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 17
          },
          {
            "text": "import * as fs from 'fs'",
            "lineNumber": 18
          },
          {
            "text": "import * as path from 'path'",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "const SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL",
            "lineNumber": 21
          },
          {
            "text": "const SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY",
            "lineNumber": 22
          },
          {
            "text": "const WP_UPLOADS_PATH = '/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/app/public/wp-content/uploads'",
            "lineNumber": 23
          },
          {
            "text": "const BUCKET_NAME = 'uploads'",
            "lineNumber": 24
          },
          {
            "lineNumber": 25
          },
          {
            "text": "if (!SUPABASE_URL || !SUPABASE_SERVICE_KEY) {",
            "lineNumber": 26
          },
          {
            "text": "  console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in .env.local')",
            "lineNumber": 27
          },
          {
            "text": "  console.log('\\nThe service role key is needed to bypass RLS for uploads.')",
            "lineNumber": 28
          },
          {
            "text": "  console.log('Get it from: https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj/settings/api')",
            "lineNumber": 29
          },
          {
            "text": "  process.exit(1)",
            "lineNumber": 30
          },
          {
            "text": "}",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "// Use service role key to bypass RLS",
            "lineNumber": 33
          },
          {
            "text": "const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {",
            "lineNumber": 34
          },
          {
            "text": "  auth: { persistSession: false }",
            "lineNumber": 35
          },
          {
            "text": "})",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "// Dynamically import db after env is loaded",
            "lineNumber": 38
          },
          {
            "text": "let db: Awaited&lt;typeof import('../db')&gt;['db']",
            "lineNumber": 39
          },
          {
            "text": "let posts: typeof import('../db/schema')['posts']",
            "lineNumber": 40
          },
          {
            "text": "let pages: typeof import('../db/schema')['pages']",
            "lineNumber": 41
          },
          {
            "text": "let eq: typeof import('drizzle-orm')['eq']",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "async function extractImageUrls(): Promise&lt;Set&lt;string&gt;&gt; {",
            "lineNumber": 44,
            "isSignature": true
          },
          {
            "text": "  const allPosts = await db.select().from(posts)",
            "lineNumber": 45
          },
          {
            "text": "  const allPages = await db.select().from(pages)",
            "lineNumber": 46
          },
          {
            "text": "  ",
            "lineNumber": 47
          },
          {
            "text": "  const urls = new Set&lt;string&gt;()",
            "lineNumber": 48
          },
          {
            "text": "  ",
            "lineNumber": 49
          },
          {
            "text": "  ;[...allPosts, ...allPages].forEach(item =&gt; {",
            "lineNumber": 50
          },
          {
            "text": "    // Cover images",
            "lineNumber": 51
          },
          {
            "text": "    if ('coverImage' in item &amp;&amp; item.coverImage?.includes('hiiiwav.org/wp-content/uploads')) {",
            "lineNumber": 52
          },
          {
            "text": "      urls.add(item.coverImage)",
            "lineNumber": 53
          },
          {
            "text": "    }",
            "lineNumber": 54
          },
          {
            "text": "    ",
            "lineNumber": 55
          },
          {
            "text": "    // Images in content",
            "lineNumber": 56
          },
          {
            "text": "    const imgRegex = /https?:\\/\\/hiiiwav\\.org\\/wp-content\\/uploads\\/[^\\s\\)\\\"\\']+/g",
            "lineNumber": 57
          },
          {
            "text": "    const matches = item.content.match(imgRegex) || []",
            "lineNumber": 58
          },
          {
            "text": "    matches.forEach(m =&gt; urls.add(m.replace(/[)\\]\"']$/, ''))) // Clean trailing chars",
            "lineNumber": 59
          },
          {
            "text": "  })",
            "lineNumber": 60
          },
          {
            "text": "  ",
            "lineNumber": 61
          },
          {
            "text": "  return urls",
            "lineNumber": 62
          },
          {
            "text": "}",
            "lineNumber": 63,
            "isSignature": true
          },
          {
            "lineNumber": 64
          },
          {
            "text": "async function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {",
            "lineNumber": 65,
            "isSignature": true
          },
          {
            "text": "  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')",
            "lineNumber": 66
          },
          {
            "text": "}",
            "lineNumber": 98,
            "isSignature": true
          }
        ]
      },
      "score": 0.42855170369148254
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 16,
            "column": 52
          }
        },
        "contents": "/**\n * Migrate WordPress images to Supabase Storage\n * \n * Prerequisites:\n * 1. Create a public bucket named \"uploads\" in Supabase Storage\n * 2. Add NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY to .env.local\n * \n * Usage: npx tsx scripts/migrate-images-to-supabase.ts\n */\n\n// Load env FIRST before any other imports\nimport { config } from 'dotenv'\nimport { resolve } from 'path'\nconfig({ path: resolve(process.cwd(), '.env.local') })\n\n// Now import everything else\nimport { createClient } from '@supabase/supabase-js'",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * Migrate WordPress images to Supabase Storage",
            "lineNumber": 2
          },
          {
            "text": " * ",
            "lineNumber": 3
          },
          {
            "text": " * Prerequisites:",
            "lineNumber": 4
          },
          {
            "text": " * 1. Create a public bucket named \"uploads\" in Supabase Storage",
            "lineNumber": 5
          },
          {
            "text": " * 2. Add NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY to .env.local",
            "lineNumber": 6
          },
          {
            "text": " * ",
            "lineNumber": 7
          },
          {
            "text": " * Usage: npx tsx scripts/migrate-images-to-supabase.ts",
            "lineNumber": 8
          },
          {
            "text": " */",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "// Load env FIRST before any other imports",
            "lineNumber": 11
          },
          {
            "text": "import { config } from 'dotenv'",
            "lineNumber": 12
          },
          {
            "text": "import { resolve } from 'path'",
            "lineNumber": 13
          },
          {
            "text": "config({ path: resolve(process.cwd(), '.env.local') })",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "// Now import everything else",
            "lineNumber": 16
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 17
          }
        ]
      },
      "score": 0.40745440125465393
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/schema.ts",
        "range": {
          "startPosition": {
            "line": 38,
            "column": 2
          },
          "endPosition": {
            "line": 77
          }
        },
        "contents": "export const media = pgTable('media', {\n  id: serial('id').primaryKey(),\n  filename: text('filename').notNull(),\n  url: text('url').notNull(),\n  mimeType: text('mime_type'),\n  size: integer('size'),\n  altText: text('alt_text'),\n  uploadedBy: integer('uploaded_by').references(() =&gt; users.id),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n})\n\n// Entities: HiiiWAV org, participant artists, and staff members\nexport const entities = pgTable",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export const media = pgTable('media', {",
            "lineNumber": 41
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 42
          },
          {
            "text": "  filename: text('filename').notNull(),",
            "lineNumber": 43
          },
          {
            "text": "  url: text('url').notNull(),",
            "lineNumber": 44
          },
          {
            "text": "  mimeType: text('mime_type'),",
            "lineNumber": 45
          },
          {
            "text": "  size: integer('size'),",
            "lineNumber": 46
          },
          {
            "text": "  altText: text('alt_text'),",
            "lineNumber": 47
          },
          {
            "text": "  uploadedBy: integer('uploaded_by').references(() =&gt; users.id),",
            "lineNumber": 48
          },
          {
            "text": "  createdAt: timestamp('created_at').defaultNow().notNull(),",
            "lineNumber": 49
          },
          {
            "text": "})",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "// Entities: HiiiWAV org, participant artists, and staff members",
            "lineNumber": 52
          },
          {
            "text": "export const entities = pgTable",
            "lineNumber": 53
          }
        ]
      },
      "score": 0.3890847861766815
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/setup-supabase-storage.ts",
        "range": {
          "startPosition": {
            "line": 12,
            "column": 54
          },
          "endPosition": {
            "line": 117,
            "column": 1
          }
        },
        "contents": "import { createClient } from '@supabase/supabase-js'\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY\nconst BUCKET_NAME = 'uploads'\n\nasync function main() {\n  console.log('üöÄ Setting up Supabase Storage\\n')\n\n  // Validate environment\n  if (!SUPABASE_URL) {\n    console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL in .env.local')\n    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')\n    process.exit(1)\n  }\n\n  if (!SUPABASE_SERVICE_KEY) {\n    console.error('‚ùå Missing SUPABASE_SERVICE_ROLE_KEY in .env.local')\n    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')\n    console.log('(Look for \"service_role\" key - keep this secret!)\\n')\n    \n    // Provide the exact URL for their project\n    const projectId = SUPABASE_URL.match(/https:\\/\\/([^.]+)/)?.[1]\n    if (projectId) {\n      console.log(&#96;Direct link: https://supabase.com/dashboard/project/${projectId}/settings/api&#96;)\n    }\n    process.exit(1)\n  }\n\n  // Create admin client with service role key\n  const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {\n    auth: { persistSession: false }\n  })\n\n  console.log(&#96;üìç Supabase URL: ${SUPABASE_URL}&#96;)\n  console.log(&#96;ü™£ Bucket name: ${BUCKET_NAME}\\n&#96;)\n\n  // Check existing buckets\n  console.log('üîç Checking existing buckets...')\n  const { data: buckets, error: listError } = await supabase.storage.listBuckets()\n\n  if (listError) {\n    console.error('‚ùå Failed to list buckets:', listError.message)\n    process.exit(1)\n  }\n\n  const existingBucket = buckets?.find(b =&gt; b.name === BUCKET_NAME)\n\n  if (existingBucket) {\n    console.log\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "const SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL",
            "lineNumber": 17
          },
          {
            "text": "const SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY",
            "lineNumber": 18
          },
          {
            "text": "const BUCKET_NAME = 'uploads'",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "async function main() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "  console.log('üöÄ Setting up Supabase Storage\\n')",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "  // Validate environment",
            "lineNumber": 24
          },
          {
            "text": "  if (!SUPABASE_URL) {",
            "lineNumber": 25
          },
          {
            "text": "    console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL in .env.local')",
            "lineNumber": 26
          },
          {
            "text": "    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')",
            "lineNumber": 27
          },
          {
            "text": "    process.exit(1)",
            "lineNumber": 28
          },
          {
            "text": "  }",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "  if (!SUPABASE_SERVICE_KEY) {",
            "lineNumber": 31
          },
          {
            "text": "    console.error('‚ùå Missing SUPABASE_SERVICE_ROLE_KEY in .env.local')",
            "lineNumber": 32
          },
          {
            "text": "    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')",
            "lineNumber": 33
          },
          {
            "text": "    console.log('(Look for \"service_role\" key - keep this secret!)\\n')",
            "lineNumber": 34
          },
          {
            "text": "    ",
            "lineNumber": 35
          },
          {
            "text": "    // Provide the exact URL for their project",
            "lineNumber": 36
          },
          {
            "text": "    const projectId = SUPABASE_URL.match(/https:\\/\\/([^.]+)/)?.[1]",
            "lineNumber": 37
          },
          {
            "text": "    if (projectId) {",
            "lineNumber": 38
          },
          {
            "text": "      console.log(&#96;Direct link: https://supabase.com/dashboard/project/${projectId}/settings/api&#96;)",
            "lineNumber": 39
          },
          {
            "text": "    }",
            "lineNumber": 40
          },
          {
            "text": "    process.exit(1)",
            "lineNumber": 41
          },
          {
            "text": "  }",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "  // Create admin client with service role key",
            "lineNumber": 44
          },
          {
            "text": "  const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {",
            "lineNumber": 45
          },
          {
            "text": "    auth: { persistSession: false }",
            "lineNumber": 46
          },
          {
            "text": "  })",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "  console.log(&#96;üìç Supabase URL: ${SUPABASE_URL}&#96;)",
            "lineNumber": 49
          },
          {
            "text": "  console.log(&#96;ü™£ Bucket name: ${BUCKET_NAME}\\n&#96;)",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "  // Check existing buckets",
            "lineNumber": 52
          },
          {
            "text": "  console.log('üîç Checking existing buckets...')",
            "lineNumber": 53
          },
          {
            "text": "  const { data: buckets, error: listError } = await supabase.storage.listBuckets()",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "  if (listError) {",
            "lineNumber": 56
          },
          {
            "text": "    console.error('‚ùå Failed to list buckets:', listError.message)",
            "lineNumber": 57
          },
          {
            "text": "    process.exit(1)",
            "lineNumber": 58
          },
          {
            "text": "  }",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "  const existingBucket = buckets?.find(b =&gt; b.name === BUCKET_NAME)",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "  if (existingBucket) {",
            "lineNumber": 63
          },
          {
            "text": "    console.log",
            "lineNumber": 64
          },
          {
            "text": "}",
            "lineNumber": 118,
            "isSignature": true
          }
        ]
      },
      "score": 0.38765835762023926
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/setup-supabase-storage.ts",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 14,
            "column": 52
          }
        },
        "contents": "/**\n * Automatically set up Supabase Storage bucket for WordPress image migration\n * \n * Prerequisites:\n * - NEXT_PUBLIC_SUPABASE_URL in .env.local\n * - SUPABASE_SERVICE_ROLE_KEY in .env.local (from Supabase dashboard ‚Üí Settings ‚Üí API)\n * \n * Usage: npx tsx scripts/setup-supabase-storage.ts\n */\n\nimport { config } from 'dotenv'\nimport { resolve } from 'path'\nconfig({ path: resolve(process.cwd(), '.env.local') })\n\nimport { createClient } from '@supabase/supabase-js'",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * Automatically set up Supabase Storage bucket for WordPress image migration",
            "lineNumber": 2
          },
          {
            "text": " * ",
            "lineNumber": 3
          },
          {
            "text": " * Prerequisites:",
            "lineNumber": 4
          },
          {
            "text": " * - NEXT_PUBLIC_SUPABASE_URL in .env.local",
            "lineNumber": 5
          },
          {
            "text": " * - SUPABASE_SERVICE_ROLE_KEY in .env.local (from Supabase dashboard ‚Üí Settings ‚Üí API)",
            "lineNumber": 6
          },
          {
            "text": " * ",
            "lineNumber": 7
          },
          {
            "text": " * Usage: npx tsx scripts/setup-supabase-storage.ts",
            "lineNumber": 8
          },
          {
            "text": " */",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "import { config } from 'dotenv'",
            "lineNumber": 11
          },
          {
            "text": "import { resolve } from 'path'",
            "lineNumber": 12
          },
          {
            "text": "config({ path: resolve(process.cwd(), '.env.local') })",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 15
          }
        ]
      },
      "score": 0.3646211624145508
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/INFRASTRUCTURE.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 69
          }
        },
        "contents": "# HIIIWAV Infrastructure &amp; Accounts\n\n&gt; Quick reference for all services and accounts needed to manage hiiiwav.org\n\n## Services Overview\n\n| Service | Purpose | Account | Dashboard |\n|---------|---------|---------|-----------|\n| **Supabase** | Database &amp; Storage | GitHub: &#96;boscokante&#96; | [Dashboard](https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj) |\n| **Vercel** | Hosting &amp; Deployment | _TBD_ | [Dashboard](https://vercel.com/dashboard) |\n| **GitHub** | Code Repository | &#96;boscokante&#96; | [Repo](https://github.com/boscokante/hiiiwav-website) |\n| **Domain Registrar** | DNS for hiiiwav.org | _TBD_ | _TBD_ |\n| **Kinsta** | OLD WordPress (to be decommissioned) | _TBD_ | [Dashboard](https://my.kinsta.com/) |\n\n---\n\n## Supabase\n\n- **Project ID:** &#96;pzoyeigicwgmmlngxowj&#96;\n- **Region:** &#96;us-west-2&#96; (Oregon)\n- **Login:** GitHub OAuth (&#96;boscokante&#96;)\n- **Dashboard:** https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj\n\n### Resources Used\n- [x] PostgreSQL Database\n- [ ] Storage (for migrated WordPress images)\n- [ ] Auth (if needed later)\n\n### Key URLs\n- Database: &#96;aws-0-us-west-2.pooler.supabase.com&#96;\n- Storage: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/&#96;\n\n---\n\n## Vercel (Hosting)\n\n- **Account:** &#96;boscokante&#96; (or linked GitHub account)\n- **Project Name:** &#96;hiiiwav-website&#96;\n- **Preview URL:** https://hiiiwav-website.vercel.app\n- **Dashboard:** https://vercel.com/dashboard\n\n### Environment Variables to Set\n&#96;&#96;&#96;\nDATABASE_URL=postgresql://...\nNEXTAUTH_SECRET=...\nNEXTAUTH_URL=https://hiiiwav.org\nOPENAI_API_KEY=...\nNEXT_PUBLIC_SUPABASE_URL=https://pzoyeigicwgmmlngxowj.supabase.co\nNEXT_PUBLIC_SUPABASE_ANON_KEY=...\n&#96;&#96;&#96;\n\n---\n\n## GitHub\n\n- **Account:** &#96;boscokante&#96;\n- **Repo:** https://github.com/boscokante/hiiiwav-website\n- **Archive Repo:** https://github.com/boscokante/hiiiwav-wordpress-archive\n\n---\n\n## Domain &amp; DNS\n\n- **Domain:** &#96;hiiiwav.org&#96;\n- **Registrar:** _TBD (GoDaddy? Namecheap? Cloudflare?)_\n- **Current DNS:** Points to Kinsta (WordPress)\n- **After Migration:** Will point to Vercel\n\n### DNS Records Needed for Vercel",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# HIIIWAV Infrastructure &amp; Accounts",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "&gt; Quick reference for all services and accounts needed to manage hiiiwav.org",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "## Services Overview",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "| Service | Purpose | Account | Dashboard |",
            "lineNumber": 7
          },
          {
            "text": "|---------|---------|---------|-----------|",
            "lineNumber": 8
          },
          {
            "text": "| **Supabase** | Database &amp; Storage | GitHub: &#96;boscokante&#96; | [Dashboard](https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj) |",
            "lineNumber": 9
          },
          {
            "text": "| **Vercel** | Hosting &amp; Deployment | _TBD_ | [Dashboard](https://vercel.com/dashboard) |",
            "lineNumber": 10
          },
          {
            "text": "| **GitHub** | Code Repository | &#96;boscokante&#96; | [Repo](https://github.com/boscokante/hiiiwav-website) |",
            "lineNumber": 11
          },
          {
            "text": "| **Domain Registrar** | DNS for hiiiwav.org | _TBD_ | _TBD_ |",
            "lineNumber": 12
          },
          {
            "text": "| **Kinsta** | OLD WordPress (to be decommissioned) | _TBD_ | [Dashboard](https://my.kinsta.com/) |",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "---",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "## Supabase",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "- **Project ID:** &#96;pzoyeigicwgmmlngxowj&#96;",
            "lineNumber": 19
          },
          {
            "text": "- **Region:** &#96;us-west-2&#96; (Oregon)",
            "lineNumber": 20
          },
          {
            "text": "- **Login:** GitHub OAuth (&#96;boscokante&#96;)",
            "lineNumber": 21
          },
          {
            "text": "- **Dashboard:** https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "### Resources Used",
            "lineNumber": 24
          },
          {
            "text": "- [x] PostgreSQL Database",
            "lineNumber": 25
          },
          {
            "text": "- [ ] Storage (for migrated WordPress images)",
            "lineNumber": 26
          },
          {
            "text": "- [ ] Auth (if needed later)",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "### Key URLs",
            "lineNumber": 29
          },
          {
            "text": "- Database: &#96;aws-0-us-west-2.pooler.supabase.com&#96;",
            "lineNumber": 30
          },
          {
            "text": "- Storage: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/&#96;",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "---",
            "lineNumber": 33
          },
          {
            "lineNumber": 34
          },
          {
            "text": "## Vercel (Hosting)",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "- **Account:** &#96;boscokante&#96; (or linked GitHub account)",
            "lineNumber": 37
          },
          {
            "text": "- **Project Name:** &#96;hiiiwav-website&#96;",
            "lineNumber": 38
          },
          {
            "text": "- **Preview URL:** https://hiiiwav-website.vercel.app",
            "lineNumber": 39
          },
          {
            "text": "- **Dashboard:** https://vercel.com/dashboard",
            "lineNumber": 40
          },
          {
            "lineNumber": 41
          },
          {
            "text": "### Environment Variables to Set",
            "lineNumber": 42
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 43
          },
          {
            "text": "DATABASE_URL=postgresql://...",
            "lineNumber": 44
          },
          {
            "text": "NEXTAUTH_SECRET=...",
            "lineNumber": 45
          },
          {
            "text": "NEXTAUTH_URL=https://hiiiwav.org",
            "lineNumber": 46
          },
          {
            "text": "OPENAI_API_KEY=...",
            "lineNumber": 47
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_URL=https://pzoyeigicwgmmlngxowj.supabase.co",
            "lineNumber": 48
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_ANON_KEY=...",
            "lineNumber": 49
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "---",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "## GitHub",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "- **Account:** &#96;boscokante&#96;",
            "lineNumber": 56
          },
          {
            "text": "- **Repo:** https://github.com/boscokante/hiiiwav-website",
            "lineNumber": 57
          },
          {
            "text": "- **Archive Repo:** https://github.com/boscokante/hiiiwav-wordpress-archive",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "---",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "## Domain &amp; DNS",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "- **Domain:** &#96;hiiiwav.org&#96;",
            "lineNumber": 64
          },
          {
            "text": "- **Registrar:** _TBD (GoDaddy? Namecheap? Cloudflare?)_",
            "lineNumber": 65
          },
          {
            "text": "- **Current DNS:** Points to Kinsta (WordPress)",
            "lineNumber": 66
          },
          {
            "text": "- **After Migration:** Will point to Vercel",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "### DNS Records Needed for Vercel",
            "lineNumber": 69
          }
        ]
      },
      "score": 0.35259509086608887
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/WORDPRESS_MIGRATION_PLAYBOOK.md",
        "range": {
          "startPosition": {
            "line": 150
          },
          "endPosition": {
            "line": 235
          }
        },
        "contents": "### 4.4 Automation Opportunity: Auto-Create Storage Bucket\n\n&#96;&#96;&#96;typescript\n// Future: scripts/setup-supabase-storage.ts\nimport { createClient } from '@supabase/supabase-js'\n\nasync function setupStorage() {\n  const supabase = createClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY! // Need service role for admin ops\n  )\n  \n  // Create uploads bucket if it doesn't exist\n  const { data: buckets } = await supabase.storage.listBuckets()\n  \n  if (!buckets?.find(b =&gt; b.name === 'uploads')) {\n    await supabase.storage.createBucket('uploads', {\n      public: true,\n      fileSizeLimit: 52428800, // 50MB\n      allowedMimeTypes: ['image/*', 'video/*', 'application/pdf']\n    })\n    console.log('‚úì Created uploads bucket')\n  }\n}\n&#96;&#96;&#96;\n\n**Full automation would:**\n1. Check if bucket exists\n2. Create if not\n3. Set public access policies\n4. Return bucket URL for env config\n\n---\n\n## Phase 5: Redirects ‚úÖ\n\n### 5.1 Create Redirect Map\n&#96;&#96;&#96;bash\n# Generated: public/_redirects (Netlify format)\n# Also works with Vercel via vercel.json or middleware\n&#96;&#96;&#96;\n\n### 5.2 Redirect Strategy\n\n| Old Pattern | New Destination | Status |\n|-------------|-----------------|--------|\n| &#96;/blog-post-slug&#96; | &#96;/blog&#96; | 301 |\n| &#96;/fest&#96;, &#96;/hiiiwav-fest&#96; | &#96;/projects/hiiiwav-fest&#96; | 301 |\n| &#96;/afro-ai-*&#96; | &#96;/projects/afro-ai&#96; | 301 |\n| &#96;/cart&#96;, &#96;/checkout&#96;, &#96;/shop&#96; | &#96;/&#96; | 410 (Gone) |\n| &#96;/wp-admin/*&#96; | &#96;/&#96; | 410 |\n\n### 5.3 Test Redirects\nAfter deployment, verify:\n&#96;&#96;&#96;bash\ncurl -I https://hiiiwav.org/fest\n# Should return: HTTP/2 301, Location: /projects/hiiiwav-fest\n&#96;&#96;&#96;\n\n---\n\n## Phase 6: Deployment ‚úÖ COMPLETE\n\n### 6.1 Deploy to Vercel\n&#96;&#96;&#96;bash\n# Install Vercel CLI\nnpm i -g vercel\n\n# Deploy\nvercel\n\n# Set environment variables in Vercel dashboard\n&#96;&#96;&#96;\n\n**Completed: December 2024**\n- Preview URL: https://hiiiwav-website.vercel.app\n- Status: Live on preview, ready for domain\n\n### 6.2 Environment Variables for Production\n&#96;&#96;&#96;\nDATABASE_URL=postgresql://...\nNEXTAUTH_SECRET=...\nNEXTAUTH_URL=https://hiiiwav.org\nOPENAI_API_KEY=...",
        "signatures": {},
        "detailedLines": [
          {
            "text": "### 4.4 Automation Opportunity: Auto-Create Storage Bucket",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 154
          },
          {
            "text": "// Future: scripts/setup-supabase-storage.ts",
            "lineNumber": 155
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "async function setupStorage() {",
            "lineNumber": 158
          },
          {
            "text": "  const supabase = createClient(",
            "lineNumber": 159
          },
          {
            "text": "    process.env.NEXT_PUBLIC_SUPABASE_URL!,",
            "lineNumber": 160
          },
          {
            "text": "    process.env.SUPABASE_SERVICE_ROLE_KEY! // Need service role for admin ops",
            "lineNumber": 161
          },
          {
            "text": "  )",
            "lineNumber": 162
          },
          {
            "text": "  ",
            "lineNumber": 163
          },
          {
            "text": "  // Create uploads bucket if it doesn't exist",
            "lineNumber": 164
          },
          {
            "text": "  const { data: buckets } = await supabase.storage.listBuckets()",
            "lineNumber": 165
          },
          {
            "text": "  ",
            "lineNumber": 166
          },
          {
            "text": "  if (!buckets?.find(b =&gt; b.name === 'uploads')) {",
            "lineNumber": 167
          },
          {
            "text": "    await supabase.storage.createBucket('uploads', {",
            "lineNumber": 168
          },
          {
            "text": "      public: true,",
            "lineNumber": 169
          },
          {
            "text": "      fileSizeLimit: 52428800, // 50MB",
            "lineNumber": 170
          },
          {
            "text": "      allowedMimeTypes: ['image/*', 'video/*', 'application/pdf']",
            "lineNumber": 171
          },
          {
            "text": "    })",
            "lineNumber": 172
          },
          {
            "text": "    console.log('‚úì Created uploads bucket')",
            "lineNumber": 173
          },
          {
            "text": "  }",
            "lineNumber": 174
          },
          {
            "text": "}",
            "lineNumber": 175
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 176
          },
          {
            "lineNumber": 177
          },
          {
            "text": "**Full automation would:**",
            "lineNumber": 178
          },
          {
            "text": "1. Check if bucket exists",
            "lineNumber": 179
          },
          {
            "text": "2. Create if not",
            "lineNumber": 180
          },
          {
            "text": "3. Set public access policies",
            "lineNumber": 181
          },
          {
            "text": "4. Return bucket URL for env config",
            "lineNumber": 182
          },
          {
            "lineNumber": 183
          },
          {
            "text": "---",
            "lineNumber": 184
          },
          {
            "lineNumber": 185
          },
          {
            "text": "## Phase 5: Redirects ‚úÖ",
            "lineNumber": 186
          },
          {
            "lineNumber": 187
          },
          {
            "text": "### 5.1 Create Redirect Map",
            "lineNumber": 188
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 189
          },
          {
            "text": "# Generated: public/_redirects (Netlify format)",
            "lineNumber": 190
          },
          {
            "text": "# Also works with Vercel via vercel.json or middleware",
            "lineNumber": 191
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 192
          },
          {
            "lineNumber": 193
          },
          {
            "text": "### 5.2 Redirect Strategy",
            "lineNumber": 194
          },
          {
            "lineNumber": 195
          },
          {
            "text": "| Old Pattern | New Destination | Status |",
            "lineNumber": 196
          },
          {
            "text": "|-------------|-----------------|--------|",
            "lineNumber": 197
          },
          {
            "text": "| &#96;/blog-post-slug&#96; | &#96;/blog&#96; | 301 |",
            "lineNumber": 198
          },
          {
            "text": "| &#96;/fest&#96;, &#96;/hiiiwav-fest&#96; | &#96;/projects/hiiiwav-fest&#96; | 301 |",
            "lineNumber": 199
          },
          {
            "text": "| &#96;/afro-ai-*&#96; | &#96;/projects/afro-ai&#96; | 301 |",
            "lineNumber": 200
          },
          {
            "text": "| &#96;/cart&#96;, &#96;/checkout&#96;, &#96;/shop&#96; | &#96;/&#96; | 410 (Gone) |",
            "lineNumber": 201
          },
          {
            "text": "| &#96;/wp-admin/*&#96; | &#96;/&#96; | 410 |",
            "lineNumber": 202
          },
          {
            "lineNumber": 203
          },
          {
            "text": "### 5.3 Test Redirects",
            "lineNumber": 204
          },
          {
            "text": "After deployment, verify:",
            "lineNumber": 205
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 206
          },
          {
            "text": "curl -I https://hiiiwav.org/fest",
            "lineNumber": 207
          },
          {
            "text": "# Should return: HTTP/2 301, Location: /projects/hiiiwav-fest",
            "lineNumber": 208
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 209
          },
          {
            "lineNumber": 210
          },
          {
            "text": "---",
            "lineNumber": 211
          },
          {
            "lineNumber": 212
          },
          {
            "text": "## Phase 6: Deployment ‚úÖ COMPLETE",
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "### 6.1 Deploy to Vercel",
            "lineNumber": 215
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 216
          },
          {
            "text": "# Install Vercel CLI",
            "lineNumber": 217
          },
          {
            "text": "npm i -g vercel",
            "lineNumber": 218
          },
          {
            "lineNumber": 219
          },
          {
            "text": "# Deploy",
            "lineNumber": 220
          },
          {
            "text": "vercel",
            "lineNumber": 221
          },
          {
            "lineNumber": 222
          },
          {
            "text": "# Set environment variables in Vercel dashboard",
            "lineNumber": 223
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 224
          },
          {
            "lineNumber": 225
          },
          {
            "text": "**Completed: December 2024**",
            "lineNumber": 226
          },
          {
            "text": "- Preview URL: https://hiiiwav-website.vercel.app",
            "lineNumber": 227
          },
          {
            "text": "- Status: Live on preview, ready for domain",
            "lineNumber": 228
          },
          {
            "lineNumber": 229
          },
          {
            "text": "### 6.2 Environment Variables for Production",
            "lineNumber": 230
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 231
          },
          {
            "text": "DATABASE_URL=postgresql://...",
            "lineNumber": 232
          },
          {
            "text": "NEXTAUTH_SECRET=...",
            "lineNumber": 233
          },
          {
            "text": "NEXTAUTH_URL=https://hiiiwav.org",
            "lineNumber": 234
          },
          {
            "text": "OPENAI_API_KEY=...",
            "lineNumber": 235
          }
        ]
      },
      "score": 0.34720560908317566
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/dev-studio-README.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 67
          }
        },
        "contents": "# Dev Studio\n\nA centralized development environment for managing multiple projects using a single **Supabase** instance and **Vercel** account. This eliminates redundant setup and consolidates billing across all your apps.\n\n---\n\n## Why Dev Studio?\n\nInstead of creating separate Supabase projects and Vercel deployments for every app idea:\n\n- **One Supabase project** ‚Üí Multiple apps share the same database, separated by **schemas**\n- **One Vercel account** ‚Üí All apps deploy under the same billing, with automatic preview URLs\n- **Shared infrastructure** ‚Üí Auth, storage, and edge functions can be reused across projects\n- **No per-project fees** ‚Üí Supabase free tier limits apply to the whole project, not per-schema\n\n---\n\n## Architecture\n\n&#96;&#96;&#96;\ndev-studio (Supabase Project)\n‚îú‚îÄ‚îÄ core/              # Shared tables (users, settings, etc.)\n‚îú‚îÄ‚îÄ chatbot_app/       # Chatbot-specific tables\n‚îú‚îÄ‚îÄ crm_agent/         # CRM/Agent tables\n‚îú‚îÄ‚îÄ sites/             # Website projects (subscribers, pages, etc.)\n‚îî‚îÄ‚îÄ experiments/       # Quick experiments and prototypes\n&#96;&#96;&#96;\n\nEach app is a **separate GitHub repo** that connects to the same Supabase project but uses its own schema.\n\n---\n\n## Quick Reference\n\n### Supabase Connection\n\nAll apps use these environment variables (values stored in &#96;.env.local&#96;, never committed):\n\n&#96;&#96;&#96;env\nNEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co\nNEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...\nSUPABASE_SERVICE_ROLE_KEY=eyJhbGci...  # Server-only, never expose to browser\n&#96;&#96;&#96;\n\n### Schema-Qualified Queries\n\nApps access their data using schema-prefixed table names:\n\n&#96;&#96;&#96;ts\n// Chatbot app\nconst { data } = await supabase.from('chatbot_app.sessions').select('*');\n\n// CRM app\nconst { data } = await supabase.from('crm_agent.contacts').select('*');\n\n// Website project\nconst { data } = await supabase.from('sites.subscribers').select('*');\n&#96;&#96;&#96;\n\n---\n\n## Creating a New Project\n\n### For AI Assistants\n\nWhen starting a new project that uses Dev Studio infrastructure:",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# Dev Studio",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "A centralized development environment for managing multiple projects using a single **Supabase** instance and **Vercel** account. This eliminates redundant setup and consolidates billing across all your apps.",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "---",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "## Why Dev Studio?",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "Instead of creating separate Supabase projects and Vercel deployments for every app idea:",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "- **One Supabase project** ‚Üí Multiple apps share the same database, separated by **schemas**",
            "lineNumber": 11
          },
          {
            "text": "- **One Vercel account** ‚Üí All apps deploy under the same billing, with automatic preview URLs",
            "lineNumber": 12
          },
          {
            "text": "- **Shared infrastructure** ‚Üí Auth, storage, and edge functions can be reused across projects",
            "lineNumber": 13
          },
          {
            "text": "- **No per-project fees** ‚Üí Supabase free tier limits apply to the whole project, not per-schema",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "---",
            "lineNumber": 16
          },
          {
            "lineNumber": 17
          },
          {
            "text": "## Architecture",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 20
          },
          {
            "text": "dev-studio (Supabase Project)",
            "lineNumber": 21
          },
          {
            "text": "‚îú‚îÄ‚îÄ core/              # Shared tables (users, settings, etc.)",
            "lineNumber": 22
          },
          {
            "text": "‚îú‚îÄ‚îÄ chatbot_app/       # Chatbot-specific tables",
            "lineNumber": 23
          },
          {
            "text": "‚îú‚îÄ‚îÄ crm_agent/         # CRM/Agent tables",
            "lineNumber": 24
          },
          {
            "text": "‚îú‚îÄ‚îÄ sites/             # Website projects (subscribers, pages, etc.)",
            "lineNumber": 25
          },
          {
            "text": "‚îî‚îÄ‚îÄ experiments/       # Quick experiments and prototypes",
            "lineNumber": 26
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "Each app is a **separate GitHub repo** that connects to the same Supabase project but uses its own schema.",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "---",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "## Quick Reference",
            "lineNumber": 33
          },
          {
            "lineNumber": 34
          },
          {
            "text": "### Supabase Connection",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "All apps use these environment variables (values stored in &#96;.env.local&#96;, never committed):",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "&#96;&#96;&#96;env",
            "lineNumber": 39
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co",
            "lineNumber": 40
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...",
            "lineNumber": 41
          },
          {
            "text": "SUPABASE_SERVICE_ROLE_KEY=eyJhbGci...  # Server-only, never expose to browser",
            "lineNumber": 42
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "### Schema-Qualified Queries",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "Apps access their data using schema-prefixed table names:",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 49
          },
          {
            "text": "// Chatbot app",
            "lineNumber": 50
          },
          {
            "text": "const { data } = await supabase.from('chatbot_app.sessions').select('*');",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "// CRM app",
            "lineNumber": 53
          },
          {
            "text": "const { data } = await supabase.from('crm_agent.contacts').select('*');",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "// Website project",
            "lineNumber": 56
          },
          {
            "text": "const { data } = await supabase.from('sites.subscribers').select('*');",
            "lineNumber": 57
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "---",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "## Creating a New Project",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "### For AI Assistants",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "When starting a new project that uses Dev Studio infrastructure:",
            "lineNumber": 66
          }
        ]
      },
      "score": 0.3274320065975189
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/migrations/meta/0000_snapshot.json",
        "range": {
          "startPosition": {
            "line": 311,
            "column": 6
          },
          "endPosition": {
            "line": 389
          }
        },
        "contents": "\"name\": \"media\",\n      \"schema\": \"\",\n      \"columns\": {\n        \"id\": {\n          \"name\": \"id\",\n          \"type\": \"serial\",\n          \"primaryKey\": true,\n          \"notNull\": true\n        },\n        \"filename\": {\n          \"name\": \"filename\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": true\n        },\n        \"url\": {\n          \"name\": \"url\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": true\n        },\n        \"mime_type\": {\n          \"name\": \"mime_type\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"size\": {\n          \"name\": \"size\",\n          \"type\": \"integer\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"alt_text\": {\n          \"name\": \"alt_text\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"uploaded_by\": {\n          \"name\": \"uploaded_by\",\n          \"type\": \"integer\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"created_at\": {\n          \"name\": \"created_at\",\n          \"type\": \"timestamp\",\n          \"primaryKey\": false,\n          \"notNull\": true,\n          \"default\": \"now()\"\n        }\n      },\n      \"indexes\": {},\n      \"foreignKeys\": {\n        \"media_uploaded_by_users_id_fk\": {\n          \"name\": \"media_uploaded_by_users_id_fk\",\n          \"tableFrom\": \"media\",\n          \"tableTo\": \"users\",\n          \"columnsFrom\": [\n            \"uploaded_by\"\n          ],\n          \"columnsTo\": [\n            \"id\"\n          ],\n          \"onDelete\": \"no action\",\n          \"onUpdate\": \"no action\"\n        }\n      },\n      \"compositePrimaryKeys\": {},\n      \"uniqueConstraints\": {},\n      \"policies\": {},\n      \"checkConstraints\": {},\n      \"isRLSEnabled\": false\n    },\n    \"public.pages\": {\n      \"name\": \"pages\",\n      \"schema\": \"\",",
        "signatures": {},
        "detailedLines": [
          {
            "text": "\"name\": \"media\",",
            "lineNumber": 312
          },
          {
            "text": "      \"schema\": \"\",",
            "lineNumber": 313
          },
          {
            "text": "      \"columns\": {",
            "lineNumber": 314
          },
          {
            "text": "        \"id\": {",
            "lineNumber": 315
          },
          {
            "text": "          \"name\": \"id\",",
            "lineNumber": 316
          },
          {
            "text": "          \"type\": \"serial\",",
            "lineNumber": 317
          },
          {
            "text": "          \"primaryKey\": true,",
            "lineNumber": 318
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 319
          },
          {
            "text": "        },",
            "lineNumber": 320
          },
          {
            "text": "        \"filename\": {",
            "lineNumber": 321
          },
          {
            "text": "          \"name\": \"filename\",",
            "lineNumber": 322
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 323
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 324
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 325
          },
          {
            "text": "        },",
            "lineNumber": 326
          },
          {
            "text": "        \"url\": {",
            "lineNumber": 327
          },
          {
            "text": "          \"name\": \"url\",",
            "lineNumber": 328
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 329
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 330
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 331
          },
          {
            "text": "        },",
            "lineNumber": 332
          },
          {
            "text": "        \"mime_type\": {",
            "lineNumber": 333
          },
          {
            "text": "          \"name\": \"mime_type\",",
            "lineNumber": 334
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 335
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 336
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 337
          },
          {
            "text": "        },",
            "lineNumber": 338
          },
          {
            "text": "        \"size\": {",
            "lineNumber": 339
          },
          {
            "text": "          \"name\": \"size\",",
            "lineNumber": 340
          },
          {
            "text": "          \"type\": \"integer\",",
            "lineNumber": 341
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 342
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 343
          },
          {
            "text": "        },",
            "lineNumber": 344
          },
          {
            "text": "        \"alt_text\": {",
            "lineNumber": 345
          },
          {
            "text": "          \"name\": \"alt_text\",",
            "lineNumber": 346
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 347
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 348
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 349
          },
          {
            "text": "        },",
            "lineNumber": 350
          },
          {
            "text": "        \"uploaded_by\": {",
            "lineNumber": 351
          },
          {
            "text": "          \"name\": \"uploaded_by\",",
            "lineNumber": 352
          },
          {
            "text": "          \"type\": \"integer\",",
            "lineNumber": 353
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 354
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 355
          },
          {
            "text": "        },",
            "lineNumber": 356
          },
          {
            "text": "        \"created_at\": {",
            "lineNumber": 357
          },
          {
            "text": "          \"name\": \"created_at\",",
            "lineNumber": 358
          },
          {
            "text": "          \"type\": \"timestamp\",",
            "lineNumber": 359
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 360
          },
          {
            "text": "          \"notNull\": true,",
            "lineNumber": 361
          },
          {
            "text": "          \"default\": \"now()\"",
            "lineNumber": 362
          },
          {
            "text": "        }",
            "lineNumber": 363
          },
          {
            "text": "      },",
            "lineNumber": 364
          },
          {
            "text": "      \"indexes\": {},",
            "lineNumber": 365
          },
          {
            "text": "      \"foreignKeys\": {",
            "lineNumber": 366
          },
          {
            "text": "        \"media_uploaded_by_users_id_fk\": {",
            "lineNumber": 367
          },
          {
            "text": "          \"name\": \"media_uploaded_by_users_id_fk\",",
            "lineNumber": 368
          },
          {
            "text": "          \"tableFrom\": \"media\",",
            "lineNumber": 369
          },
          {
            "text": "          \"tableTo\": \"users\",",
            "lineNumber": 370
          },
          {
            "text": "          \"columnsFrom\": [",
            "lineNumber": 371
          },
          {
            "text": "            \"uploaded_by\"",
            "lineNumber": 372
          },
          {
            "text": "          ],",
            "lineNumber": 373
          },
          {
            "text": "          \"columnsTo\": [",
            "lineNumber": 374
          },
          {
            "text": "            \"id\"",
            "lineNumber": 375
          },
          {
            "text": "          ],",
            "lineNumber": 376
          },
          {
            "text": "          \"onDelete\": \"no action\",",
            "lineNumber": 377
          },
          {
            "text": "          \"onUpdate\": \"no action\"",
            "lineNumber": 378
          },
          {
            "text": "        }",
            "lineNumber": 379
          },
          {
            "text": "      },",
            "lineNumber": 380
          },
          {
            "text": "      \"compositePrimaryKeys\": {},",
            "lineNumber": 381
          },
          {
            "text": "      \"uniqueConstraints\": {},",
            "lineNumber": 382
          },
          {
            "text": "      \"policies\": {},",
            "lineNumber": 383
          },
          {
            "text": "      \"checkConstraints\": {},",
            "lineNumber": 384
          },
          {
            "text": "      \"isRLSEnabled\": false",
            "lineNumber": 385
          },
          {
            "text": "    },",
            "lineNumber": 386
          },
          {
            "text": "    \"public.pages\": {",
            "lineNumber": 387
          },
          {
            "text": "      \"name\": \"pages\",",
            "lineNumber": 388
          },
          {
            "text": "      \"schema\": \"\",",
            "lineNumber": 389
          }
        ]
      },
      "score": 0.3175555467605591
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./package.json",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 57
          }
        },
        "contents": "{\n  \"name\": \"festmgmt\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"next dev --turbopack\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"eslint\",\n    \"db:generate\": \"drizzle-kit generate\",\n    \"db:migrate\": \"drizzle-kit migrate\",\n    \"db:push\": \"drizzle-kit push\",\n    \"db:studio\": \"drizzle-kit studio\",\n    \"wp:import\": \"tsx scripts/import-wp-to-db.ts\",\n    \"wp:setup-storage\": \"tsx scripts/setup-supabase-storage.ts\",\n    \"wp:migrate-images\": \"tsx scripts/migrate-images-to-supabase.ts\",\n    \"create-admin\": \"tsx scripts/create-admin-user.ts\",\n    \"postbuild\": \"next-sitemap\"\n  },\n  \"dependencies\": {\n    \"@ai-sdk/anthropic\": \"^2.0.44\",\n    \"@ai-sdk/openai\": \"^2.0.67\",\n    \"@ai-sdk/react\": \"^2.0.93\",\n    \"@hookform/resolvers\": \"^5.2.2\",\n    \"@neondatabase/serverless\": \"^1.0.2\",\n    \"@radix-ui/react-slot\": \"^1.2.4\",\n    \"@supabase/supabase-js\": \"^2.86.2\",\n    \"@tiptap/pm\": \"^3.10.7\",\n    \"@tiptap/react\": \"^3.10.7\",\n    \"@tiptap/starter-kit\": \"^3.10.7\",\n    \"@uploadthing/react\": \"^7.3.3\",\n    \"ai\": \"^5.0.93\",\n    \"bcryptjs\": \"^3.0.3\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"clsx\": \"^2.1.1\",\n    \"drizzle-orm\": \"^0.44.7\",\n    \"gray-matter\": \"^4.0.3\",\n    \"lucide-react\": \"^0.553.0\",\n    \"next\": \"16.0.3\",\n    \"next-auth\": \"^5.0.0-beta.30\",\n    \"next-seo\": \"^7.0.1\",\n    \"next-sitemap\": \"^4.2.3\",\n    \"postgres\": \"^3.4.7\",\n    \"react\": \"19.2.0\",\n    \"react-dom\": \"19.2.0\",\n    \"react-hook-form\": \"^7.66.0\",\n    \"react-markdown\": \"^10.1.0\",\n    \"rehype-raw\": \"^7.0.0\",\n    \"remark-gfm\": \"^4.0.1\",\n    \"tailwind-merge\": \"^3.4.0\",\n    \"turndown\": \"^7.2.2\",\n    \"turndown-plugin-gfm\": \"^1.0.2\",\n    \"uploadthing\": \"^7.7.4\",\n    \"zod\": \"^4.1.12\"\n  },\n  \"devDependencies\": {\n    \"@tailwindcss/postcss\": \"^4\",",
        "signatures": {},
        "detailedLines": [
          {
            "text": "{",
            "lineNumber": 1
          },
          {
            "text": "  \"name\": \"festmgmt\",",
            "lineNumber": 2
          },
          {
            "text": "  \"version\": \"0.1.0\",",
            "lineNumber": 3
          },
          {
            "text": "  \"private\": true,",
            "lineNumber": 4
          },
          {
            "text": "  \"scripts\": {",
            "lineNumber": 5
          },
          {
            "text": "    \"dev\": \"next dev --turbopack\",",
            "lineNumber": 6
          },
          {
            "text": "    \"build\": \"next build\",",
            "lineNumber": 7
          },
          {
            "text": "    \"start\": \"next start\",",
            "lineNumber": 8
          },
          {
            "text": "    \"lint\": \"eslint\",",
            "lineNumber": 9
          },
          {
            "text": "    \"db:generate\": \"drizzle-kit generate\",",
            "lineNumber": 10
          },
          {
            "text": "    \"db:migrate\": \"drizzle-kit migrate\",",
            "lineNumber": 11
          },
          {
            "text": "    \"db:push\": \"drizzle-kit push\",",
            "lineNumber": 12
          },
          {
            "text": "    \"db:studio\": \"drizzle-kit studio\",",
            "lineNumber": 13
          },
          {
            "text": "    \"wp:import\": \"tsx scripts/import-wp-to-db.ts\",",
            "lineNumber": 14
          },
          {
            "text": "    \"wp:setup-storage\": \"tsx scripts/setup-supabase-storage.ts\",",
            "lineNumber": 15
          },
          {
            "text": "    \"wp:migrate-images\": \"tsx scripts/migrate-images-to-supabase.ts\",",
            "lineNumber": 16
          },
          {
            "text": "    \"create-admin\": \"tsx scripts/create-admin-user.ts\",",
            "lineNumber": 17
          },
          {
            "text": "    \"postbuild\": \"next-sitemap\"",
            "lineNumber": 18
          },
          {
            "text": "  },",
            "lineNumber": 19
          },
          {
            "text": "  \"dependencies\": {",
            "lineNumber": 20
          },
          {
            "text": "    \"@ai-sdk/anthropic\": \"^2.0.44\",",
            "lineNumber": 21
          },
          {
            "text": "    \"@ai-sdk/openai\": \"^2.0.67\",",
            "lineNumber": 22
          },
          {
            "text": "    \"@ai-sdk/react\": \"^2.0.93\",",
            "lineNumber": 23
          },
          {
            "text": "    \"@hookform/resolvers\": \"^5.2.2\",",
            "lineNumber": 24
          },
          {
            "text": "    \"@neondatabase/serverless\": \"^1.0.2\",",
            "lineNumber": 25
          },
          {
            "text": "    \"@radix-ui/react-slot\": \"^1.2.4\",",
            "lineNumber": 26
          },
          {
            "text": "    \"@supabase/supabase-js\": \"^2.86.2\",",
            "lineNumber": 27
          },
          {
            "text": "    \"@tiptap/pm\": \"^3.10.7\",",
            "lineNumber": 28
          },
          {
            "text": "    \"@tiptap/react\": \"^3.10.7\",",
            "lineNumber": 29
          },
          {
            "text": "    \"@tiptap/starter-kit\": \"^3.10.7\",",
            "lineNumber": 30
          },
          {
            "text": "    \"@uploadthing/react\": \"^7.3.3\",",
            "lineNumber": 31
          },
          {
            "text": "    \"ai\": \"^5.0.93\",",
            "lineNumber": 32
          },
          {
            "text": "    \"bcryptjs\": \"^3.0.3\",",
            "lineNumber": 33
          },
          {
            "text": "    \"class-variance-authority\": \"^0.7.1\",",
            "lineNumber": 34
          },
          {
            "text": "    \"clsx\": \"^2.1.1\",",
            "lineNumber": 35
          },
          {
            "text": "    \"drizzle-orm\": \"^0.44.7\",",
            "lineNumber": 36
          },
          {
            "text": "    \"gray-matter\": \"^4.0.3\",",
            "lineNumber": 37
          },
          {
            "text": "    \"lucide-react\": \"^0.553.0\",",
            "lineNumber": 38
          },
          {
            "text": "    \"next\": \"16.0.3\",",
            "lineNumber": 39
          },
          {
            "text": "    \"next-auth\": \"^5.0.0-beta.30\",",
            "lineNumber": 40
          },
          {
            "text": "    \"next-seo\": \"^7.0.1\",",
            "lineNumber": 41
          },
          {
            "text": "    \"next-sitemap\": \"^4.2.3\",",
            "lineNumber": 42
          },
          {
            "text": "    \"postgres\": \"^3.4.7\",",
            "lineNumber": 43
          },
          {
            "text": "    \"react\": \"19.2.0\",",
            "lineNumber": 44
          },
          {
            "text": "    \"react-dom\": \"19.2.0\",",
            "lineNumber": 45
          },
          {
            "text": "    \"react-hook-form\": \"^7.66.0\",",
            "lineNumber": 46
          },
          {
            "text": "    \"react-markdown\": \"^10.1.0\",",
            "lineNumber": 47
          },
          {
            "text": "    \"rehype-raw\": \"^7.0.0\",",
            "lineNumber": 48
          },
          {
            "text": "    \"remark-gfm\": \"^4.0.1\",",
            "lineNumber": 49
          },
          {
            "text": "    \"tailwind-merge\": \"^3.4.0\",",
            "lineNumber": 50
          },
          {
            "text": "    \"turndown\": \"^7.2.2\",",
            "lineNumber": 51
          },
          {
            "text": "    \"turndown-plugin-gfm\": \"^1.0.2\",",
            "lineNumber": 52
          },
          {
            "text": "    \"uploadthing\": \"^7.7.4\",",
            "lineNumber": 53
          },
          {
            "text": "    \"zod\": \"^4.1.12\"",
            "lineNumber": 54
          },
          {
            "text": "  },",
            "lineNumber": 55
          },
          {
            "text": "  \"devDependencies\": {",
            "lineNumber": 56
          },
          {
            "text": "    \"@tailwindcss/postcss\": \"^4\",",
            "lineNumber": 57
          }
        ]
      },
      "score": 0.3153437376022339
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/schema.ts",
        "range": {
          "startPosition": {
            "column": 79
          },
          "endPosition": {
            "line": 28
          }
        },
        "contents": " 'drizzle-orm/pg-core'\n\nexport const posts = pgTable('posts', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  excerpt: text('excerpt'),\n  content: text('content').notNull(),\n  coverImage: text('cover_image'),\n  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),\n  published: boolean('published').default(false),\n  seoTitle: text('seo_title'),\n  seoDescription: text('seo_description'),\n  canonical: text('canonical'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport const pages = pgTable('pages', {\n  id: serial('id').primaryKey(),",
        "signatures": {},
        "detailedLines": [
          {
            "text": " 'drizzle-orm/pg-core'",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "export const posts = pgTable('posts', {",
            "lineNumber": 3
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 4
          },
          {
            "text": "  slug: text('slug').notNull().unique(),",
            "lineNumber": 5
          },
          {
            "text": "  title: text('title').notNull(),",
            "lineNumber": 6
          },
          {
            "text": "  excerpt: text('excerpt'),",
            "lineNumber": 7
          },
          {
            "text": "  content: text('content').notNull(),",
            "lineNumber": 8
          },
          {
            "text": "  coverImage: text('cover_image'),",
            "lineNumber": 9
          },
          {
            "text": "  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),",
            "lineNumber": 10
          },
          {
            "text": "  published: boolean('published').default(false),",
            "lineNumber": 11
          },
          {
            "text": "  seoTitle: text('seo_title'),",
            "lineNumber": 12
          },
          {
            "text": "  seoDescription: text('seo_description'),",
            "lineNumber": 13
          },
          {
            "text": "  canonical: text('canonical'),",
            "lineNumber": 14
          },
          {
            "text": "  createdAt: timestamp('created_at').defaultNow().notNull(),",
            "lineNumber": 15
          },
          {
            "text": "  updatedAt: timestamp('updated_at').defaultNow().notNull(),",
            "lineNumber": 16
          },
          {
            "text": "})",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "export const pages = pgTable('pages', {",
            "lineNumber": 19
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 20
          }
        ]
      },
      "score": 0.3143247365951538
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/audit-images.ts",
        "range": {
          "startPosition": {
            "line": 23,
            "column": 1
          },
          "endPosition": {
            "line": 93,
            "column": 1
          }
        },
        "contents": "async function main() {\n  const allPosts = await db\n    .select()\n    .from(posts)\n    .orderBy(desc(posts.createdAt))\n\n  console.log(&#96;\\n=== Auditing ${allPosts.length} posts for image issues ===\\n&#96;)\n\n  const issues: Array&lt;{ slug: string; title: string; issue: string; wpImages?: string[] }&gt; = []\n\n  for (const post of allPosts) {\n    const content = post.content || ''\n    \n    // Check for malformed image links (link syntax instead of image syntax)\n    const malformedImages = content.match(/\\[[^\\]]*\\]\\((https:\\/\\/[^)]+\\.(jpg|jpeg|png|gif|webp))\\)/gi) || []\n    const properImages = content.match(/!\\[[^\\]]*\\]\\([^)]+\\)/gi) || []\n    \n    // Check for broken Supabase image URLs\n    const supabaseUrls = content.match(/https:\\/\\/pzoyeigicwgmmlngxowj\\.supabase\\.co[^)\\s\"]+/gi) || []\n    \n    // Check if content is very short (might be missing images)\n    const isShort = content.length &lt; 300\n    \n    let hasIssue = false\n    let issueDesc = []\n    \n    if (malformedImages.length &gt; 0) {\n      hasIssue = true\n      issueDesc.push(&#96;${malformedImages.length} malformed image link(s)&#96;)\n    }\n    \n    if (isShort &amp;&amp; properImages.length === 0 &amp;&amp; !content.includes('&lt;video')) {\n      hasIssue = true\n      issueDesc.push('Very short content, might be missing images')\n    }\n    \n    if (hasIssue) {\n      const wpImages = await getWordPressImages(post.slug)\n      issues.push({\n        slug: post.slug,\n        title: post.title,\n        issue: issueDesc.join('; '),\n        wpImages: wpImages.slice(0, 5)\n      })\n      console.log(&#96;‚ùå ${post.slug}: ${issueDesc.join('; ')}&#96;)\n      if (wpImages.length &gt; 0) {\n        console.log(&#96;   WordPress has ${wpImages.length} images&#96;)\n      }\n    } else {\n      console.log(&#96;‚úì ${post.slug}: OK (${properImages.length} images)&#96;)\n    }\n  }\n\n  console.log(&#96;\\n=== Summary ===&#96;)\n  console.log(&#96;Total posts: ${allPosts.length}&#96;)\n  console.log(&#96;Posts with issues: ${issues.length}&#96;)\n  \n  if (issues.length &gt; 0) {\n    console.log(&#96;\\n=== Posts needing fixes ===&#96;)\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function main() {",
            "lineNumber": 26,
            "isSignature": true
          },
          {
            "text": "  const allPosts = await db",
            "lineNumber": 27
          },
          {
            "text": "    .select()",
            "lineNumber": 28
          },
          {
            "text": "    .from(posts)",
            "lineNumber": 29
          },
          {
            "text": "    .orderBy(desc(posts.createdAt))",
            "lineNumber": 30
          },
          {
            "lineNumber": 31
          },
          {
            "text": "  console.log(&#96;\\n=== Auditing ${allPosts.length} posts for image issues ===\\n&#96;)",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "text": "  const issues: Array&lt;{ slug: string; title: string; issue: string; wpImages?: string[] }&gt; = []",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "  for (const post of allPosts) {",
            "lineNumber": 36
          },
          {
            "text": "    const content = post.content || ''",
            "lineNumber": 37
          },
          {
            "text": "    ",
            "lineNumber": 38
          },
          {
            "text": "    // Check for malformed image links (link syntax instead of image syntax)",
            "lineNumber": 39
          },
          {
            "text": "    const malformedImages = content.match(/\\[[^\\]]*\\]\\((https:\\/\\/[^)]+\\.(jpg|jpeg|png|gif|webp))\\)/gi) || []",
            "lineNumber": 40
          },
          {
            "text": "    const properImages = content.match(/!\\[[^\\]]*\\]\\([^)]+\\)/gi) || []",
            "lineNumber": 41
          },
          {
            "text": "    ",
            "lineNumber": 42
          },
          {
            "text": "    // Check for broken Supabase image URLs",
            "lineNumber": 43
          },
          {
            "text": "    const supabaseUrls = content.match(/https:\\/\\/pzoyeigicwgmmlngxowj\\.supabase\\.co[^)\\s\"]+/gi) || []",
            "lineNumber": 44
          },
          {
            "text": "    ",
            "lineNumber": 45
          },
          {
            "text": "    // Check if content is very short (might be missing images)",
            "lineNumber": 46
          },
          {
            "text": "    const isShort = content.length &lt; 300",
            "lineNumber": 47
          },
          {
            "text": "    ",
            "lineNumber": 48
          },
          {
            "text": "    let hasIssue = false",
            "lineNumber": 49
          },
          {
            "text": "    let issueDesc = []",
            "lineNumber": 50
          },
          {
            "text": "    ",
            "lineNumber": 51
          },
          {
            "text": "    if (malformedImages.length &gt; 0) {",
            "lineNumber": 52
          },
          {
            "text": "      hasIssue = true",
            "lineNumber": 53
          },
          {
            "text": "      issueDesc.push(&#96;${malformedImages.length} malformed image link(s)&#96;)",
            "lineNumber": 54
          },
          {
            "text": "    }",
            "lineNumber": 55
          },
          {
            "text": "    ",
            "lineNumber": 56
          },
          {
            "text": "    if (isShort &amp;&amp; properImages.length === 0 &amp;&amp; !content.includes('&lt;video')) {",
            "lineNumber": 57
          },
          {
            "text": "      hasIssue = true",
            "lineNumber": 58
          },
          {
            "text": "      issueDesc.push('Very short content, might be missing images')",
            "lineNumber": 59
          },
          {
            "text": "    }",
            "lineNumber": 60
          },
          {
            "text": "    ",
            "lineNumber": 61
          },
          {
            "text": "    if (hasIssue) {",
            "lineNumber": 62
          },
          {
            "text": "      const wpImages = await getWordPressImages(post.slug)",
            "lineNumber": 63
          },
          {
            "text": "      issues.push({",
            "lineNumber": 64
          },
          {
            "text": "        slug: post.slug,",
            "lineNumber": 65
          },
          {
            "text": "        title: post.title,",
            "lineNumber": 66
          },
          {
            "text": "        issue: issueDesc.join('; '),",
            "lineNumber": 67
          },
          {
            "text": "        wpImages: wpImages.slice(0, 5)",
            "lineNumber": 68
          },
          {
            "text": "      })",
            "lineNumber": 69
          },
          {
            "text": "      console.log(&#96;‚ùå ${post.slug}: ${issueDesc.join('; ')}&#96;)",
            "lineNumber": 70
          },
          {
            "text": "      if (wpImages.length &gt; 0) {",
            "lineNumber": 71
          },
          {
            "text": "        console.log(&#96;   WordPress has ${wpImages.length} images&#96;)",
            "lineNumber": 72
          },
          {
            "text": "      }",
            "lineNumber": 73
          },
          {
            "text": "    } else {",
            "lineNumber": 74
          },
          {
            "text": "      console.log(&#96;‚úì ${post.slug}: OK (${properImages.length} images)&#96;)",
            "lineNumber": 75
          },
          {
            "text": "    }",
            "lineNumber": 76
          },
          {
            "text": "  }",
            "lineNumber": 77
          },
          {
            "lineNumber": 78
          },
          {
            "text": "  console.log(&#96;\\n=== Summary ===&#96;)",
            "lineNumber": 79
          },
          {
            "text": "  console.log(&#96;Total posts: ${allPosts.length}&#96;)",
            "lineNumber": 80
          },
          {
            "text": "  console.log(&#96;Posts with issues: ${issues.length}&#96;)",
            "lineNumber": 81
          },
          {
            "text": "  ",
            "lineNumber": 82
          },
          {
            "text": "  if (issues.length &gt; 0) {",
            "lineNumber": 83
          },
          {
            "text": "    console.log(&#96;\\n=== Posts needing fixes ===&#96;)",
            "lineNumber": 84
          },
          {
            "text": "}",
            "lineNumber": 94,
            "isSignature": true
          }
        ]
      },
      "score": 0.31191179156303406
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/migrations/meta/0001_snapshot.json",
        "range": {
          "startPosition": {
            "line": 311,
            "column": 6
          },
          "endPosition": {
            "line": 389
          }
        },
        "contents": "\"name\": \"media\",\n      \"schema\": \"\",\n      \"columns\": {\n        \"id\": {\n          \"name\": \"id\",\n          \"type\": \"serial\",\n          \"primaryKey\": true,\n          \"notNull\": true\n        },\n        \"filename\": {\n          \"name\": \"filename\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": true\n        },\n        \"url\": {\n          \"name\": \"url\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": true\n        },\n        \"mime_type\": {\n          \"name\": \"mime_type\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"size\": {\n          \"name\": \"size\",\n          \"type\": \"integer\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"alt_text\": {\n          \"name\": \"alt_text\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"uploaded_by\": {\n          \"name\": \"uploaded_by\",\n          \"type\": \"integer\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"created_at\": {\n          \"name\": \"created_at\",\n          \"type\": \"timestamp\",\n          \"primaryKey\": false,\n          \"notNull\": true,\n          \"default\": \"now()\"\n        }\n      },\n      \"indexes\": {},\n      \"foreignKeys\": {\n        \"media_uploaded_by_users_id_fk\": {\n          \"name\": \"media_uploaded_by_users_id_fk\",\n          \"tableFrom\": \"media\",\n          \"tableTo\": \"users\",\n          \"columnsFrom\": [\n            \"uploaded_by\"\n          ],\n          \"columnsTo\": [\n            \"id\"\n          ],\n          \"onDelete\": \"no action\",\n          \"onUpdate\": \"no action\"\n        }\n      },\n      \"compositePrimaryKeys\": {},\n      \"uniqueConstraints\": {},\n      \"policies\": {},\n      \"checkConstraints\": {},\n      \"isRLSEnabled\": false\n    },\n    \"public.pages\": {\n      \"name\": \"pages\",\n      \"schema\": \"\",",
        "signatures": {},
        "detailedLines": [
          {
            "text": "\"name\": \"media\",",
            "lineNumber": 312
          },
          {
            "text": "      \"schema\": \"\",",
            "lineNumber": 313
          },
          {
            "text": "      \"columns\": {",
            "lineNumber": 314
          },
          {
            "text": "        \"id\": {",
            "lineNumber": 315
          },
          {
            "text": "          \"name\": \"id\",",
            "lineNumber": 316
          },
          {
            "text": "          \"type\": \"serial\",",
            "lineNumber": 317
          },
          {
            "text": "          \"primaryKey\": true,",
            "lineNumber": 318
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 319
          },
          {
            "text": "        },",
            "lineNumber": 320
          },
          {
            "text": "        \"filename\": {",
            "lineNumber": 321
          },
          {
            "text": "          \"name\": \"filename\",",
            "lineNumber": 322
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 323
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 324
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 325
          },
          {
            "text": "        },",
            "lineNumber": 326
          },
          {
            "text": "        \"url\": {",
            "lineNumber": 327
          },
          {
            "text": "          \"name\": \"url\",",
            "lineNumber": 328
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 329
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 330
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 331
          },
          {
            "text": "        },",
            "lineNumber": 332
          },
          {
            "text": "        \"mime_type\": {",
            "lineNumber": 333
          },
          {
            "text": "          \"name\": \"mime_type\",",
            "lineNumber": 334
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 335
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 336
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 337
          },
          {
            "text": "        },",
            "lineNumber": 338
          },
          {
            "text": "        \"size\": {",
            "lineNumber": 339
          },
          {
            "text": "          \"name\": \"size\",",
            "lineNumber": 340
          },
          {
            "text": "          \"type\": \"integer\",",
            "lineNumber": 341
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 342
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 343
          },
          {
            "text": "        },",
            "lineNumber": 344
          },
          {
            "text": "        \"alt_text\": {",
            "lineNumber": 345
          },
          {
            "text": "          \"name\": \"alt_text\",",
            "lineNumber": 346
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 347
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 348
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 349
          },
          {
            "text": "        },",
            "lineNumber": 350
          },
          {
            "text": "        \"uploaded_by\": {",
            "lineNumber": 351
          },
          {
            "text": "          \"name\": \"uploaded_by\",",
            "lineNumber": 352
          },
          {
            "text": "          \"type\": \"integer\",",
            "lineNumber": 353
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 354
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 355
          },
          {
            "text": "        },",
            "lineNumber": 356
          },
          {
            "text": "        \"created_at\": {",
            "lineNumber": 357
          },
          {
            "text": "          \"name\": \"created_at\",",
            "lineNumber": 358
          },
          {
            "text": "          \"type\": \"timestamp\",",
            "lineNumber": 359
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 360
          },
          {
            "text": "          \"notNull\": true,",
            "lineNumber": 361
          },
          {
            "text": "          \"default\": \"now()\"",
            "lineNumber": 362
          },
          {
            "text": "        }",
            "lineNumber": 363
          },
          {
            "text": "      },",
            "lineNumber": 364
          },
          {
            "text": "      \"indexes\": {},",
            "lineNumber": 365
          },
          {
            "text": "      \"foreignKeys\": {",
            "lineNumber": 366
          },
          {
            "text": "        \"media_uploaded_by_users_id_fk\": {",
            "lineNumber": 367
          },
          {
            "text": "          \"name\": \"media_uploaded_by_users_id_fk\",",
            "lineNumber": 368
          },
          {
            "text": "          \"tableFrom\": \"media\",",
            "lineNumber": 369
          },
          {
            "text": "          \"tableTo\": \"users\",",
            "lineNumber": 370
          },
          {
            "text": "          \"columnsFrom\": [",
            "lineNumber": 371
          },
          {
            "text": "            \"uploaded_by\"",
            "lineNumber": 372
          },
          {
            "text": "          ],",
            "lineNumber": 373
          },
          {
            "text": "          \"columnsTo\": [",
            "lineNumber": 374
          },
          {
            "text": "            \"id\"",
            "lineNumber": 375
          },
          {
            "text": "          ],",
            "lineNumber": 376
          },
          {
            "text": "          \"onDelete\": \"no action\",",
            "lineNumber": 377
          },
          {
            "text": "          \"onUpdate\": \"no action\"",
            "lineNumber": 378
          },
          {
            "text": "        }",
            "lineNumber": 379
          },
          {
            "text": "      },",
            "lineNumber": 380
          },
          {
            "text": "      \"compositePrimaryKeys\": {},",
            "lineNumber": 381
          },
          {
            "text": "      \"uniqueConstraints\": {},",
            "lineNumber": 382
          },
          {
            "text": "      \"policies\": {},",
            "lineNumber": 383
          },
          {
            "text": "      \"checkConstraints\": {},",
            "lineNumber": 384
          },
          {
            "text": "      \"isRLSEnabled\": false",
            "lineNumber": 385
          },
          {
            "text": "    },",
            "lineNumber": 386
          },
          {
            "text": "    \"public.pages\": {",
            "lineNumber": 387
          },
          {
            "text": "      \"name\": \"pages\",",
            "lineNumber": 388
          },
          {
            "text": "      \"schema\": \"\",",
            "lineNumber": 389
          }
        ]
      },
      "score": 0.31178370118141174
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/migrations/meta/0002_snapshot.json",
        "range": {
          "startPosition": {
            "line": 431
          },
          "endPosition": {
            "line": 510
          }
        },
        "contents": "    \"public.media\": {\n      \"name\": \"media\",\n      \"schema\": \"\",\n      \"columns\": {\n        \"id\": {\n          \"name\": \"id\",\n          \"type\": \"serial\",\n          \"primaryKey\": true,\n          \"notNull\": true\n        },\n        \"filename\": {\n          \"name\": \"filename\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": true\n        },\n        \"url\": {\n          \"name\": \"url\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": true\n        },\n        \"mime_type\": {\n          \"name\": \"mime_type\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"size\": {\n          \"name\": \"size\",\n          \"type\": \"integer\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"alt_text\": {\n          \"name\": \"alt_text\",\n          \"type\": \"text\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"uploaded_by\": {\n          \"name\": \"uploaded_by\",\n          \"type\": \"integer\",\n          \"primaryKey\": false,\n          \"notNull\": false\n        },\n        \"created_at\": {\n          \"name\": \"created_at\",\n          \"type\": \"timestamp\",\n          \"primaryKey\": false,\n          \"notNull\": true,\n          \"default\": \"now()\"\n        }\n      },\n      \"indexes\": {},\n      \"foreignKeys\": {\n        \"media_uploaded_by_users_id_fk\": {\n          \"name\": \"media_uploaded_by_users_id_fk\",\n          \"tableFrom\": \"media\",\n          \"tableTo\": \"users\",\n          \"columnsFrom\": [\n            \"uploaded_by\"\n          ],\n          \"columnsTo\": [\n            \"id\"\n          ],\n          \"onDelete\": \"no action\",\n          \"onUpdate\": \"no action\"\n        }\n      },\n      \"compositePrimaryKeys\": {},\n      \"uniqueConstraints\": {},\n      \"policies\": {},\n      \"checkConstraints\": {},\n      \"isRLSEnabled\": false\n    },\n    \"public.newsletters\": {\n      \"name\": \"newsletters\",\n      \"schema\": \"\",",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    \"public.media\": {",
            "lineNumber": 432
          },
          {
            "text": "      \"name\": \"media\",",
            "lineNumber": 433
          },
          {
            "text": "      \"schema\": \"\",",
            "lineNumber": 434
          },
          {
            "text": "      \"columns\": {",
            "lineNumber": 435
          },
          {
            "text": "        \"id\": {",
            "lineNumber": 436
          },
          {
            "text": "          \"name\": \"id\",",
            "lineNumber": 437
          },
          {
            "text": "          \"type\": \"serial\",",
            "lineNumber": 438
          },
          {
            "text": "          \"primaryKey\": true,",
            "lineNumber": 439
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 440
          },
          {
            "text": "        },",
            "lineNumber": 441
          },
          {
            "text": "        \"filename\": {",
            "lineNumber": 442
          },
          {
            "text": "          \"name\": \"filename\",",
            "lineNumber": 443
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 444
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 445
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 446
          },
          {
            "text": "        },",
            "lineNumber": 447
          },
          {
            "text": "        \"url\": {",
            "lineNumber": 448
          },
          {
            "text": "          \"name\": \"url\",",
            "lineNumber": 449
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 450
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 451
          },
          {
            "text": "          \"notNull\": true",
            "lineNumber": 452
          },
          {
            "text": "        },",
            "lineNumber": 453
          },
          {
            "text": "        \"mime_type\": {",
            "lineNumber": 454
          },
          {
            "text": "          \"name\": \"mime_type\",",
            "lineNumber": 455
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 456
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 457
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 458
          },
          {
            "text": "        },",
            "lineNumber": 459
          },
          {
            "text": "        \"size\": {",
            "lineNumber": 460
          },
          {
            "text": "          \"name\": \"size\",",
            "lineNumber": 461
          },
          {
            "text": "          \"type\": \"integer\",",
            "lineNumber": 462
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 463
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 464
          },
          {
            "text": "        },",
            "lineNumber": 465
          },
          {
            "text": "        \"alt_text\": {",
            "lineNumber": 466
          },
          {
            "text": "          \"name\": \"alt_text\",",
            "lineNumber": 467
          },
          {
            "text": "          \"type\": \"text\",",
            "lineNumber": 468
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 469
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 470
          },
          {
            "text": "        },",
            "lineNumber": 471
          },
          {
            "text": "        \"uploaded_by\": {",
            "lineNumber": 472
          },
          {
            "text": "          \"name\": \"uploaded_by\",",
            "lineNumber": 473
          },
          {
            "text": "          \"type\": \"integer\",",
            "lineNumber": 474
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 475
          },
          {
            "text": "          \"notNull\": false",
            "lineNumber": 476
          },
          {
            "text": "        },",
            "lineNumber": 477
          },
          {
            "text": "        \"created_at\": {",
            "lineNumber": 478
          },
          {
            "text": "          \"name\": \"created_at\",",
            "lineNumber": 479
          },
          {
            "text": "          \"type\": \"timestamp\",",
            "lineNumber": 480
          },
          {
            "text": "          \"primaryKey\": false,",
            "lineNumber": 481
          },
          {
            "text": "          \"notNull\": true,",
            "lineNumber": 482
          },
          {
            "text": "          \"default\": \"now()\"",
            "lineNumber": 483
          },
          {
            "text": "        }",
            "lineNumber": 484
          },
          {
            "text": "      },",
            "lineNumber": 485
          },
          {
            "text": "      \"indexes\": {},",
            "lineNumber": 486
          },
          {
            "text": "      \"foreignKeys\": {",
            "lineNumber": 487
          },
          {
            "text": "        \"media_uploaded_by_users_id_fk\": {",
            "lineNumber": 488
          },
          {
            "text": "          \"name\": \"media_uploaded_by_users_id_fk\",",
            "lineNumber": 489
          },
          {
            "text": "          \"tableFrom\": \"media\",",
            "lineNumber": 490
          },
          {
            "text": "          \"tableTo\": \"users\",",
            "lineNumber": 491
          },
          {
            "text": "          \"columnsFrom\": [",
            "lineNumber": 492
          },
          {
            "text": "            \"uploaded_by\"",
            "lineNumber": 493
          },
          {
            "text": "          ],",
            "lineNumber": 494
          },
          {
            "text": "          \"columnsTo\": [",
            "lineNumber": 495
          },
          {
            "text": "            \"id\"",
            "lineNumber": 496
          },
          {
            "text": "          ],",
            "lineNumber": 497
          },
          {
            "text": "          \"onDelete\": \"no action\",",
            "lineNumber": 498
          },
          {
            "text": "          \"onUpdate\": \"no action\"",
            "lineNumber": 499
          },
          {
            "text": "        }",
            "lineNumber": 500
          },
          {
            "text": "      },",
            "lineNumber": 501
          },
          {
            "text": "      \"compositePrimaryKeys\": {},",
            "lineNumber": 502
          },
          {
            "text": "      \"uniqueConstraints\": {},",
            "lineNumber": 503
          },
          {
            "text": "      \"policies\": {},",
            "lineNumber": 504
          },
          {
            "text": "      \"checkConstraints\": {},",
            "lineNumber": 505
          },
          {
            "text": "      \"isRLSEnabled\": false",
            "lineNumber": 506
          },
          {
            "text": "    },",
            "lineNumber": 507
          },
          {
            "text": "    \"public.newsletters\": {",
            "lineNumber": 508
          },
          {
            "text": "      \"name\": \"newsletters\",",
            "lineNumber": 509
          },
          {
            "text": "      \"schema\": \"\",",
            "lineNumber": 510
          }
        ]
      },
      "score": 0.31077325344085693
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/fix-corrupted-posts.ts",
        "range": {
          "startPosition": {
            "column": 83
          },
          "endPosition": {
            "line": 54
          }
        },
        "contents": "import { db } from '../db'\nimport { posts } from '../db/schema'\nimport { eq } from 'drizzle-orm'\n\n// Posts that need to be manually fixed due to severely corrupted content\nconst CORRUPTED_POSTS: Record&lt;string, string&gt; = {\n  'afrofilterism-demo-day': &#96;# AfroFilterism Demo Day\n\n![Demo Day Banner](https://hiiiwav.org/wp-content/uploads/2022/11/Screen-Shot-2022-11-08-at-10.05.27-AM.png)\n\nThe amazing teams from Demo Day!\n\n![Demo Day Photo 1](https://hiiiwav.org/wp-content/uploads/2022/11/136DemoDay102022-scaled.jpg)\n\n![Demo Day Photo 2](https://hiiiwav.org/wp-content/uploads/2022/11/037DemoDay102022-scaled.jpg)\n&#96;,\n\n  'demo-day': &#96;# Demo Day\n\n![Demo Day 2024](https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/2024/02/Demo-Day-2024-1.jpg)\n&#96;,\n\n  'afro-ai-residency': &#96;# AFRO AI Residency\n\n![AFRO AI Residency](https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/2024/02/Screenshot-2024-02-22-160750.png)\n&#96;,\n}\n\nasync function main() {\n  console.log('\\n=== Fixing corrupted posts ===\\n')\n\n  for (const [slug, newContent] of Object.entries(CORRUPTED_POSTS)) {\n    const post = await db.select().from(posts).where(eq(posts.slug, slug)).limit(1).then(r =&gt; r[0])\n    \n    if (!post) {\n      console.log(&#96;‚ùå ${slug}: Post not found&#96;)\n      continue\n    }\n\n    await db\n      .update(posts)\n      .set({ content: newContent })\n      .where(eq(posts.id, post.id))\n\n    console.log(&#96;‚úÖ Fixed: ${slug}&#96;)\n  }\n\n  console.log('\\n=== Done! ===')\n}\n\nmain().then(() =&gt; process.exit(0)).catch",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { db } from '../db'",
            "lineNumber": 2
          },
          {
            "text": "import { posts } from '../db/schema'",
            "lineNumber": 3
          },
          {
            "text": "import { eq } from 'drizzle-orm'",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "// Posts that need to be manually fixed due to severely corrupted content",
            "lineNumber": 6
          },
          {
            "text": "const CORRUPTED_POSTS: Record&lt;string, string&gt; = {",
            "lineNumber": 7
          },
          {
            "text": "  'afrofilterism-demo-day': &#96;# AfroFilterism Demo Day",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "![Demo Day Banner](https://hiiiwav.org/wp-content/uploads/2022/11/Screen-Shot-2022-11-08-at-10.05.27-AM.png)",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "The amazing teams from Demo Day!",
            "lineNumber": 12
          },
          {
            "lineNumber": 13
          },
          {
            "text": "![Demo Day Photo 1](https://hiiiwav.org/wp-content/uploads/2022/11/136DemoDay102022-scaled.jpg)",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "![Demo Day Photo 2](https://hiiiwav.org/wp-content/uploads/2022/11/037DemoDay102022-scaled.jpg)",
            "lineNumber": 16
          },
          {
            "text": "&#96;,",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "  'demo-day': &#96;# Demo Day",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "![Demo Day 2024](https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/2024/02/Demo-Day-2024-1.jpg)",
            "lineNumber": 21
          },
          {
            "text": "&#96;,",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "  'afro-ai-residency': &#96;# AFRO AI Residency",
            "lineNumber": 24
          },
          {
            "lineNumber": 25
          },
          {
            "text": "![AFRO AI Residency](https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/2024/02/Screenshot-2024-02-22-160750.png)",
            "lineNumber": 26
          },
          {
            "text": "&#96;,",
            "lineNumber": 27
          },
          {
            "text": "}",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "async function main() {",
            "lineNumber": 30,
            "isSignature": true
          },
          {
            "text": "  console.log('\\n=== Fixing corrupted posts ===\\n')",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "  for (const [slug, newContent] of Object.entries(CORRUPTED_POSTS)) {",
            "lineNumber": 33
          },
          {
            "text": "    const post = await db.select().from(posts).where(eq(posts.slug, slug)).limit(1).then(r =&gt; r[0])",
            "lineNumber": 34
          },
          {
            "text": "    ",
            "lineNumber": 35
          },
          {
            "text": "    if (!post) {",
            "lineNumber": 36
          },
          {
            "text": "      console.log(&#96;‚ùå ${slug}: Post not found&#96;)",
            "lineNumber": 37
          },
          {
            "text": "      continue",
            "lineNumber": 38
          },
          {
            "text": "    }",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "    await db",
            "lineNumber": 41
          },
          {
            "text": "      .update(posts)",
            "lineNumber": 42
          },
          {
            "text": "      .set({ content: newContent })",
            "lineNumber": 43
          },
          {
            "text": "      .where(eq(posts.id, post.id))",
            "lineNumber": 44
          },
          {
            "lineNumber": 45
          },
          {
            "text": "    console.log(&#96;‚úÖ Fixed: ${slug}&#96;)",
            "lineNumber": 46
          },
          {
            "text": "  }",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "  console.log('\\n=== Done! ===')",
            "lineNumber": 49
          },
          {
            "text": "}",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "lineNumber": 51
          },
          {
            "text": "main().then(() =&gt; process.exit(0)).catch",
            "lineNumber": 52
          }
        ]
      },
      "score": 0.3055088520050049
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 97,
            "column": 1
          },
          "endPosition": {
            "line": 164,
            "column": 1
          }
        },
        "contents": "function getMimeType(filePath: string): string {\n  const ext = path.extname(filePath).toLowerCase()\n  const mimeTypes: Record&lt;string, string&gt; = {\n    '.jpg': 'image/jpeg',\n    '.jpeg': 'image/jpeg',\n    '.png': 'image/png',\n    '.gif': 'image/gif',\n    '.webp': 'image/webp',\n    '.svg': 'image/svg+xml',\n  }\n  return mimeTypes[ext] || 'application/octet-stream'\n}\n\nasync function updateDatabaseUrls(urlMap: Map&lt;string, string&gt;) {\n  console.log('\\nüìù Updating database URLs...')\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "function getMimeType(filePath: string): string {",
            "lineNumber": 100,
            "isSignature": true
          },
          {
            "text": "  const ext = path.extname(filePath).toLowerCase()",
            "lineNumber": 101
          },
          {
            "text": "  const mimeTypes: Record&lt;string, string&gt; = {",
            "lineNumber": 102
          },
          {
            "text": "    '.jpg': 'image/jpeg',",
            "lineNumber": 103
          },
          {
            "text": "    '.jpeg': 'image/jpeg',",
            "lineNumber": 104
          },
          {
            "text": "    '.png': 'image/png',",
            "lineNumber": 105
          },
          {
            "text": "    '.gif': 'image/gif',",
            "lineNumber": 106
          },
          {
            "text": "    '.webp': 'image/webp',",
            "lineNumber": 107
          },
          {
            "text": "    '.svg': 'image/svg+xml',",
            "lineNumber": 108
          },
          {
            "text": "  }",
            "lineNumber": 109
          },
          {
            "text": "  return mimeTypes[ext] || 'application/octet-stream'",
            "lineNumber": 110
          },
          {
            "text": "}",
            "lineNumber": 111,
            "isSignature": true
          },
          {
            "lineNumber": 112
          },
          {
            "text": "async function updateDatabaseUrls(urlMap: Map&lt;string, string&gt;) {",
            "lineNumber": 113,
            "isSignature": true
          },
          {
            "text": "  console.log('\\nüìù Updating database URLs...')",
            "lineNumber": 114
          },
          {
            "text": "}",
            "lineNumber": 165,
            "isSignature": true
          }
        ]
      },
      "score": 0.29165029525756836
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 110,
            "column": 1
          },
          "endPosition": {
            "line": 214,
            "column": 1
          }
        },
        "contents": "async function updateDatabaseUrls(urlMap: Map&lt;string, string&gt;) {\n  console.log('\\nüìù Updating database URLs...')\n  \n  // Update posts\n  const allPosts = await db.select().from(posts)\n  for (const post of allPosts) {\n    let updated = false\n    let newContent = post.content\n    let newCoverImage = post.coverImage\n    \n    // Update cover image\n    if (post.coverImage &amp;&amp; urlMap.has(post.coverImage)) {\n      newCoverImage = urlMap.get(post.coverImage)!\n      updated = true\n    }\n    \n    // Update content\n    for (const [oldUrl, newUrl] of urlMap) {\n      if (newContent.includes(oldUrl)) {\n        newContent = newContent.split(oldUrl).join(newUrl)\n        updated = true\n      }\n    }\n    \n    if (updated) {\n      await db.update(posts)\n        .set({ content: newContent, coverImage: newCoverImage })\n        .where(eq(posts.id, post.id))\n      console.log(&#96;  ‚úì Updated post: ${post.slug}&#96;)\n    }\n  }\n  \n  // Update pages\n  const allPages = await db.select().from(pages)\n  for (const page of allPages) {\n    let updated = false\n    let newContent = page.content\n    \n    for (const [oldUrl, newUrl] of urlMap) {\n      if (newContent.includes(oldUrl)) {\n        newContent = newContent.split(oldUrl).join(newUrl)\n        updated = true\n      }\n    }\n    \n    if (updated) {\n      await db.update(pages)\n        .set({ content: newContent })\n        .where(eq(pages.id, page.id))\n      console.log(&#96;  ‚úì Updated page: ${page.slug}&#96;)\n    }\n  }\n}\n\nasync function main() {\n  console.log('üöÄ Starting image migration to Supabase Storage\\n')\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function updateDatabaseUrls(urlMap: Map&lt;string, string&gt;) {",
            "lineNumber": 113,
            "isSignature": true
          },
          {
            "text": "  console.log('\\nüìù Updating database URLs...')",
            "lineNumber": 114
          },
          {
            "text": "  ",
            "lineNumber": 115
          },
          {
            "text": "  // Update posts",
            "lineNumber": 116
          },
          {
            "text": "  const allPosts = await db.select().from(posts)",
            "lineNumber": 117
          },
          {
            "text": "  for (const post of allPosts) {",
            "lineNumber": 118
          },
          {
            "text": "    let updated = false",
            "lineNumber": 119
          },
          {
            "text": "    let newContent = post.content",
            "lineNumber": 120
          },
          {
            "text": "    let newCoverImage = post.coverImage",
            "lineNumber": 121
          },
          {
            "text": "    ",
            "lineNumber": 122
          },
          {
            "text": "    // Update cover image",
            "lineNumber": 123
          },
          {
            "text": "    if (post.coverImage &amp;&amp; urlMap.has(post.coverImage)) {",
            "lineNumber": 124
          },
          {
            "text": "      newCoverImage = urlMap.get(post.coverImage)!",
            "lineNumber": 125
          },
          {
            "text": "      updated = true",
            "lineNumber": 126
          },
          {
            "text": "    }",
            "lineNumber": 127
          },
          {
            "text": "    ",
            "lineNumber": 128
          },
          {
            "text": "    // Update content",
            "lineNumber": 129
          },
          {
            "text": "    for (const [oldUrl, newUrl] of urlMap) {",
            "lineNumber": 130
          },
          {
            "text": "      if (newContent.includes(oldUrl)) {",
            "lineNumber": 131
          },
          {
            "text": "        newContent = newContent.split(oldUrl).join(newUrl)",
            "lineNumber": 132
          },
          {
            "text": "        updated = true",
            "lineNumber": 133
          },
          {
            "text": "      }",
            "lineNumber": 134
          },
          {
            "text": "    }",
            "lineNumber": 135
          },
          {
            "text": "    ",
            "lineNumber": 136
          },
          {
            "text": "    if (updated) {",
            "lineNumber": 137
          },
          {
            "text": "      await db.update(posts)",
            "lineNumber": 138
          },
          {
            "text": "        .set({ content: newContent, coverImage: newCoverImage })",
            "lineNumber": 139
          },
          {
            "text": "        .where(eq(posts.id, post.id))",
            "lineNumber": 140
          },
          {
            "text": "      console.log(&#96;  ‚úì Updated post: ${post.slug}&#96;)",
            "lineNumber": 141
          },
          {
            "text": "    }",
            "lineNumber": 142
          },
          {
            "text": "  }",
            "lineNumber": 143
          },
          {
            "text": "  ",
            "lineNumber": 144
          },
          {
            "text": "  // Update pages",
            "lineNumber": 145
          },
          {
            "text": "  const allPages = await db.select().from(pages)",
            "lineNumber": 146
          },
          {
            "text": "  for (const page of allPages) {",
            "lineNumber": 147
          },
          {
            "text": "    let updated = false",
            "lineNumber": 148
          },
          {
            "text": "    let newContent = page.content",
            "lineNumber": 149
          },
          {
            "text": "    ",
            "lineNumber": 150
          },
          {
            "text": "    for (const [oldUrl, newUrl] of urlMap) {",
            "lineNumber": 151
          },
          {
            "text": "      if (newContent.includes(oldUrl)) {",
            "lineNumber": 152
          },
          {
            "text": "        newContent = newContent.split(oldUrl).join(newUrl)",
            "lineNumber": 153
          },
          {
            "text": "        updated = true",
            "lineNumber": 154
          },
          {
            "text": "      }",
            "lineNumber": 155
          },
          {
            "text": "    }",
            "lineNumber": 156
          },
          {
            "text": "    ",
            "lineNumber": 157
          },
          {
            "text": "    if (updated) {",
            "lineNumber": 158
          },
          {
            "text": "      await db.update(pages)",
            "lineNumber": 159
          },
          {
            "text": "        .set({ content: newContent })",
            "lineNumber": 160
          },
          {
            "text": "        .where(eq(pages.id, page.id))",
            "lineNumber": 161
          },
          {
            "text": "      console.log(&#96;  ‚úì Updated page: ${page.slug}&#96;)",
            "lineNumber": 162
          },
          {
            "text": "    }",
            "lineNumber": 163
          },
          {
            "text": "  }",
            "lineNumber": 164
          },
          {
            "text": "}",
            "lineNumber": 165,
            "isSignature": true
          },
          {
            "lineNumber": 166
          },
          {
            "text": "async function main() {",
            "lineNumber": 167,
            "isSignature": true
          },
          {
            "text": "  console.log('üöÄ Starting image migration to Supabase Storage\\n')",
            "lineNumber": 168
          },
          {
            "text": "}",
            "lineNumber": 215,
            "isSignature": true
          }
        ]
      },
      "score": 0.29055678844451904
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./.next/dev/server/chunks/ssr/[root-of-the-server]__b590eaa1._.js",
        "range": {
          "startPosition": {
            "line": 57,
            "column": 50
          },
          "endPosition": {
            "line": 256,
            "column": 1
          }
        },
        "contents": "(__turbopack_context__) =&gt; {\n\nconst media = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$table$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"pgTable\"])('media', {\n    id: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$serial$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"serial\"])('id').primaryKey(),\n    filename: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('filename').notNull(),\n    url: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('url').notNull(),\n    mimeType: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('mime_type'),\n    size: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$integer$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"integer\"])('size'),\n    altText: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('alt_text'),\n    uploadedBy: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$integer$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"integer\"])('uploaded_by').references(()=&gt;users.id),\n    createdAt: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$timestamp$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"timestamp\"])('created_at').defaultNow().notNull()\n});\nconst entities = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$table$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"pgTable\"])('entities', {\n    id: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$serial$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 58,
                "column": 51
              },
              "endPosition": {
                "line": 59,
                "column": 1
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "(__turbopack_context__) =&gt; {",
            "lineNumber": 58
          },
          {
            "lineNumber": 128
          },
          {
            "text": "const media = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$table$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"pgTable\"])('media', {",
            "lineNumber": 129
          },
          {
            "text": "    id: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$serial$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"serial\"])('id').primaryKey(),",
            "lineNumber": 130
          },
          {
            "text": "    filename: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('filename').notNull(),",
            "lineNumber": 131
          },
          {
            "text": "    url: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('url').notNull(),",
            "lineNumber": 132
          },
          {
            "text": "    mimeType: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('mime_type'),",
            "lineNumber": 133
          },
          {
            "text": "    size: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$integer$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"integer\"])('size'),",
            "lineNumber": 134
          },
          {
            "text": "    altText: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$text$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"text\"])('alt_text'),",
            "lineNumber": 135
          },
          {
            "text": "    uploadedBy: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$integer$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"integer\"])('uploaded_by').references(()=&gt;users.id),",
            "lineNumber": 136
          },
          {
            "text": "    createdAt: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$timestamp$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"timestamp\"])('created_at').defaultNow().notNull()",
            "lineNumber": 137
          },
          {
            "text": "});",
            "lineNumber": 138
          },
          {
            "text": "const entities = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$table$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"pgTable\"])('entities', {",
            "lineNumber": 139
          },
          {
            "text": "    id: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$pg$2d$core$2f$columns$2f$serial$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__",
            "lineNumber": 140
          },
          {
            "text": ";",
            "lineNumber": 154
          },
          {
            "text": "}",
            "lineNumber": 257
          }
        ]
      },
      "score": 0.29046154022216797
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/schema.ts",
        "range": {
          "startPosition": {
            "line": 49,
            "column": 2
          },
          "endPosition": {
            "line": 99
          }
        },
        "contents": "// Entities: HiiiWAV org, participant artists, and staff members\nexport const entities = pgTable('entities', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  name: text('name').notNull(),\n  type: text('type').notNull(), // 'organization', 'participant', 'staff'\n  bio: text('bio'),\n  shortBio: text('short_bio'),\n  image: text('image'),\n  website: text('website'),\n  socialLinks: jsonb('social_links').$type&lt;{\n    instagram?: string\n    twitter?: string\n    spotify?: string\n    youtube?: string\n    facebook?: string\n    tiktok?: string\n    soundcloud?: string\n    bandcamp?: string\n    linkedin?: string\n  }&gt;(),\n  genre: text('genre'), // For artists\n  role: text('role'), // For staff (e.g., \"Executive Director\")\n  active: boolean('active').default(true),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\n// Awards, grants, and recognitions\nexport const awards = pgTable",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// Entities: HiiiWAV org, participant artists, and staff members",
            "lineNumber": 52
          },
          {
            "text": "export const entities = pgTable('entities', {",
            "lineNumber": 53
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 54
          },
          {
            "text": "  slug: text('slug').notNull().unique(),",
            "lineNumber": 55
          },
          {
            "text": "  name: text('name').notNull(),",
            "lineNumber": 56
          },
          {
            "text": "  type: text('type').notNull(), // 'organization', 'participant', 'staff'",
            "lineNumber": 57
          },
          {
            "text": "  bio: text('bio'),",
            "lineNumber": 58
          },
          {
            "text": "  shortBio: text('short_bio'),",
            "lineNumber": 59
          },
          {
            "text": "  image: text('image'),",
            "lineNumber": 60
          },
          {
            "text": "  website: text('website'),",
            "lineNumber": 61
          },
          {
            "text": "  socialLinks: jsonb('social_links').$type&lt;{",
            "lineNumber": 62
          },
          {
            "text": "    instagram?: string",
            "lineNumber": 63
          },
          {
            "text": "    twitter?: string",
            "lineNumber": 64
          },
          {
            "text": "    spotify?: string",
            "lineNumber": 65
          },
          {
            "text": "    youtube?: string",
            "lineNumber": 66
          },
          {
            "text": "    facebook?: string",
            "lineNumber": 67
          },
          {
            "text": "    tiktok?: string",
            "lineNumber": 68
          },
          {
            "text": "    soundcloud?: string",
            "lineNumber": 69
          },
          {
            "text": "    bandcamp?: string",
            "lineNumber": 70
          },
          {
            "text": "    linkedin?: string",
            "lineNumber": 71
          },
          {
            "text": "  }&gt;(),",
            "lineNumber": 72
          },
          {
            "text": "  genre: text('genre'), // For artists",
            "lineNumber": 73
          },
          {
            "text": "  role: text('role'), // For staff (e.g., \"Executive Director\")",
            "lineNumber": 74
          },
          {
            "text": "  active: boolean('active').default(true),",
            "lineNumber": 75
          },
          {
            "text": "  createdAt: timestamp('created_at').defaultNow().notNull(),",
            "lineNumber": 76
          },
          {
            "text": "  updatedAt: timestamp('updated_at').defaultNow().notNull(),",
            "lineNumber": 77
          },
          {
            "text": "})",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "// Awards, grants, and recognitions",
            "lineNumber": 80
          },
          {
            "text": "export const awards = pgTable",
            "lineNumber": 81
          }
        ]
      },
      "score": 0.27119290828704834
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/wordpress_to_next.js_migration_plan.md",
        "range": {
          "startPosition": {
            "line": 57
          },
          "endPosition": {
            "line": 115
          }
        },
        "contents": "- **Vercel** (serverless + edge runtime)\n- Preview branches for staging\n- Environment variables for secrets\n\n### Additional Tools\n- **next-seo** - SEO meta tags\n- **next-sitemap** - Automatic sitemap generation\n- **Vercel Analytics** + **GA4** - Traffic tracking\n- **Sentry** - Error monitoring (optional)\n\n---\n\n## Database Schema (Drizzle)\n\n&#96;&#96;&#96;typescript\n// db/schema.ts\nimport { pgTable, text, timestamp, boolean, serial, jsonb } from 'drizzle-orm/pg-core'\n\nexport const posts = pgTable('posts', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  excerpt: text('excerpt'),\n  content: text('content').notNull(),       // HTML or Markdown\n  coverImage: text('cover_image'),\n  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),\n  published: boolean('published').default(false),\n  seoTitle: text('seo_title'),\n  seoDescription: text('seo_description'),\n  canonical: text('canonical'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport const pages = pgTable('pages', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  content: text('content').notNull(),\n  seoTitle: text('seo_title'),\n  seoDescription: text('seo_description'),\n  canonical: text('canonical'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport const users = pgTable('users', {\n  id: serial('id').primaryKey(),\n  email: text('email').notNull().unique(),\n  name: text('name'),\n  role: text('role').default('user'),  // 'admin' | 'user'\n  image: text('image'),\n  passwordHash: text('password_hash'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n})\n\nexport const media = pgTable('media', {\n  id: serial('id').primaryKey(),",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- **Vercel** (serverless + edge runtime)",
            "lineNumber": 58
          },
          {
            "text": "- Preview branches for staging",
            "lineNumber": 59
          },
          {
            "text": "- Environment variables for secrets",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "### Additional Tools",
            "lineNumber": 62
          },
          {
            "text": "- **next-seo** - SEO meta tags",
            "lineNumber": 63
          },
          {
            "text": "- **next-sitemap** - Automatic sitemap generation",
            "lineNumber": 64
          },
          {
            "text": "- **Vercel Analytics** + **GA4** - Traffic tracking",
            "lineNumber": 65
          },
          {
            "text": "- **Sentry** - Error monitoring (optional)",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "---",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "## Database Schema (Drizzle)",
            "lineNumber": 70
          },
          {
            "lineNumber": 71
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 72
          },
          {
            "text": "// db/schema.ts",
            "lineNumber": 73
          },
          {
            "text": "import { pgTable, text, timestamp, boolean, serial, jsonb } from 'drizzle-orm/pg-core'",
            "lineNumber": 74
          },
          {
            "lineNumber": 75
          },
          {
            "text": "export const posts = pgTable('posts', {",
            "lineNumber": 76
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 77
          },
          {
            "text": "  slug: text('slug').notNull().unique(),",
            "lineNumber": 78
          },
          {
            "text": "  title: text('title').notNull(),",
            "lineNumber": 79
          },
          {
            "text": "  excerpt: text('excerpt'),",
            "lineNumber": 80
          },
          {
            "text": "  content: text('content').notNull(),       // HTML or Markdown",
            "lineNumber": 81
          },
          {
            "text": "  coverImage: text('cover_image'),",
            "lineNumber": 82
          },
          {
            "text": "  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),",
            "lineNumber": 83
          },
          {
            "text": "  published: boolean('published').default(false),",
            "lineNumber": 84
          },
          {
            "text": "  seoTitle: text('seo_title'),",
            "lineNumber": 85
          },
          {
            "text": "  seoDescription: text('seo_description'),",
            "lineNumber": 86
          },
          {
            "text": "  canonical: text('canonical'),",
            "lineNumber": 87
          },
          {
            "text": "  createdAt: timestamp('created_at').defaultNow().notNull(),",
            "lineNumber": 88
          },
          {
            "text": "  updatedAt: timestamp('updated_at').defaultNow().notNull(),",
            "lineNumber": 89
          },
          {
            "text": "})",
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "text": "export const pages = pgTable('pages', {",
            "lineNumber": 92
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 93
          },
          {
            "text": "  slug: text('slug').notNull().unique(),",
            "lineNumber": 94
          },
          {
            "text": "  title: text('title').notNull(),",
            "lineNumber": 95
          },
          {
            "text": "  content: text('content').notNull(),",
            "lineNumber": 96
          },
          {
            "text": "  seoTitle: text('seo_title'),",
            "lineNumber": 97
          },
          {
            "text": "  seoDescription: text('seo_description'),",
            "lineNumber": 98
          },
          {
            "text": "  canonical: text('canonical'),",
            "lineNumber": 99
          },
          {
            "text": "  createdAt: timestamp('created_at').defaultNow().notNull(),",
            "lineNumber": 100
          },
          {
            "text": "  updatedAt: timestamp('updated_at').defaultNow().notNull(),",
            "lineNumber": 101
          },
          {
            "text": "})",
            "lineNumber": 102
          },
          {
            "lineNumber": 103
          },
          {
            "text": "export const users = pgTable('users', {",
            "lineNumber": 104
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 105
          },
          {
            "text": "  email: text('email').notNull().unique(),",
            "lineNumber": 106
          },
          {
            "text": "  name: text('name'),",
            "lineNumber": 107
          },
          {
            "text": "  role: text('role').default('user'),  // 'admin' | 'user'",
            "lineNumber": 108
          },
          {
            "text": "  image: text('image'),",
            "lineNumber": 109
          },
          {
            "text": "  passwordHash: text('password_hash'),",
            "lineNumber": 110
          },
          {
            "text": "  createdAt: timestamp('created_at').defaultNow().notNull(),",
            "lineNumber": 111
          },
          {
            "text": "})",
            "lineNumber": 112
          },
          {
            "lineNumber": 113
          },
          {
            "text": "export const media = pgTable('media', {",
            "lineNumber": 114
          },
          {
            "text": "  id: serial('id').primaryKey(),",
            "lineNumber": 115
          }
        ]
      },
      "score": 0.2689686119556427
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./.next/dev/server/chunks/ssr/[root-of-the-server]__b590eaa1._.js.map",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 7
          }
        },
        "contents": "{\n  \"version\": 3,\n  \"sources\": [],\n  \"sections\": [\n    {\"offset\": {\"line\": 60, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"file:///Users/boskombp16/GitHub/hiiiwav-website/db/schema.ts\"],\"sourcesContent\":[\"import { pgTable, text, timestamp, boolean, serial, jsonb, integer, date } from 'drizzle-orm/pg-core'\\n\\nexport const posts = pgTable('posts', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  excerpt: text('excerpt'),\\n  content: text('content').notNull(),\\n  coverImage: text('cover_image'),\\n  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),\\n  published: boolean('published').default(false),\\n  seoTitle: text('seo_title'),\\n  seoDescription: text('seo_description'),\\n  canonical: text('canonical'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport const pages = pgTable('pages', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  content: text('content').notNull(),\\n  seoTitle: text('seo_title'),\\n  seoDescription: text('seo_description'),\\n  canonical: text('canonical'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport const users = pgTable('users', {\\n  id: serial('id').primaryKey(),\\n  email: text('email').notNull().unique(),\\n  name: text('name'),\\n  role: text('role').default('user'),\\n  image: text('image'),\\n  passwordHash: text('password_hash'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n})\\n\\nexport const media = pgTable('media', {\\n  id: serial('id').primaryKey(),\\n  filename: text('filename').notNull(),\\n  url: text('url').notNull(),\\n  mimeType: text('mime_type'),\\n  size: integer('size'),\\n  altText: text('alt_text'),\\n  uploadedBy: integer('uploaded_by').references(() =&gt; users.id),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n})\\n\\n// Entities: HiiiWAV org, participant artists, and staff members\\nexport const entities = pgTable('entities', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  name: text('name').notNull(),\\n  type: text('type').notNull(), // 'organization', 'participant', 'staff'\\n  bio: text('bio'),\\n  shortBio: text('short_bio'),\\n  image: text('image'),\\n  website: text('website'),\\n  socialLinks: jsonb('social_links').$type&lt;{\\n    instagram?: string\\n    twitter?: string\\n    spotify?: string\\n    youtube?: string\\n    facebook?: string\\n    tiktok?: string\\n    soundcloud?: string\\n    bandcamp?: string\\n    linkedin?: string\\n  }&gt;(),\\n  genre: text('genre'), // For artists\\n  role: text('role'), // For staff (e.g., \\\"Executive Director\\\")\\n  active: boolean('active').default(true),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\n// Awards, grants, and recognitions\\nexport const awards = pgTable('awards', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  name: text('name').notNull(),\\n  awardingEntity: text('awarding_entity').notNull(), // Organization that gave the award\\n  awardDate: date('award_date'),\\n  year: integer('year'), // Fallback when exact date unknown\\n  category: text('category'), // 'grant', 'award', 'fellowship', 'recognition', 'nomination'\\n  status: text('status').default('won'), // 'won', 'nominated', 'finalist', 'honorable_mention'\\n  prizeAmount: integer('prize_amount'), // In cents for precision\\n  prizeDescription: text('prize_description'), // Non-monetary prize details\\n  description: text('description'),\\n  notableFacts: text('notable_facts'),\\n  awardingOrgUrl: text('awarding_org_url'),\\n  awardPageUrl: text('award_page_url'),\\n  pressUrl: text('press_url'),\\n  image: text('image'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\n// Junction table: links awards to entities (many-to-many)\\nexport const awardRecipients = pgTable('award_recipients', {\\n  id: serial('id').primaryKey(),\\n  awardId: integer('award_id').notNull().references(() =&gt; awards.id, { onDelete: 'cascade' }),\\n  entityId: integer('entity_id').notNull().references(() =&gt; entities.id, { onDelete: 'cascade' }),\\n  recipientRole: text('recipient_role'), // 'primary', 'collaborator', 'featured'\\n})\\n\\nexport type Post = typeof posts.$inferSelect\\nexport type NewPost = typeof posts.$inferInsert\\nexport type Page = typeof pages.$inferSelect\\nexport type NewPage = typeof pages.$inferInsert\\nexport type User = typeof users.$inferSelect\\nexport type Media = typeof media.$inferSelect\\nexport type Entity = typeof entities.$inferSelect\\nexport type NewEntity = typeof entities.$inferInsert\\nexport type Award = typeof awards.$inferSelect\\nexport type NewAward = typeof awards.$inferInsert\\nexport type AwardRecipient = typeof awardRecipients.$inferSelect\\nexport type NewAwardRecipient = typeof awardRecipients.$inferInsert\\n\\n// Redirects for SEO preservation\\nexport const redirects = pgTable('redirects', {\\n  id: serial('id').primaryKey(),\\n  sourceUrl: text('source_url').notNull().unique(), // The old URL path (e.g., /old-page)\\n  destinationUrl: text('destination_url').notNull(), // Where to redirect to (e.g., /new-page)\\n  statusCode: integer('status_code').default(301), // 301 permanent, 302 temporary, 307, 308\\n  enabled: boolean('enabled').default(true),\\n  hitCount: integer('hit_count').default(0), // Track how often this redirect is used\\n  lastHitAt: timestamp('last_hit_at'),\\n  notes: text('notes'), // Admin notes about this redirect\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type Redirect = typeof redirects.$inferSelect\\nexport type NewRedirect = typeof redirects.$inferInsert\\n\\n// Oakland Tech Week Venue Host Applications\\nexport const venueHosts = pgTable('venue_hosts', {\\n  id: serial('id').primaryKey(),\\n  // Contact info\\n  contactName: text('contact_name').notNull(),\\n  email: text('email').notNull(),\\n  phone: text('phone'),\\n  // Venue info\\n  venueName: text('venue_name').notNull(),\\n  address: text('address').notNull(),\\n  city: text('city').default('Oakland'),\\n  neighborhood: text('neighborhood'), // e.g., \\\"Downtown\\\", \\\"Temescal\\\", \\\"West Oakland\\\"\\n  capacity: integer('capacity'), // Max number of people\\n  spaceType: text('space_type'), // 'gallery', 'office', 'warehouse', 'restaurant', 'outdoor', 'studio', 'other'\\n  // Availability &amp; amenities\\n  availability: text('availability'), // Free-form text about when space is available\\n  amenities: jsonb('amenities').$type&lt;string[]&gt;().default([]), // ['wifi', 'av_equipment', 'parking', 'accessible', 'kitchen', 'outdoor_space']\\n  // Additional info\\n  website: text('website'),\\n  instagramHandle: text('instagram_handle'),\\n  notes: text('notes'), // Any additional info from the host\\n  // Admin fields\\n  status: text('status').default('pending'), // 'pending', 'approved', 'rejected', 'contacted'\\n  adminNotes: text('admin_notes'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type VenueHost = typeof venueHosts.$inferSelect\\nexport type NewVenueHost = typeof venueHosts.$inferInsert\\n\\n// Events (HiiiWAV Fest, Demo Days, community gatherings, etc.)\\nexport const events = pgTable('events', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  description: text('description'),\\n  content: text('content'), // Full markdown content for event page\\n  coverImage: text('cover_image'),\\n  eventDate: timestamp('event_date').notNull(), // When the event takes place\\n  endDate: timestamp('end_date'), // Optional end date for multi-day events\\n  location: text('location'), // Venue name\\n  address: text('address'), // Full address\\n  eventType: text('event_type'), // 'fest', 'demo_day', 'workshop', 'community', 'panel', 'networking'\\n  registrationUrl: text('registration_url'), // External registration link\\n  featured: boolean('featured').default(false), // Highlight on homepage\\n  published: boolean('published').default(false),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type Event = typeof events.$inferSelect\\nexport type NewEvent = typeof events.$inferInsert\\n\\n// HiiiLIGHTS Newsletter Archive\\nexport const newsletters = pgTable('newsletters', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  subtitle: text('subtitle'), // Optional subtitle/tagline\\n  excerpt: text('excerpt'), // Short preview text\\n  content: text('content').notNull(), // Full HTML/markdown content\\n  coverImage: text('cover_image'),\\n  issueNumber: integer('issue_number'), // e.g., Issue #1, #2\\n  publishedAt: timestamp('published_at').notNull(), // When the newsletter was originally sent\\n  published: boolean('published').default(true),\\n  seoTitle: text('seo_title'),\\n  seoDescription: text('seo_description'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type Newsletter = typeof newsletters.$inferSelect\\nexport type NewNewsletter = typeof newsletters.$inferInsert\\n\\n\\n\\n\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,uKAAI,EAAC;IACd,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,YAAY,IAAA,uKAAI,EAAC;IACjB,MAAM,IAAA,yKAAK,EAAC,QAAQ,KAAK,GAAa,OAAO,CAAC,EAAE;IAChD,WAAW,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,UAAU,IAAA,uKAAI,EAAC;IACf,gBAAgB,IAAA,uKAAI,EAAC;IACrB,WAAW,IAAA,uKAAI,EAAC;IAChB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,UAAU,IAAA,uKAAI,EAAC;IACf,gBAAgB,IAAA,uKAAI,EAAC;IACrB,WAAW,IAAA,uKAAI,EAAC;IAChB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO,GAAG,MAAM;IACrC,MAAM,IAAA,uKAAI,EAAC;IACX,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,CAAC;IAC3B,OAAO,IAAA,uKAAI,EAAC;IACZ,cAAc,IAAA,uKAAI,EAAC;IACnB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,UAAU,IAAA,uKAAI,EAAC,YAAY,OAAO;IAClC,KAAK,IAAA,uKAAI,EAAC,OAAO,OAAO;IACxB,UAAU,IAAA,uKAAI,EAAC;IACf,MAAM,IAAA,6KAAO,EAAC;IACd,SAAS,IAAA,uKAAI,EAAC;IACd,YAAY,IAAA,6KAAO,EAAC,eAAe,UAAU,CAAC,IAAM,MAAM,EAAE;IAC5D,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAGO,MAAM,WAAW,IAAA,gKAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,KAAK,IAAA,uKAAI,EAAC;IACV,UAAU,IAAA,uKAAI,EAAC;IACf,OAAO,IAAA,uKAAI,EAAC;IACZ,SAAS,IAAA,uKAAI,EAAC;IACd,aAAa,IAAA,yKAAK,EAAC,gBAAgB,KAAK;IAWxC,OAAO,IAAA,uKAAI,EAAC;IACZ,MAAM,IAAA,uKAAI,EAAC;IACX,QAAQ,IAAA,6KAAO,EAAC,UAAU,OAAO,CAAC;IAClC,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAGO,MAAM,SAAS,IAAA,gKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,gBAAgB,IAAA,uKAAI,EAAC,mBAAmB,OAAO;IAC/C,WAAW,IAAA,uKAAI,EAAC;IAChB,MAAM,IAAA,6KAAO,EAAC;IACd,UAAU,IAAA,uKAAI,EAAC;IACf,QAAQ,IAAA,uKAAI,EAAC,UAAU,OAAO,CAAC;IAC/B,aAAa,IAAA,6KAAO,EAAC;IACrB,kBAAkB,IAAA,uKAAI,EAAC;IACvB,aAAa,IAAA,uKAAI,EAAC;IAClB,cAAc,IAAA,uKAAI,EAAC;IACnB,gBAAgB,IAAA,uKAAI,EAAC;IACrB,cAAc,IAAA,uKAAI,EAAC;IACnB,UAAU,IAAA,uKAAI,EAAC;IACf,OAAO,IAAA,uKAAI,EAAC;IACZ,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAGO,MAAM,kBAAkB,IAAA,gKAAO,EAAC,oBAAoB;IACzD,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,SAAS,IAAA,6KAAO,EAAC,YAAY,OAAO,GAAG,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE;QAAE,UAAU;IAAU;IACzF,UAAU,IAAA,6KAAO,EAAC,aAAa,OAAO,GAAG,UAAU,CAAC,IAAM,SAAS,EAAE,EAAE;QAAE,UAAU;IAAU;IAC7F,eAAe,IAAA,uKAAI,EAAC;AACtB;AAgBO,MAAM,YAAY,IAAA,gKAAO,EAAC,aAAa;IAC5C,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,WAAW,IAAA,uKAAI,EAAC,cAAc,OAAO,GAAG,MAAM;IAC9C,gBAAgB,IAAA,uKAAI,EAAC,mBAAmB,OAAO;IAC/C,YAAY,IAAA,6KAAO,EAAC,eAAe,OAAO,CAAC;IAC3C,SAAS,IAAA,6KAAO,EAAC,WAAW,OAAO,CAAC;IACpC,UAAU,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACvC,WAAW,IAAA,iLAAS,EAAC;IACrB,OAAO,IAAA,uKAAI,EAAC;IACZ,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAMO,MAAM,aAAa,IAAA,gKAAO,EAAC,eAAe;IAC/C,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,eAAe;IACf,aAAa,IAAA,uKAAI,EAAC,gBAAgB,OAAO;IACzC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,OAAO,IAAA,uKAAI,EAAC;IACZ,aAAa;IACb,WAAW,IAAA,uKAAI,EAAC,cAAc,OAAO;IACrC,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,CAAC;IAC3B,cAAc,IAAA,uKAAI,EAAC;IACnB,UAAU,IAAA,6KAAO,EAAC;IAClB,WAAW,IAAA,uKAAI,EAAC;IAChB,2BAA2B;IAC3B,cAAc,IAAA,uKAAI,EAAC;IACnB,WAAW,IAAA,yKAAK,EAAC,aAAa,KAAK,GAAa,OAAO,CAAC,EAAE;IAC1D,kBAAkB;IAClB,SAAS,IAAA,uKAAI,EAAC;IACd,iBAAiB,IAAA,uKAAI,EAAC;IACtB,OAAO,IAAA,uKAAI,EAAC;IACZ,eAAe;IACf,QAAQ,IAAA,uKAAI,EAAC,UAAU,OAAO,CAAC;IAC/B,YAAY,IAAA,uKAAI,EAAC;IACjB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAMO,MAAM,SAAS,IAAA,gKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,aAAa,IAAA,uKAAI,EAAC;IAClB,SAAS,IAAA,uKAAI,EAAC;IACd,YAAY,IAAA,uKAAI,EAAC;IACjB,WAAW,IAAA,iLAAS,EAAC,cAAc,OAAO;IAC1C,SAAS,IAAA,iLAAS,EAAC;IACnB,UAAU,IAAA,uKAAI,EAAC;IACf,SAAS,IAAA,uKAAI,EAAC;IACd,WAAW,IAAA,uKAAI,EAAC;IAChB,iBAAiB,IAAA,uKAAI,EAAC;IACtB,UAAU,IAAA,6KAAO,EAAC,YAAY,OAAO,CAAC;IACtC,WAAW,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAMO,MAAM,cAAc,IAAA,gKAAO,EAAC,eAAe;IAChD,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,UAAU,IAAA,uKAAI,EAAC;IACf,SAAS,IAAA,uKAAI,EAAC;IACd,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,YAAY,IAAA,uKAAI,EAAC;IACjB,aAAa,IAAA,6KAAO,EAAC;IACrB,aAAa,IAAA,iLAAS,EAAC,gBAAgB,OAAO;IAC9C,WAAW,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,UAAU,IAAA,uKAAI,EAAC;IACf,gBAAgB,IAAA,uKAAI,EAAC;IACrB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD\"}},\n    {\"offset\": {\"line\": 260, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"file:///Users/boskombp16/GitHub/hiiiwav-website/db/index.ts\"],\"sourcesContent\":[\"import { drizzle } from 'drizzle-orm/postgres-js'\\nimport postgres from 'postgres'\\nimport * as schema from './schema'\\n\\nfunction getDb() {\\n  if (!process.env.DATABASE_URL) {\\n    throw new Error('DATABASE_URL is not set. Please add it to .env.local')\\n  }\\n  const client = postgres(process.env.DATABASE_URL, {\\n    connect_timeout: 60,\\n    idle_timeout: 20,\\n    max_lifetime: 60 * 30,\\n  })\\n  return drizzle(client, { schema })\\n}\\n\\nexport const db = getDb()\\n\\n\"],\"names\":[],\"mappings\":\";;;;AAAA;AACA;AACA;;;;AAEA,SAAS;IACP,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;QAC7B,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,SAAS,IAAA,mJAAQ,EAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;QAChD,iBAAiB;QACjB,cAAc;QACd,cAAc,KAAK;IACrB;IACA,OAAO,IAAA,qKAAO,EAAC,QAAQ;QAAE,QAAA;IAAO;AAClC;AAEO,MAAM,KAAK\"}},\n    {\"offset\": {\"line\": 339, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"file:///Users/boskombp16/GitHub/hiiiwav-website/app/%5Bslug%5D/page.tsx\"],\"sourcesContent\":[\"import { db } from '@/db'\\nimport { pages, redirects } from '@/db/schema'\\nimport { eq, and } from 'drizzle-orm'\\nimport { notFound, redirect } from 'next/navigation'\\nimport ReactMarkdown from 'react-markdown'\\nimport remarkGfm from 'remark-gfm'\\n\\nexport const dynamic = 'force-dynamic'\\n\\ninterface PageProps {\\n  params: Promise&lt;{ slug: string }&gt;\\n}\\n\\nexport default async function Page({ params }: PageProps) {\\n  const { slug } = await params\\n  \\n  // Skip empty slugs (homepage should be handled by app/page.tsx)\\n  if (!slug || slug.trim() === '') {\\n    notFound()\\n  }\\n  \\n  const path = &#96;/${slug}&#96;\\n\\n  // Check for redirect first\\n  const [redirectRule] = await db\\n    .select()\\n    .from(redirects)\\n    .where(and(eq(redirects.sourceUrl, path), eq(redirects.enabled, true)))\\n    .limit(1)\\n\\n  if (redirectRule) {\\n    // Update hit count (fire and forget)\\n    db.update(redirects)\\n      .set({\\n        hitCount: (redirectRule.hitCount || 0) + 1,\\n        lastHitAt: new Date(),\\n      })\\n      .where(eq(redirects.id, redirectRule.id))\\n      .catch(() =&gt; {})\\n\\n    redirect(redirectRule.destinationUrl)\\n  }\\n\\n  // Check for page\\n  const page = await db\\n    .select()\\n    .from(pages)\\n    .where(eq(pages.slug, slug))\\n    .limit(1)\\n    .then((r) =&gt; r[0])\\n\\n  if (!page) {\\n    notFound()\\n  }\\n\\n  return (\\n    &lt;div className=\\\"bg-black min-h-screen py-16\\\"&gt;\\n      &lt;div className=\\\"container max-w-4xl px-4\\\"&gt;\\n        &lt;h1 className=\\\"text-4xl md:text-5xl font-bold text-white mb-8\\\"&gt;\\n          {page.title}\\n        &lt;/h1&gt;\\n        \\n        &lt;div className=\\\"prose prose-invert prose-lg max-w-none prose-headings:text-[#99FF69] prose-a:text-[#99FF69] prose-strong:text-white\\\"&gt;\\n          &lt;ReactMarkdown remarkPlugins={[remarkGfm]}&gt;\\n            {page.content || ''}\\n          &lt;/ReactMarkdown&gt;\\n        &lt;/div&gt;\\n      &lt;/div&gt;\\n    &lt;/div&gt;\\n  )\\n}\\n\\nexport async function generateMetadata({ params }: PageProps) {\\n  const { slug } = await params\\n  \\n  if (!slug || slug.trim() === '') {\\n    return { title: 'Page Not Found' }\\n  }\\n  \\n  const page = await db\\n    .select()\\n    .from(pages)\\n    .where(eq(pages.slug, slug))\\n    .limit(1)\\n    .then((r) =&gt; r[0])\\n\\n  if (!page) {\\n    return { title: 'Page Not Found' }\\n  }\\n\\n  return {\\n    title: &#96;${page.title} - HiiiWAV&#96;,\\n    description: page.seoDescription || &#96;${page.title} - HiiiWAV Creative Tech Incubator&#96;,\\n  }\\n}\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;;;;;;;;AAEO,MAAM,UAAU;AAMR,eAAe,KAAK,EAAE,MAAM,EAAa;IACtD,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IAEvB,gEAAgE;IAChE,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI;QAC/B,IAAA,iMAAQ;IACV;IAEA,MAAM,OAAO,CAAC,CAAC,EAAE,MAAM;IAEvB,2BAA2B;IAC3B,MAAM,CAAC,aAAa,GAAG,MAAM,iHAAE,CAC5B,MAAM,GACN,IAAI,CAAC,yHAAS,EACd,KAAK,CAAC,IAAA,yKAAG,EAAC,IAAA,wKAAE,EAAC,yHAAS,CAAC,SAAS,EAAE,OAAO,IAAA,wKAAE,EAAC,yHAAS,CAAC,OAAO,EAAE,QAC/D,KAAK,CAAC;IAET,IAAI,cAAc;QAChB,qCAAqC;QACrC,iHAAE,CAAC,MAAM,CAAC,yHAAS,EAChB,GAAG,CAAC;YACH,UAAU,CAAC,aAAa,QAAQ,IAAI,CAAC,IAAI;YACzC,WAAW,IAAI;QACjB,GACC,KAAK,CAAC,IAAA,wKAAE,EAAC,yHAAS,CAAC,EAAE,EAAE,aAAa,EAAE,GACtC,KAAK,CAAC,KAAO;QAEhB,IAAA,iMAAQ,EAAC,aAAa,cAAc;IACtC;IAEA,iBAAiB;IACjB,MAAM,OAAO,MAAM,iHAAE,CAClB,MAAM,GACN,IAAI,CAAC,qHAAK,EACV,KAAK,CAAC,IAAA,wKAAE,EAAC,qHAAK,CAAC,IAAI,EAAE,OACrB,KAAK,CAAC,GACN,IAAI,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE;IAEnB,IAAI,CAAC,MAAM;QACT,IAAA,iMAAQ;IACV;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BACX,KAAK,KAAK;;;;;;8BAGb,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,mMAAa;wBAAC,eAAe;4BAAC,wJAAS;yBAAC;kCACtC,KAAK,OAAO,IAAI;;;;;;;;;;;;;;;;;;;;;;AAM7B;AAEO,eAAe,iBAAiB,EAAE,MAAM,EAAa;IAC1D,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IAEvB,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI;QAC/B,OAAO;YAAE,OAAO;QAAiB;IACnC;IAEA,MAAM,OAAO,MAAM,iHAAE,CAClB,MAAM,GACN,IAAI,CAAC,qHAAK,EACV,KAAK,CAAC,IAAA,wKAAE,EAAC,qHAAK,CAAC,IAAI,EAAE,OACrB,KAAK,CAAC,GACN,IAAI,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE;IAEnB,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,OAAO;QAAiB;IACnC;IAEA,OAAO;QACL,OAAO,GAAG,KAAK,KAAK,CAAC,UAAU,CAAC;QAChC,aAAa,KAAK,cAAc,IAAI,GAAG,KAAK,KAAK,CAAC,kCAAkC,CAAC;IACvF;AACF\"}}]",
        "signatures": {},
        "detailedLines": [
          {
            "text": "{",
            "lineNumber": 1
          },
          {
            "text": "  \"version\": 3,",
            "lineNumber": 2
          },
          {
            "text": "  \"sources\": [],",
            "lineNumber": 3
          },
          {
            "text": "  \"sections\": [",
            "lineNumber": 4
          },
          {
            "text": "    {\"offset\": {\"line\": 60, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"file:///Users/boskombp16/GitHub/hiiiwav-website/db/schema.ts\"],\"sourcesContent\":[\"import { pgTable, text, timestamp, boolean, serial, jsonb, integer, date } from 'drizzle-orm/pg-core'\\n\\nexport const posts = pgTable('posts', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  excerpt: text('excerpt'),\\n  content: text('content').notNull(),\\n  coverImage: text('cover_image'),\\n  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),\\n  published: boolean('published').default(false),\\n  seoTitle: text('seo_title'),\\n  seoDescription: text('seo_description'),\\n  canonical: text('canonical'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport const pages = pgTable('pages', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  content: text('content').notNull(),\\n  seoTitle: text('seo_title'),\\n  seoDescription: text('seo_description'),\\n  canonical: text('canonical'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport const users = pgTable('users', {\\n  id: serial('id').primaryKey(),\\n  email: text('email').notNull().unique(),\\n  name: text('name'),\\n  role: text('role').default('user'),\\n  image: text('image'),\\n  passwordHash: text('password_hash'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n})\\n\\nexport const media = pgTable('media', {\\n  id: serial('id').primaryKey(),\\n  filename: text('filename').notNull(),\\n  url: text('url').notNull(),\\n  mimeType: text('mime_type'),\\n  size: integer('size'),\\n  altText: text('alt_text'),\\n  uploadedBy: integer('uploaded_by').references(() =&gt; users.id),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n})\\n\\n// Entities: HiiiWAV org, participant artists, and staff members\\nexport const entities = pgTable('entities', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  name: text('name').notNull(),\\n  type: text('type').notNull(), // 'organization', 'participant', 'staff'\\n  bio: text('bio'),\\n  shortBio: text('short_bio'),\\n  image: text('image'),\\n  website: text('website'),\\n  socialLinks: jsonb('social_links').$type&lt;{\\n    instagram?: string\\n    twitter?: string\\n    spotify?: string\\n    youtube?: string\\n    facebook?: string\\n    tiktok?: string\\n    soundcloud?: string\\n    bandcamp?: string\\n    linkedin?: string\\n  }&gt;(),\\n  genre: text('genre'), // For artists\\n  role: text('role'), // For staff (e.g., \\\"Executive Director\\\")\\n  active: boolean('active').default(true),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\n// Awards, grants, and recognitions\\nexport const awards = pgTable('awards', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  name: text('name').notNull(),\\n  awardingEntity: text('awarding_entity').notNull(), // Organization that gave the award\\n  awardDate: date('award_date'),\\n  year: integer('year'), // Fallback when exact date unknown\\n  category: text('category'), // 'grant', 'award', 'fellowship', 'recognition', 'nomination'\\n  status: text('status').default('won'), // 'won', 'nominated', 'finalist', 'honorable_mention'\\n  prizeAmount: integer('prize_amount'), // In cents for precision\\n  prizeDescription: text('prize_description'), // Non-monetary prize details\\n  description: text('description'),\\n  notableFacts: text('notable_facts'),\\n  awardingOrgUrl: text('awarding_org_url'),\\n  awardPageUrl: text('award_page_url'),\\n  pressUrl: text('press_url'),\\n  image: text('image'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\n// Junction table: links awards to entities (many-to-many)\\nexport const awardRecipients = pgTable('award_recipients', {\\n  id: serial('id').primaryKey(),\\n  awardId: integer('award_id').notNull().references(() =&gt; awards.id, { onDelete: 'cascade' }),\\n  entityId: integer('entity_id').notNull().references(() =&gt; entities.id, { onDelete: 'cascade' }),\\n  recipientRole: text('recipient_role'), // 'primary', 'collaborator', 'featured'\\n})\\n\\nexport type Post = typeof posts.$inferSelect\\nexport type NewPost = typeof posts.$inferInsert\\nexport type Page = typeof pages.$inferSelect\\nexport type NewPage = typeof pages.$inferInsert\\nexport type User = typeof users.$inferSelect\\nexport type Media = typeof media.$inferSelect\\nexport type Entity = typeof entities.$inferSelect\\nexport type NewEntity = typeof entities.$inferInsert\\nexport type Award = typeof awards.$inferSelect\\nexport type NewAward = typeof awards.$inferInsert\\nexport type AwardRecipient = typeof awardRecipients.$inferSelect\\nexport type NewAwardRecipient = typeof awardRecipients.$inferInsert\\n\\n// Redirects for SEO preservation\\nexport const redirects = pgTable('redirects', {\\n  id: serial('id').primaryKey(),\\n  sourceUrl: text('source_url').notNull().unique(), // The old URL path (e.g., /old-page)\\n  destinationUrl: text('destination_url').notNull(), // Where to redirect to (e.g., /new-page)\\n  statusCode: integer('status_code').default(301), // 301 permanent, 302 temporary, 307, 308\\n  enabled: boolean('enabled').default(true),\\n  hitCount: integer('hit_count').default(0), // Track how often this redirect is used\\n  lastHitAt: timestamp('last_hit_at'),\\n  notes: text('notes'), // Admin notes about this redirect\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type Redirect = typeof redirects.$inferSelect\\nexport type NewRedirect = typeof redirects.$inferInsert\\n\\n// Oakland Tech Week Venue Host Applications\\nexport const venueHosts = pgTable('venue_hosts', {\\n  id: serial('id').primaryKey(),\\n  // Contact info\\n  contactName: text('contact_name').notNull(),\\n  email: text('email').notNull(),\\n  phone: text('phone'),\\n  // Venue info\\n  venueName: text('venue_name').notNull(),\\n  address: text('address').notNull(),\\n  city: text('city').default('Oakland'),\\n  neighborhood: text('neighborhood'), // e.g., \\\"Downtown\\\", \\\"Temescal\\\", \\\"West Oakland\\\"\\n  capacity: integer('capacity'), // Max number of people\\n  spaceType: text('space_type'), // 'gallery', 'office', 'warehouse', 'restaurant', 'outdoor', 'studio', 'other'\\n  // Availability &amp; amenities\\n  availability: text('availability'), // Free-form text about when space is available\\n  amenities: jsonb('amenities').$type&lt;string[]&gt;().default([]), // ['wifi', 'av_equipment', 'parking', 'accessible', 'kitchen', 'outdoor_space']\\n  // Additional info\\n  website: text('website'),\\n  instagramHandle: text('instagram_handle'),\\n  notes: text('notes'), // Any additional info from the host\\n  // Admin fields\\n  status: text('status').default('pending'), // 'pending', 'approved', 'rejected', 'contacted'\\n  adminNotes: text('admin_notes'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type VenueHost = typeof venueHosts.$inferSelect\\nexport type NewVenueHost = typeof venueHosts.$inferInsert\\n\\n// Events (HiiiWAV Fest, Demo Days, community gatherings, etc.)\\nexport const events = pgTable('events', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  description: text('description'),\\n  content: text('content'), // Full markdown content for event page\\n  coverImage: text('cover_image'),\\n  eventDate: timestamp('event_date').notNull(), // When the event takes place\\n  endDate: timestamp('end_date'), // Optional end date for multi-day events\\n  location: text('location'), // Venue name\\n  address: text('address'), // Full address\\n  eventType: text('event_type'), // 'fest', 'demo_day', 'workshop', 'community', 'panel', 'networking'\\n  registrationUrl: text('registration_url'), // External registration link\\n  featured: boolean('featured').default(false), // Highlight on homepage\\n  published: boolean('published').default(false),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type Event = typeof events.$inferSelect\\nexport type NewEvent = typeof events.$inferInsert\\n\\n// HiiiLIGHTS Newsletter Archive\\nexport const newsletters = pgTable('newsletters', {\\n  id: serial('id').primaryKey(),\\n  slug: text('slug').notNull().unique(),\\n  title: text('title').notNull(),\\n  subtitle: text('subtitle'), // Optional subtitle/tagline\\n  excerpt: text('excerpt'), // Short preview text\\n  content: text('content').notNull(), // Full HTML/markdown content\\n  coverImage: text('cover_image'),\\n  issueNumber: integer('issue_number'), // e.g., Issue #1, #2\\n  publishedAt: timestamp('published_at').notNull(), // When the newsletter was originally sent\\n  published: boolean('published').default(true),\\n  seoTitle: text('seo_title'),\\n  seoDescription: text('seo_description'),\\n  createdAt: timestamp('created_at').defaultNow().notNull(),\\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\\n})\\n\\nexport type Newsletter = typeof newsletters.$inferSelect\\nexport type NewNewsletter = typeof newsletters.$inferInsert\\n\\n\\n\\n\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,uKAAI,EAAC;IACd,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,YAAY,IAAA,uKAAI,EAAC;IACjB,MAAM,IAAA,yKAAK,EAAC,QAAQ,KAAK,GAAa,OAAO,CAAC,EAAE;IAChD,WAAW,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,UAAU,IAAA,uKAAI,EAAC;IACf,gBAAgB,IAAA,uKAAI,EAAC;IACrB,WAAW,IAAA,uKAAI,EAAC;IAChB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,UAAU,IAAA,uKAAI,EAAC;IACf,gBAAgB,IAAA,uKAAI,EAAC;IACrB,WAAW,IAAA,uKAAI,EAAC;IAChB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO,GAAG,MAAM;IACrC,MAAM,IAAA,uKAAI,EAAC;IACX,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,CAAC;IAC3B,OAAO,IAAA,uKAAI,EAAC;IACZ,cAAc,IAAA,uKAAI,EAAC;IACnB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,QAAQ,IAAA,gKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,UAAU,IAAA,uKAAI,EAAC,YAAY,OAAO;IAClC,KAAK,IAAA,uKAAI,EAAC,OAAO,OAAO;IACxB,UAAU,IAAA,uKAAI,EAAC;IACf,MAAM,IAAA,6KAAO,EAAC;IACd,SAAS,IAAA,uKAAI,EAAC;IACd,YAAY,IAAA,6KAAO,EAAC,eAAe,UAAU,CAAC,IAAM,MAAM,EAAE;IAC5D,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAGO,MAAM,WAAW,IAAA,gKAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,KAAK,IAAA,uKAAI,EAAC;IACV,UAAU,IAAA,uKAAI,EAAC;IACf,OAAO,IAAA,uKAAI,EAAC;IACZ,SAAS,IAAA,uKAAI,EAAC;IACd,aAAa,IAAA,yKAAK,EAAC,gBAAgB,KAAK;IAWxC,OAAO,IAAA,uKAAI,EAAC;IACZ,MAAM,IAAA,uKAAI,EAAC;IACX,QAAQ,IAAA,6KAAO,EAAC,UAAU,OAAO,CAAC;IAClC,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAGO,MAAM,SAAS,IAAA,gKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,gBAAgB,IAAA,uKAAI,EAAC,mBAAmB,OAAO;IAC/C,WAAW,IAAA,uKAAI,EAAC;IAChB,MAAM,IAAA,6KAAO,EAAC;IACd,UAAU,IAAA,uKAAI,EAAC;IACf,QAAQ,IAAA,uKAAI,EAAC,UAAU,OAAO,CAAC;IAC/B,aAAa,IAAA,6KAAO,EAAC;IACrB,kBAAkB,IAAA,uKAAI,EAAC;IACvB,aAAa,IAAA,uKAAI,EAAC;IAClB,cAAc,IAAA,uKAAI,EAAC;IACnB,gBAAgB,IAAA,uKAAI,EAAC;IACrB,cAAc,IAAA,uKAAI,EAAC;IACnB,UAAU,IAAA,uKAAI,EAAC;IACf,OAAO,IAAA,uKAAI,EAAC;IACZ,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAGO,MAAM,kBAAkB,IAAA,gKAAO,EAAC,oBAAoB;IACzD,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,SAAS,IAAA,6KAAO,EAAC,YAAY,OAAO,GAAG,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE;QAAE,UAAU;IAAU;IACzF,UAAU,IAAA,6KAAO,EAAC,aAAa,OAAO,GAAG,UAAU,CAAC,IAAM,SAAS,EAAE,EAAE;QAAE,UAAU;IAAU;IAC7F,eAAe,IAAA,uKAAI,EAAC;AACtB;AAgBO,MAAM,YAAY,IAAA,gKAAO,EAAC,aAAa;IAC5C,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,WAAW,IAAA,uKAAI,EAAC,cAAc,OAAO,GAAG,MAAM;IAC9C,gBAAgB,IAAA,uKAAI,EAAC,mBAAmB,OAAO;IAC/C,YAAY,IAAA,6KAAO,EAAC,eAAe,OAAO,CAAC;IAC3C,SAAS,IAAA,6KAAO,EAAC,WAAW,OAAO,CAAC;IACpC,UAAU,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACvC,WAAW,IAAA,iLAAS,EAAC;IACrB,OAAO,IAAA,uKAAI,EAAC;IACZ,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAMO,MAAM,aAAa,IAAA,gKAAO,EAAC,eAAe;IAC/C,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,eAAe;IACf,aAAa,IAAA,uKAAI,EAAC,gBAAgB,OAAO;IACzC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,OAAO,IAAA,uKAAI,EAAC;IACZ,aAAa;IACb,WAAW,IAAA,uKAAI,EAAC,cAAc,OAAO;IACrC,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,CAAC;IAC3B,cAAc,IAAA,uKAAI,EAAC;IACnB,UAAU,IAAA,6KAAO,EAAC;IAClB,WAAW,IAAA,uKAAI,EAAC;IAChB,2BAA2B;IAC3B,cAAc,IAAA,uKAAI,EAAC;IACnB,WAAW,IAAA,yKAAK,EAAC,aAAa,KAAK,GAAa,OAAO,CAAC,EAAE;IAC1D,kBAAkB;IAClB,SAAS,IAAA,uKAAI,EAAC;IACd,iBAAiB,IAAA,uKAAI,EAAC;IACtB,OAAO,IAAA,uKAAI,EAAC;IACZ,eAAe;IACf,QAAQ,IAAA,uKAAI,EAAC,UAAU,OAAO,CAAC;IAC/B,YAAY,IAAA,uKAAI,EAAC;IACjB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAMO,MAAM,SAAS,IAAA,gKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,aAAa,IAAA,uKAAI,EAAC;IAClB,SAAS,IAAA,uKAAI,EAAC;IACd,YAAY,IAAA,uKAAI,EAAC;IACjB,WAAW,IAAA,iLAAS,EAAC,cAAc,OAAO;IAC1C,SAAS,IAAA,iLAAS,EAAC;IACnB,UAAU,IAAA,uKAAI,EAAC;IACf,SAAS,IAAA,uKAAI,EAAC;IACd,WAAW,IAAA,uKAAI,EAAC;IAChB,iBAAiB,IAAA,uKAAI,EAAC;IACtB,UAAU,IAAA,6KAAO,EAAC,YAAY,OAAO,CAAC;IACtC,WAAW,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAMO,MAAM,cAAc,IAAA,gKAAO,EAAC,eAAe;IAChD,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,UAAU,IAAA,uKAAI,EAAC;IACf,SAAS,IAAA,uKAAI,EAAC;IACd,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,YAAY,IAAA,uKAAI,EAAC;IACjB,aAAa,IAAA,6KAAO,EAAC;IACrB,aAAa,IAAA,iLAAS,EAAC,gBAAgB,OAAO;IAC9C,WAAW,IAAA,6KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,UAAU,IAAA,uKAAI,EAAC;IACf,gBAAgB,IAAA,uKAAI,EAAC;IACrB,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD\"}},",
            "lineNumber": 5
          },
          {
            "text": "    {\"offset\": {\"line\": 260, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"file:///Users/boskombp16/GitHub/hiiiwav-website/db/index.ts\"],\"sourcesContent\":[\"import { drizzle } from 'drizzle-orm/postgres-js'\\nimport postgres from 'postgres'\\nimport * as schema from './schema'\\n\\nfunction getDb() {\\n  if (!process.env.DATABASE_URL) {\\n    throw new Error('DATABASE_URL is not set. Please add it to .env.local')\\n  }\\n  const client = postgres(process.env.DATABASE_URL, {\\n    connect_timeout: 60,\\n    idle_timeout: 20,\\n    max_lifetime: 60 * 30,\\n  })\\n  return drizzle(client, { schema })\\n}\\n\\nexport const db = getDb()\\n\\n\"],\"names\":[],\"mappings\":\";;;;AAAA;AACA;AACA;;;;AAEA,SAAS;IACP,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;QAC7B,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,SAAS,IAAA,mJAAQ,EAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;QAChD,iBAAiB;QACjB,cAAc;QACd,cAAc,KAAK;IACrB;IACA,OAAO,IAAA,qKAAO,EAAC,QAAQ;QAAE,QAAA;IAAO;AAClC;AAEO,MAAM,KAAK\"}},",
            "lineNumber": 6
          },
          {
            "text": "    {\"offset\": {\"line\": 339, \"column\": 0}, \"map\": {\"version\":3,\"sources\":[\"file:///Users/boskombp16/GitHub/hiiiwav-website/app/%5Bslug%5D/page.tsx\"],\"sourcesContent\":[\"import { db } from '@/db'\\nimport { pages, redirects } from '@/db/schema'\\nimport { eq, and } from 'drizzle-orm'\\nimport { notFound, redirect } from 'next/navigation'\\nimport ReactMarkdown from 'react-markdown'\\nimport remarkGfm from 'remark-gfm'\\n\\nexport const dynamic = 'force-dynamic'\\n\\ninterface PageProps {\\n  params: Promise&lt;{ slug: string }&gt;\\n}\\n\\nexport default async function Page({ params }: PageProps) {\\n  const { slug } = await params\\n  \\n  // Skip empty slugs (homepage should be handled by app/page.tsx)\\n  if (!slug || slug.trim() === '') {\\n    notFound()\\n  }\\n  \\n  const path = &#96;/${slug}&#96;\\n\\n  // Check for redirect first\\n  const [redirectRule] = await db\\n    .select()\\n    .from(redirects)\\n    .where(and(eq(redirects.sourceUrl, path), eq(redirects.enabled, true)))\\n    .limit(1)\\n\\n  if (redirectRule) {\\n    // Update hit count (fire and forget)\\n    db.update(redirects)\\n      .set({\\n        hitCount: (redirectRule.hitCount || 0) + 1,\\n        lastHitAt: new Date(),\\n      })\\n      .where(eq(redirects.id, redirectRule.id))\\n      .catch(() =&gt; {})\\n\\n    redirect(redirectRule.destinationUrl)\\n  }\\n\\n  // Check for page\\n  const page = await db\\n    .select()\\n    .from(pages)\\n    .where(eq(pages.slug, slug))\\n    .limit(1)\\n    .then((r) =&gt; r[0])\\n\\n  if (!page) {\\n    notFound()\\n  }\\n\\n  return (\\n    &lt;div className=\\\"bg-black min-h-screen py-16\\\"&gt;\\n      &lt;div className=\\\"container max-w-4xl px-4\\\"&gt;\\n        &lt;h1 className=\\\"text-4xl md:text-5xl font-bold text-white mb-8\\\"&gt;\\n          {page.title}\\n        &lt;/h1&gt;\\n        \\n        &lt;div className=\\\"prose prose-invert prose-lg max-w-none prose-headings:text-[#99FF69] prose-a:text-[#99FF69] prose-strong:text-white\\\"&gt;\\n          &lt;ReactMarkdown remarkPlugins={[remarkGfm]}&gt;\\n            {page.content || ''}\\n          &lt;/ReactMarkdown&gt;\\n        &lt;/div&gt;\\n      &lt;/div&gt;\\n    &lt;/div&gt;\\n  )\\n}\\n\\nexport async function generateMetadata({ params }: PageProps) {\\n  const { slug } = await params\\n  \\n  if (!slug || slug.trim() === '') {\\n    return { title: 'Page Not Found' }\\n  }\\n  \\n  const page = await db\\n    .select()\\n    .from(pages)\\n    .where(eq(pages.slug, slug))\\n    .limit(1)\\n    .then((r) =&gt; r[0])\\n\\n  if (!page) {\\n    return { title: 'Page Not Found' }\\n  }\\n\\n  return {\\n    title: &#96;${page.title} - HiiiWAV&#96;,\\n    description: page.seoDescription || &#96;${page.title} - HiiiWAV Creative Tech Incubator&#96;,\\n  }\\n}\\n\"],\"names\":[],\"mappings\":\";;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;;;;;;;;AAEO,MAAM,UAAU;AAMR,eAAe,KAAK,EAAE,MAAM,EAAa;IACtD,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IAEvB,gEAAgE;IAChE,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI;QAC/B,IAAA,iMAAQ;IACV;IAEA,MAAM,OAAO,CAAC,CAAC,EAAE,MAAM;IAEvB,2BAA2B;IAC3B,MAAM,CAAC,aAAa,GAAG,MAAM,iHAAE,CAC5B,MAAM,GACN,IAAI,CAAC,yHAAS,EACd,KAAK,CAAC,IAAA,yKAAG,EAAC,IAAA,wKAAE,EAAC,yHAAS,CAAC,SAAS,EAAE,OAAO,IAAA,wKAAE,EAAC,yHAAS,CAAC,OAAO,EAAE,QAC/D,KAAK,CAAC;IAET,IAAI,cAAc;QAChB,qCAAqC;QACrC,iHAAE,CAAC,MAAM,CAAC,yHAAS,EAChB,GAAG,CAAC;YACH,UAAU,CAAC,aAAa,QAAQ,IAAI,CAAC,IAAI;YACzC,WAAW,IAAI;QACjB,GACC,KAAK,CAAC,IAAA,wKAAE,EAAC,yHAAS,CAAC,EAAE,EAAE,aAAa,EAAE,GACtC,KAAK,CAAC,KAAO;QAEhB,IAAA,iMAAQ,EAAC,aAAa,cAAc;IACtC;IAEA,iBAAiB;IACjB,MAAM,OAAO,MAAM,iHAAE,CAClB,MAAM,GACN,IAAI,CAAC,qHAAK,EACV,KAAK,CAAC,IAAA,wKAAE,EAAC,qHAAK,CAAC,IAAI,EAAE,OACrB,KAAK,CAAC,GACN,IAAI,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE;IAEnB,IAAI,CAAC,MAAM;QACT,IAAA,iMAAQ;IACV;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BACX,KAAK,KAAK;;;;;;8BAGb,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,mMAAa;wBAAC,eAAe;4BAAC,wJAAS;yBAAC;kCACtC,KAAK,OAAO,IAAI;;;;;;;;;;;;;;;;;;;;;;AAM7B;AAEO,eAAe,iBAAiB,EAAE,MAAM,EAAa;IAC1D,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IAEvB,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI;QAC/B,OAAO;YAAE,OAAO;QAAiB;IACnC;IAEA,MAAM,OAAO,MAAM,iHAAE,CAClB,MAAM,GACN,IAAI,CAAC,qHAAK,EACV,KAAK,CAAC,IAAA,wKAAE,EAAC,qHAAK,CAAC,IAAI,EAAE,OACrB,KAAK,CAAC,GACN,IAAI,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE;IAEnB,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,OAAO;QAAiB;IACnC;IAEA,OAAO;QACL,OAAO,GAAG,KAAK,KAAK,CAAC,UAAU,CAAC;QAChC,aAAa,KAAK,cAAc,IAAI,GAAG,KAAK,KAAK,CAAC,kCAAkC,CAAC;IACvF;AACF\"}}]",
            "lineNumber": 7
          }
        ]
      },
      "score": 0.2666427493095398
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="read_file_v2">
<details>
<summary>Tool use: **read_file_v2**</summary>


Parameters:

```json
{
  "targetFile": "db/schema.ts",
  "charsLimit": 1000000,
  "effectiveUri": "db/schema.ts"
}
```
Result:

```json
{
  "contents": "import { pgTable, text, timestamp, boolean, serial, jsonb, integer, date } from 'drizzle-orm/pg-core'\n\nexport const posts = pgTable('posts', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  excerpt: text('excerpt'),\n  content: text('content').notNull(),\n  coverImage: text('cover_image'),\n  tags: jsonb('tags').$type&lt;string[]&gt;().default([]),\n  published: boolean('published').default(false),\n  seoTitle: text('seo_title'),\n  seoDescription: text('seo_description'),\n  canonical: text('canonical'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport const pages = pgTable('pages', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  content: text('content').notNull(),\n  seoTitle: text('seo_title'),\n  seoDescription: text('seo_description'),\n  canonical: text('canonical'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport const users = pgTable('users', {\n  id: serial('id').primaryKey(),\n  email: text('email').notNull().unique(),\n  name: text('name'),\n  role: text('role').default('user'),\n  image: text('image'),\n  passwordHash: text('password_hash'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n})\n\nexport const media = pgTable('media', {\n  id: serial('id').primaryKey(),\n  filename: text('filename').notNull(),\n  url: text('url').notNull(),\n  mimeType: text('mime_type'),\n  size: integer('size'),\n  altText: text('alt_text'),\n  uploadedBy: integer('uploaded_by').references(() =&gt; users.id),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n})\n\n// Entities: HiiiWAV org, participant artists, and staff members\nexport const entities = pgTable('entities', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  name: text('name').notNull(),\n  type: text('type').notNull(), // 'organization', 'participant', 'staff'\n  bio: text('bio'),\n  shortBio: text('short_bio'),\n  image: text('image'),\n  website: text('website'),\n  socialLinks: jsonb('social_links').$type&lt;{\n    instagram?: string\n    twitter?: string\n    spotify?: string\n    youtube?: string\n    facebook?: string\n    tiktok?: string\n    soundcloud?: string\n    bandcamp?: string\n    linkedin?: string\n  }&gt;(),\n  genre: text('genre'), // For artists\n  role: text('role'), // For staff (e.g., \"Executive Director\")\n  active: boolean('active').default(true),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\n// Awards, grants, and recognitions\nexport const awards = pgTable('awards', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  name: text('name').notNull(),\n  awardingEntity: text('awarding_entity').notNull(), // Organization that gave the award\n  awardDate: date('award_date'),\n  year: integer('year'), // Fallback when exact date unknown\n  category: text('category'), // 'grant', 'award', 'fellowship', 'recognition', 'nomination'\n  status: text('status').default('won'), // 'won', 'nominated', 'finalist', 'honorable_mention'\n  prizeAmount: integer('prize_amount'), // In cents for precision\n  prizeDescription: text('prize_description'), // Non-monetary prize details\n  description: text('description'),\n  notableFacts: text('notable_facts'),\n  awardingOrgUrl: text('awarding_org_url'),\n  awardPageUrl: text('award_page_url'),\n  pressUrl: text('press_url'),\n  image: text('image'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\n// Junction table: links awards to entities (many-to-many)\nexport const awardRecipients = pgTable('award_recipients', {\n  id: serial('id').primaryKey(),\n  awardId: integer('award_id').notNull().references(() =&gt; awards.id, { onDelete: 'cascade' }),\n  entityId: integer('entity_id').notNull().references(() =&gt; entities.id, { onDelete: 'cascade' }),\n  recipientRole: text('recipient_role'), // 'primary', 'collaborator', 'featured'\n})\n\nexport type Post = typeof posts.$inferSelect\nexport type NewPost = typeof posts.$inferInsert\nexport type Page = typeof pages.$inferSelect\nexport type NewPage = typeof pages.$inferInsert\nexport type User = typeof users.$inferSelect\nexport type Media = typeof media.$inferSelect\nexport type Entity = typeof entities.$inferSelect\nexport type NewEntity = typeof entities.$inferInsert\nexport type Award = typeof awards.$inferSelect\nexport type NewAward = typeof awards.$inferInsert\nexport type AwardRecipient = typeof awardRecipients.$inferSelect\nexport type NewAwardRecipient = typeof awardRecipients.$inferInsert\n\n// Redirects for SEO preservation\nexport const redirects = pgTable('redirects', {\n  id: serial('id').primaryKey(),\n  sourceUrl: text('source_url').notNull().unique(), // The old URL path (e.g., /old-page)\n  destinationUrl: text('destination_url').notNull(), // Where to redirect to (e.g., /new-page)\n  statusCode: integer('status_code').default(301), // 301 permanent, 302 temporary, 307, 308\n  enabled: boolean('enabled').default(true),\n  hitCount: integer('hit_count').default(0), // Track how often this redirect is used\n  lastHitAt: timestamp('last_hit_at'),\n  notes: text('notes'), // Admin notes about this redirect\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport type Redirect = typeof redirects.$inferSelect\nexport type NewRedirect = typeof redirects.$inferInsert\n\n// Oakland Tech Week Venue Host Applications\nexport const venueHosts = pgTable('venue_hosts', {\n  id: serial('id').primaryKey(),\n  // Contact info\n  contactName: text('contact_name').notNull(),\n  email: text('email').notNull(),\n  phone: text('phone'),\n  // Venue info\n  venueName: text('venue_name').notNull(),\n  address: text('address').notNull(),\n  city: text('city').default('Oakland'),\n  neighborhood: text('neighborhood'), // e.g., \"Downtown\", \"Temescal\", \"West Oakland\"\n  capacity: integer('capacity'), // Max number of people\n  spaceType: text('space_type'), // 'gallery', 'office', 'warehouse', 'restaurant', 'outdoor', 'studio', 'other'\n  // Availability &amp; amenities\n  availability: text('availability'), // Free-form text about when space is available\n  amenities: jsonb('amenities').$type&lt;string[]&gt;().default([]), // ['wifi', 'av_equipment', 'parking', 'accessible', 'kitchen', 'outdoor_space']\n  // Additional info\n  website: text('website'),\n  instagramHandle: text('instagram_handle'),\n  notes: text('notes'), // Any additional info from the host\n  // Admin fields\n  status: text('status').default('pending'), // 'pending', 'approved', 'rejected', 'contacted'\n  adminNotes: text('admin_notes'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport type VenueHost = typeof venueHosts.$inferSelect\nexport type NewVenueHost = typeof venueHosts.$inferInsert\n\n// Events (HiiiWAV Fest, Demo Days, community gatherings, etc.)\nexport const events = pgTable('events', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  description: text('description'),\n  content: text('content'), // Full markdown content for event page\n  coverImage: text('cover_image'),\n  eventDate: timestamp('event_date').notNull(), // When the event takes place\n  endDate: timestamp('end_date'), // Optional end date for multi-day events\n  location: text('location'), // Venue name\n  address: text('address'), // Full address\n  eventType: text('event_type'), // 'fest', 'demo_day', 'workshop', 'community', 'panel', 'networking'\n  registrationUrl: text('registration_url'), // External registration link\n  featured: boolean('featured').default(false), // Highlight on homepage\n  published: boolean('published').default(false),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport type Event = typeof events.$inferSelect\nexport type NewEvent = typeof events.$inferInsert\n\n// HiiiLIGHTS Newsletter Archive\nexport const newsletters = pgTable('newsletters', {\n  id: serial('id').primaryKey(),\n  slug: text('slug').notNull().unique(),\n  title: text('title').notNull(),\n  subtitle: text('subtitle'), // Optional subtitle/tagline\n  excerpt: text('excerpt'), // Short preview text\n  content: text('content').notNull(), // Full HTML/markdown content\n  coverImage: text('cover_image'),\n  issueNumber: integer('issue_number'), // e.g., Issue #1, #2\n  publishedAt: timestamp('published_at').notNull(), // When the newsletter was originally sent\n  published: boolean('published').default(true),\n  seoTitle: text('seo_title'),\n  seoDescription: text('seo_description'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n})\n\nexport type Newsletter = typeof newsletters.$inferSelect\nexport type NewNewsletter = typeof newsletters.$inferInsert\n\n\n\n\n",
  "totalLinesInFile": 218
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="read_file_v2">
<details>
<summary>Tool use: **read_file_v2**</summary>


Parameters:

```json
{
  "targetFile": "scripts/migrate-images-to-supabase.ts",
  "charsLimit": 1000000,
  "effectiveUri": "scripts/migrate-images-to-supabase.ts"
}
```
Result:

```json
{
  "contents": "/**\n * Migrate WordPress images to Supabase Storage\n * \n * Prerequisites:\n * 1. Create a public bucket named \"uploads\" in Supabase Storage\n * 2. Add NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY to .env.local\n * \n * Usage: npx tsx scripts/migrate-images-to-supabase.ts\n */\n\n// Load env FIRST before any other imports\nimport { config } from 'dotenv'\nimport { resolve } from 'path'\nconfig({ path: resolve(process.cwd(), '.env.local') })\n\n// Now import everything else\nimport { createClient } from '@supabase/supabase-js'\nimport * as fs from 'fs'\nimport * as path from 'path'\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY\nconst WP_UPLOADS_PATH = '/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/app/public/wp-content/uploads'\nconst BUCKET_NAME = 'uploads'\n\nif (!SUPABASE_URL || !SUPABASE_SERVICE_KEY) {\n  console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in .env.local')\n  console.log('\\nThe service role key is needed to bypass RLS for uploads.')\n  console.log('Get it from: https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj/settings/api')\n  process.exit(1)\n}\n\n// Use service role key to bypass RLS\nconst supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {\n  auth: { persistSession: false }\n})\n\n// Dynamically import db after env is loaded\nlet db: Awaited&lt;typeof import('../db')&gt;['db']\nlet posts: typeof import('../db/schema')['posts']\nlet pages: typeof import('../db/schema')['pages']\nlet eq: typeof import('drizzle-orm')['eq']\n\nasync function extractImageUrls(): Promise&lt;Set&lt;string&gt;&gt; {\n  const allPosts = await db.select().from(posts)\n  const allPages = await db.select().from(pages)\n  \n  const urls = new Set&lt;string&gt;()\n  \n  ;[...allPosts, ...allPages].forEach(item =&gt; {\n    // Cover images\n    if ('coverImage' in item &amp;&amp; item.coverImage?.includes('hiiiwav.org/wp-content/uploads')) {\n      urls.add(item.coverImage)\n    }\n    \n    // Images in content\n    const imgRegex = /https?:\\/\\/hiiiwav\\.org\\/wp-content\\/uploads\\/[^\\s\\)\\\"\\']+/g\n    const matches = item.content.match(imgRegex) || []\n    matches.forEach(m =&gt; urls.add(m.replace(/[)\\]\"']$/, ''))) // Clean trailing chars\n  })\n  \n  return urls\n}\n\nasync function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {\n  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')\n  const localPath = path.join(WP_UPLOADS_PATH, relativePath)\n  \n  // Check if file exists locally\n  if (!fs.existsSync(localPath)) {\n    console.log(&#96;  ‚ö†Ô∏è  Not found locally: ${relativePath}&#96;)\n    return null\n  }\n  \n  // Read file\n  const fileBuffer = fs.readFileSync(localPath)\n  const mimeType = getMimeType(localPath)\n  \n  // Upload to Supabase\n  const { data, error } = await supabase.storage\n    .from(BUCKET_NAME)\n    .upload(relativePath, fileBuffer, {\n      contentType: mimeType,\n      upsert: true\n    })\n  \n  if (error) {\n    console.log(&#96;  ‚ùå Upload failed: ${relativePath} - ${error.message}&#96;)\n    return null\n  }\n  \n  // Return public URL\n  const { data: urlData } = supabase.storage\n    .from(BUCKET_NAME)\n    .getPublicUrl(relativePath)\n  \n  return urlData.publicUrl\n}\n\nfunction getMimeType(filePath: string): string {\n  const ext = path.extname(filePath).toLowerCase()\n  const mimeTypes: Record&lt;string, string&gt; = {\n    '.jpg': 'image/jpeg',\n    '.jpeg': 'image/jpeg',\n    '.png': 'image/png',\n    '.gif': 'image/gif',\n    '.webp': 'image/webp',\n    '.svg': 'image/svg+xml',\n  }\n  return mimeTypes[ext] || 'application/octet-stream'\n}\n\nasync function updateDatabaseUrls(urlMap: Map&lt;string, string&gt;) {\n  console.log('\\nüìù Updating database URLs...')\n  \n  // Update posts\n  const allPosts = await db.select().from(posts)\n  for (const post of allPosts) {\n    let updated = false\n    let newContent = post.content\n    let newCoverImage = post.coverImage\n    \n    // Update cover image\n    if (post.coverImage &amp;&amp; urlMap.has(post.coverImage)) {\n      newCoverImage = urlMap.get(post.coverImage)!\n      updated = true\n    }\n    \n    // Update content\n    for (const [oldUrl, newUrl] of urlMap) {\n      if (newContent.includes(oldUrl)) {\n        newContent = newContent.split(oldUrl).join(newUrl)\n        updated = true\n      }\n    }\n    \n    if (updated) {\n      await db.update(posts)\n        .set({ content: newContent, coverImage: newCoverImage })\n        .where(eq(posts.id, post.id))\n      console.log(&#96;  ‚úì Updated post: ${post.slug}&#96;)\n    }\n  }\n  \n  // Update pages\n  const allPages = await db.select().from(pages)\n  for (const page of allPages) {\n    let updated = false\n    let newContent = page.content\n    \n    for (const [oldUrl, newUrl] of urlMap) {\n      if (newContent.includes(oldUrl)) {\n        newContent = newContent.split(oldUrl).join(newUrl)\n        updated = true\n      }\n    }\n    \n    if (updated) {\n      await db.update(pages)\n        .set({ content: newContent })\n        .where(eq(pages.id, page.id))\n      console.log(&#96;  ‚úì Updated page: ${page.slug}&#96;)\n    }\n  }\n}\n\nasync function main() {\n  console.log('üöÄ Starting image migration to Supabase Storage\\n')\n  \n  // Dynamically import db modules after env is loaded\n  const dbModule = await import('../db')\n  const schemaModule = await import('../db/schema')\n  const drizzleModule = await import('drizzle-orm')\n  db = dbModule.db\n  posts = schemaModule.posts\n  pages = schemaModule.pages\n  eq = drizzleModule.eq\n  \n  console.log(&#96;üìÅ Local WordPress uploads: ${WP_UPLOADS_PATH}&#96;)\n  console.log(&#96;‚òÅÔ∏è  Supabase URL: ${SUPABASE_URL}&#96;)\n  console.log(&#96;ü™£ Bucket: ${BUCKET_NAME}\\n&#96;)\n  \n  // Extract all image URLs from database\n  console.log('üîç Extracting image URLs from database...')\n  const wpUrls = await extractImageUrls()\n  console.log(&#96;   Found ${wpUrls.size} unique images\\n&#96;)\n  \n  // Upload each image and build URL map\n  console.log('üì§ Uploading images to Supabase...')\n  const urlMap = new Map&lt;string, string&gt;()\n  let uploaded = 0\n  let failed = 0\n  \n  for (const wpUrl of wpUrls) {\n    const newUrl = await uploadImage(wpUrl)\n    if (newUrl) {\n      urlMap.set(wpUrl, newUrl)\n      uploaded++\n      console.log(&#96;  ‚úì [${uploaded}/${wpUrls.size}] ${path.basename(wpUrl)}&#96;)\n    } else {\n      failed++\n    }\n  }\n  \n  console.log(&#96;\\n‚úÖ Uploaded: ${uploaded}&#96;)\n  console.log(&#96;‚ùå Failed: ${failed}&#96;)\n  \n  // Update database with new URLs\n  if (urlMap.size &gt; 0) {\n    await updateDatabaseUrls(urlMap)\n  }\n  \n  console.log('\\nüéâ Migration complete!')\n  process.exit(0)\n}\n\nmain().catch(err =&gt; {\n  console.error('‚ùå Migration failed:', err)\n  process.exit(1)\n})\n\n",
  "totalLinesInFile": 222
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="list_dir_v2">
<details>
<summary>Tool use: **list_dir_v2**</summary>


Parameters:

```json
{
  "targetDirectory": "app/admin"
}
```
Result:

```json
{
  "directoryTreeRoot": {
    "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin",
    "childrenDirs": [
      {
        "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/awards",
        "childrenDirs": [
          {
            "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/awards/[id]",
            "childrenFiles": [
              {
                "name": "page.tsx"
              }
            ],
            "childrenWereProcessed": true
          },
          {
            "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/awards/new",
            "childrenFiles": [
              {
                "name": "page.tsx"
              }
            ],
            "childrenWereProcessed": true
          }
        ],
        "childrenFiles": [
          {
            "name": "page.tsx"
          }
        ],
        "childrenWereProcessed": true
      },
      {
        "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/dashboard",
        "childrenFiles": [
          {
            "name": "page.tsx"
          }
        ],
        "childrenWereProcessed": true
      },
      {
        "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/entities",
        "childrenDirs": [
          {
            "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/entities/[id]",
            "childrenFiles": [
              {
                "name": "page.tsx"
              }
            ],
            "childrenWereProcessed": true
          },
          {
            "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/entities/new",
            "childrenFiles": [
              {
                "name": "page.tsx"
              }
            ],
            "childrenWereProcessed": true
          }
        ],
        "childrenFiles": [
          {
            "name": "page.tsx"
          }
        ],
        "childrenWereProcessed": true
      },
      {
        "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/posts",
        "childrenDirs": [
          {
            "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/posts/new",
            "childrenFiles": [
              {
                "name": "page.tsx"
              }
            ],
            "childrenWereProcessed": true
          }
        ],
        "childrenFiles": [
          {
            "name": "page.tsx"
          }
        ],
        "childrenWereProcessed": true
      },
      {
        "absPath": "/Users/boskombp16/GitHub/hiiiwav-website/app/admin/redirects",
        "childrenFiles": [
          {
            "name": "page.tsx"
          }
        ],
        "childrenWereProcessed": true
      }
    ],
    "childrenFiles": [
      {
        "name": "layout.tsx"
      }
    ],
    "childrenWereProcessed": true
  }
}
```
Status: **completed**


</details>
</tool-use>

---



---


Checking the admin setup and Supabase client configuration:


---

<tool-use data-tool-type="unknown" data-tool-name="read_file_v2">
<details>
<summary>Tool use: **read_file_v2**</summary>


Parameters:

```json
{
  "targetFile": "app/admin/layout.tsx",
  "charsLimit": 1000000,
  "effectiveUri": "app/admin/layout.tsx"
}
```
Result:

```json
{
  "contents": "import Link from 'next/link'\nimport { Button } from '@/components/ui/button'\n\nexport default function AdminLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;div className=\"flex min-h-screen\"&gt;\n      &lt;aside className=\"w-64 border-r bg-muted/40\"&gt;\n        &lt;div className=\"p-6\"&gt;\n          &lt;h2 className=\"text-lg font-semibold mb-6\"&gt;Admin&lt;/h2&gt;\n          &lt;nav className=\"space-y-2\"&gt;\n            &lt;Link href=\"/admin/dashboard\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                Dashboard\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n            &lt;Link href=\"/admin/posts\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                Posts\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n            &lt;Link href=\"/admin/pages\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                Pages\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n            &lt;div className=\"my-4 border-t\" /&gt;\n            &lt;Link href=\"/admin/entities\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                People &amp; Orgs\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n            &lt;Link href=\"/admin/awards\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                Awards\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n            &lt;div className=\"my-4 border-t\" /&gt;\n            &lt;Link href=\"/admin/redirects\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                Redirects\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n            &lt;div className=\"my-4 border-t\" /&gt;\n            &lt;Link href=\"/\"&gt;\n              &lt;Button variant=\"ghost\" className=\"w-full justify-start\"&gt;\n                ‚Üê Back to Site\n              &lt;/Button&gt;\n            &lt;/Link&gt;\n          &lt;/nav&gt;\n        &lt;/div&gt;\n      &lt;/aside&gt;\n      &lt;main className=\"flex-1 p-8\"&gt;\n        {children}\n      &lt;/main&gt;\n    &lt;/div&gt;\n  )\n}\n\n\n\n\n",
  "totalLinesInFile": 66
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "How is Supabase client initialized and used in the application?",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/dev-studio-README.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 67
          }
        },
        "contents": "# Dev Studio\n\nA centralized development environment for managing multiple projects using a single **Supabase** instance and **Vercel** account. This eliminates redundant setup and consolidates billing across all your apps.\n\n---\n\n## Why Dev Studio?\n\nInstead of creating separate Supabase projects and Vercel deployments for every app idea:\n\n- **One Supabase project** ‚Üí Multiple apps share the same database, separated by **schemas**\n- **One Vercel account** ‚Üí All apps deploy under the same billing, with automatic preview URLs\n- **Shared infrastructure** ‚Üí Auth, storage, and edge functions can be reused across projects\n- **No per-project fees** ‚Üí Supabase free tier limits apply to the whole project, not per-schema\n\n---\n\n## Architecture\n\n&#96;&#96;&#96;\ndev-studio (Supabase Project)\n‚îú‚îÄ‚îÄ core/              # Shared tables (users, settings, etc.)\n‚îú‚îÄ‚îÄ chatbot_app/       # Chatbot-specific tables\n‚îú‚îÄ‚îÄ crm_agent/         # CRM/Agent tables\n‚îú‚îÄ‚îÄ sites/             # Website projects (subscribers, pages, etc.)\n‚îî‚îÄ‚îÄ experiments/       # Quick experiments and prototypes\n&#96;&#96;&#96;\n\nEach app is a **separate GitHub repo** that connects to the same Supabase project but uses its own schema.\n\n---\n\n## Quick Reference\n\n### Supabase Connection\n\nAll apps use these environment variables (values stored in &#96;.env.local&#96;, never committed):\n\n&#96;&#96;&#96;env\nNEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co\nNEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...\nSUPABASE_SERVICE_ROLE_KEY=eyJhbGci...  # Server-only, never expose to browser\n&#96;&#96;&#96;\n\n### Schema-Qualified Queries\n\nApps access their data using schema-prefixed table names:\n\n&#96;&#96;&#96;ts\n// Chatbot app\nconst { data } = await supabase.from('chatbot_app.sessions').select('*');\n\n// CRM app\nconst { data } = await supabase.from('crm_agent.contacts').select('*');\n\n// Website project\nconst { data } = await supabase.from('sites.subscribers').select('*');\n&#96;&#96;&#96;\n\n---\n\n## Creating a New Project\n\n### For AI Assistants\n\nWhen starting a new project that uses Dev Studio infrastructure:",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# Dev Studio",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "A centralized development environment for managing multiple projects using a single **Supabase** instance and **Vercel** account. This eliminates redundant setup and consolidates billing across all your apps.",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "---",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "## Why Dev Studio?",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "Instead of creating separate Supabase projects and Vercel deployments for every app idea:",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "- **One Supabase project** ‚Üí Multiple apps share the same database, separated by **schemas**",
            "lineNumber": 11
          },
          {
            "text": "- **One Vercel account** ‚Üí All apps deploy under the same billing, with automatic preview URLs",
            "lineNumber": 12
          },
          {
            "text": "- **Shared infrastructure** ‚Üí Auth, storage, and edge functions can be reused across projects",
            "lineNumber": 13
          },
          {
            "text": "- **No per-project fees** ‚Üí Supabase free tier limits apply to the whole project, not per-schema",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "---",
            "lineNumber": 16
          },
          {
            "lineNumber": 17
          },
          {
            "text": "## Architecture",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 20
          },
          {
            "text": "dev-studio (Supabase Project)",
            "lineNumber": 21
          },
          {
            "text": "‚îú‚îÄ‚îÄ core/              # Shared tables (users, settings, etc.)",
            "lineNumber": 22
          },
          {
            "text": "‚îú‚îÄ‚îÄ chatbot_app/       # Chatbot-specific tables",
            "lineNumber": 23
          },
          {
            "text": "‚îú‚îÄ‚îÄ crm_agent/         # CRM/Agent tables",
            "lineNumber": 24
          },
          {
            "text": "‚îú‚îÄ‚îÄ sites/             # Website projects (subscribers, pages, etc.)",
            "lineNumber": 25
          },
          {
            "text": "‚îî‚îÄ‚îÄ experiments/       # Quick experiments and prototypes",
            "lineNumber": 26
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "Each app is a **separate GitHub repo** that connects to the same Supabase project but uses its own schema.",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "---",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "## Quick Reference",
            "lineNumber": 33
          },
          {
            "lineNumber": 34
          },
          {
            "text": "### Supabase Connection",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "All apps use these environment variables (values stored in &#96;.env.local&#96;, never committed):",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "&#96;&#96;&#96;env",
            "lineNumber": 39
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co",
            "lineNumber": 40
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGci...",
            "lineNumber": 41
          },
          {
            "text": "SUPABASE_SERVICE_ROLE_KEY=eyJhbGci...  # Server-only, never expose to browser",
            "lineNumber": 42
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "### Schema-Qualified Queries",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "Apps access their data using schema-prefixed table names:",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 49
          },
          {
            "text": "// Chatbot app",
            "lineNumber": 50
          },
          {
            "text": "const { data } = await supabase.from('chatbot_app.sessions').select('*');",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "// CRM app",
            "lineNumber": 53
          },
          {
            "text": "const { data } = await supabase.from('crm_agent.contacts').select('*');",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "// Website project",
            "lineNumber": 56
          },
          {
            "text": "const { data } = await supabase.from('sites.subscribers').select('*');",
            "lineNumber": 57
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "---",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "## Creating a New Project",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "### For AI Assistants",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "When starting a new project that uses Dev Studio infrastructure:",
            "lineNumber": 66
          }
        ]
      },
      "score": 0.41088318824768066
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/dev-studio-README.md",
        "range": {
          "startPosition": {
            "line": 65
          },
          "endPosition": {
            "line": 145,
            "column": 3
          }
        },
        "contents": "When starting a new project that uses Dev Studio infrastructure:\n\n1. **Create a new GitHub repo** for the project (don't add to this repo)\n2. **Use Next.js** with App Router as the framework\n3. **Connect to the existing Supabase project** using the env vars above\n4. **Create a new schema** for the project's tables:\n   &#96;&#96;&#96;sql\n   CREATE SCHEMA IF NOT EXISTS new_project_name;\n   &#96;&#96;&#96;\n5. **Deploy to Vercel** under the existing account\n6. **Use preview deployments** for collaboration (each branch/PR gets a unique URL)\n\n### Step-by-Step: New Next.js Project\n\n&#96;&#96;&#96;bash\n# 1. Create the project\nnpx create-next-app@latest my-new-app --typescript --tailwind --app --src-dir\n\n# 2. Install Supabase\ncd my-new-app\nnpm install @supabase/supabase-js @supabase/ssr\n\n# 3. Create .env.local with the dev-studio Supabase credentials\n# (copy from dev-studio or password manager)\n\n# 4. Create the Supabase client\nmkdir -p src/lib\n&#96;&#96;&#96;\n\n#### &#96;src/lib/supabase.ts&#96;\n\n&#96;&#96;&#96;ts\nimport { createClient } from '@supabase/supabase-js';\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n&#96;&#96;&#96;\n\n#### For Server Components (App Router)\n\n&#96;&#96;&#96;ts\n// src/lib/supabase-server.ts\nimport { createClient } from '@supabase/supabase-js';\n\nexport const supabaseAdmin = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\n);\n&#96;&#96;&#96;\n\n### Step-by-Step: Database Schema\n\nRun in Supabase SQL Editor:\n\n&#96;&#96;&#96;sql\n-- Create schema for new project\nCREATE SCHEMA IF NOT EXISTS my_new_app;\n\n-- Example: Create tables in that schema\nCREATE TABLE my_new_app.items (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  name TEXT NOT NULL,\n  created_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Enable RLS\nALTER TABLE my_new_app.items ENABLE ROW LEVEL SECURITY;\n\n-- Example policy (adjust for your auth needs)\nCREATE POLICY \"Public read access\" ON my_new_app.items\n  FOR SELECT USING (true);\n&#96;&#96;&#96;\n\n### Vercel Deployment\n\n1. Push repo to GitHub\n2. Import to Vercel (uses existing account)\n3. Add environment variables in Vercel dashboard:\n   ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "When starting a new project that uses Dev Studio infrastructure:",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "1. **Create a new GitHub repo** for the project (don't add to this repo)",
            "lineNumber": 68
          },
          {
            "text": "2. **Use Next.js** with App Router as the framework",
            "lineNumber": 69
          },
          {
            "text": "3. **Connect to the existing Supabase project** using the env vars above",
            "lineNumber": 70
          },
          {
            "text": "4. **Create a new schema** for the project's tables:",
            "lineNumber": 71
          },
          {
            "text": "   &#96;&#96;&#96;sql",
            "lineNumber": 72
          },
          {
            "text": "   CREATE SCHEMA IF NOT EXISTS new_project_name;",
            "lineNumber": 73
          },
          {
            "text": "   &#96;&#96;&#96;",
            "lineNumber": 74
          },
          {
            "text": "5. **Deploy to Vercel** under the existing account",
            "lineNumber": 75
          },
          {
            "text": "6. **Use preview deployments** for collaboration (each branch/PR gets a unique URL)",
            "lineNumber": 76
          },
          {
            "lineNumber": 77
          },
          {
            "text": "### Step-by-Step: New Next.js Project",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 80
          },
          {
            "text": "# 1. Create the project",
            "lineNumber": 81
          },
          {
            "text": "npx create-next-app@latest my-new-app --typescript --tailwind --app --src-dir",
            "lineNumber": 82
          },
          {
            "lineNumber": 83
          },
          {
            "text": "# 2. Install Supabase",
            "lineNumber": 84
          },
          {
            "text": "cd my-new-app",
            "lineNumber": 85
          },
          {
            "text": "npm install @supabase/supabase-js @supabase/ssr",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "# 3. Create .env.local with the dev-studio Supabase credentials",
            "lineNumber": 88
          },
          {
            "text": "# (copy from dev-studio or password manager)",
            "lineNumber": 89
          },
          {
            "lineNumber": 90
          },
          {
            "text": "# 4. Create the Supabase client",
            "lineNumber": 91
          },
          {
            "text": "mkdir -p src/lib",
            "lineNumber": 92
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 93
          },
          {
            "lineNumber": 94
          },
          {
            "text": "#### &#96;src/lib/supabase.ts&#96;",
            "lineNumber": 95
          },
          {
            "lineNumber": 96
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 97
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js';",
            "lineNumber": 98
          },
          {
            "lineNumber": 99
          },
          {
            "text": "export const supabase = createClient(",
            "lineNumber": 100
          },
          {
            "text": "  process.env.NEXT_PUBLIC_SUPABASE_URL!,",
            "lineNumber": 101
          },
          {
            "text": "  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!",
            "lineNumber": 102
          },
          {
            "text": ");",
            "lineNumber": 103
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 104
          },
          {
            "lineNumber": 105
          },
          {
            "text": "#### For Server Components (App Router)",
            "lineNumber": 106
          },
          {
            "lineNumber": 107
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 108
          },
          {
            "text": "// src/lib/supabase-server.ts",
            "lineNumber": 109
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js';",
            "lineNumber": 110
          },
          {
            "lineNumber": 111
          },
          {
            "text": "export const supabaseAdmin = createClient(",
            "lineNumber": 112
          },
          {
            "text": "  process.env.NEXT_PUBLIC_SUPABASE_URL!,",
            "lineNumber": 113
          },
          {
            "text": "  process.env.SUPABASE_SERVICE_ROLE_KEY!",
            "lineNumber": 114
          },
          {
            "text": ");",
            "lineNumber": 115
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "### Step-by-Step: Database Schema",
            "lineNumber": 118
          },
          {
            "lineNumber": 119
          },
          {
            "text": "Run in Supabase SQL Editor:",
            "lineNumber": 120
          },
          {
            "lineNumber": 121
          },
          {
            "text": "&#96;&#96;&#96;sql",
            "lineNumber": 122
          },
          {
            "text": "-- Create schema for new project",
            "lineNumber": 123
          },
          {
            "text": "CREATE SCHEMA IF NOT EXISTS my_new_app;",
            "lineNumber": 124
          },
          {
            "lineNumber": 125
          },
          {
            "text": "-- Example: Create tables in that schema",
            "lineNumber": 126
          },
          {
            "text": "CREATE TABLE my_new_app.items (",
            "lineNumber": 127
          },
          {
            "text": "  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),",
            "lineNumber": 128
          },
          {
            "text": "  name TEXT NOT NULL,",
            "lineNumber": 129
          },
          {
            "text": "  created_at TIMESTAMPTZ DEFAULT NOW()",
            "lineNumber": 130
          },
          {
            "text": ");",
            "lineNumber": 131
          },
          {
            "lineNumber": 132
          },
          {
            "text": "-- Enable RLS",
            "lineNumber": 133
          },
          {
            "text": "ALTER TABLE my_new_app.items ENABLE ROW LEVEL SECURITY;",
            "lineNumber": 134
          },
          {
            "lineNumber": 135
          },
          {
            "text": "-- Example policy (adjust for your auth needs)",
            "lineNumber": 136
          },
          {
            "text": "CREATE POLICY \"Public read access\" ON my_new_app.items",
            "lineNumber": 137
          },
          {
            "text": "  FOR SELECT USING (true);",
            "lineNumber": 138
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 139
          },
          {
            "lineNumber": 140
          },
          {
            "text": "### Vercel Deployment",
            "lineNumber": 141
          },
          {
            "lineNumber": 142
          },
          {
            "text": "1. Push repo to GitHub",
            "lineNumber": 143
          },
          {
            "text": "2. Import to Vercel (uses existing account)",
            "lineNumber": 144
          },
          {
            "text": "3. Add environment variables in Vercel dashboard:",
            "lineNumber": 145
          },
          {
            "text": "   ",
            "lineNumber": 146
          }
        ]
      },
      "score": 0.39180219173431396
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/dev-studio-README.md",
        "range": {
          "startPosition": {
            "line": 215
          },
          "endPosition": {
            "line": 286
          }
        },
        "contents": "When creating a new project using Dev Studio:\n\n- [ ] Create new GitHub repo\n- [ ] Initialize Next.js with TypeScript + Tailwind\n- [ ] Install &#96;@supabase/supabase-js&#96; and &#96;@supabase/ssr&#96;\n- [ ] Copy &#96;.env.local&#96; credentials from dev-studio\n- [ ] Create new schema in Supabase: &#96;CREATE SCHEMA IF NOT EXISTS project_name;&#96;\n- [ ] Create tables in that schema\n- [ ] Set up RLS policies\n- [ ] Import to Vercel\n- [ ] Add env vars to Vercel\n- [ ] Test preview deployments\n\n---\n\n## File Structure for New Projects\n\n&#96;&#96;&#96;\nmy-new-app/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ app/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/\n‚îÇ   ‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts        # Browser client\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase-server.ts # Server client (service role)\n‚îÇ   ‚îî‚îÄ‚îÄ types/\n‚îÇ       ‚îî‚îÄ‚îÄ database.ts        # Generated types from Supabase\n‚îú‚îÄ‚îÄ .env.local                 # Supabase credentials (never commit)\n‚îú‚îÄ‚îÄ .gitignore\n‚îî‚îÄ‚îÄ package.json\n&#96;&#96;&#96;\n\n---\n\n## Generating TypeScript Types\n\nFor type-safe Supabase queries:\n\n&#96;&#96;&#96;bash\n# Install Supabase CLI\nnpm install -D supabase\n\n# Login and generate types\nnpx supabase login\nnpx supabase gen types typescript --project-id YOUR_PROJECT_ID &gt; src/types/database.ts\n&#96;&#96;&#96;\n\nThen use with your client:\n\n&#96;&#96;&#96;ts\nimport { createClient } from '@supabase/supabase-js';\nimport type { Database } from '@/types/database';\n\nexport const supabase = createClient&lt;Database&gt;(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n&#96;&#96;&#96;\n\n---\n\n## Notes\n\n- **This repo (&#96;dev-studio&#96;)** is for documentation and SQL migrations only\n- **Actual apps** live in their own repos\n- **Supabase migrations** can be stored in &#96;supabase/migrations/&#96; here for version control\n- **Never commit** &#96;.env.local&#96; or any files containing API keys",
        "signatures": {},
        "detailedLines": [
          {
            "text": "When creating a new project using Dev Studio:",
            "lineNumber": 216
          },
          {
            "lineNumber": 217
          },
          {
            "text": "- [ ] Create new GitHub repo",
            "lineNumber": 218
          },
          {
            "text": "- [ ] Initialize Next.js with TypeScript + Tailwind",
            "lineNumber": 219
          },
          {
            "text": "- [ ] Install &#96;@supabase/supabase-js&#96; and &#96;@supabase/ssr&#96;",
            "lineNumber": 220
          },
          {
            "text": "- [ ] Copy &#96;.env.local&#96; credentials from dev-studio",
            "lineNumber": 221
          },
          {
            "text": "- [ ] Create new schema in Supabase: &#96;CREATE SCHEMA IF NOT EXISTS project_name;&#96;",
            "lineNumber": 222
          },
          {
            "text": "- [ ] Create tables in that schema",
            "lineNumber": 223
          },
          {
            "text": "- [ ] Set up RLS policies",
            "lineNumber": 224
          },
          {
            "text": "- [ ] Import to Vercel",
            "lineNumber": 225
          },
          {
            "text": "- [ ] Add env vars to Vercel",
            "lineNumber": 226
          },
          {
            "text": "- [ ] Test preview deployments",
            "lineNumber": 227
          },
          {
            "lineNumber": 228
          },
          {
            "text": "---",
            "lineNumber": 229
          },
          {
            "lineNumber": 230
          },
          {
            "text": "## File Structure for New Projects",
            "lineNumber": 231
          },
          {
            "lineNumber": 232
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 233
          },
          {
            "text": "my-new-app/",
            "lineNumber": 234
          },
          {
            "text": "‚îú‚îÄ‚îÄ src/",
            "lineNumber": 235
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ app/",
            "lineNumber": 236
          },
          {
            "text": "‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx",
            "lineNumber": 237
          },
          {
            "text": "‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx",
            "lineNumber": 238
          },
          {
            "text": "‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/",
            "lineNumber": 239
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ components/",
            "lineNumber": 240
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ lib/",
            "lineNumber": 241
          },
          {
            "text": "‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts        # Browser client",
            "lineNumber": 242
          },
          {
            "text": "‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase-server.ts # Server client (service role)",
            "lineNumber": 243
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ types/",
            "lineNumber": 244
          },
          {
            "text": "‚îÇ       ‚îî‚îÄ‚îÄ database.ts        # Generated types from Supabase",
            "lineNumber": 245
          },
          {
            "text": "‚îú‚îÄ‚îÄ .env.local                 # Supabase credentials (never commit)",
            "lineNumber": 246
          },
          {
            "text": "‚îú‚îÄ‚îÄ .gitignore",
            "lineNumber": 247
          },
          {
            "text": "‚îî‚îÄ‚îÄ package.json",
            "lineNumber": 248
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 249
          },
          {
            "lineNumber": 250
          },
          {
            "text": "---",
            "lineNumber": 251
          },
          {
            "lineNumber": 252
          },
          {
            "text": "## Generating TypeScript Types",
            "lineNumber": 253
          },
          {
            "lineNumber": 254
          },
          {
            "text": "For type-safe Supabase queries:",
            "lineNumber": 255
          },
          {
            "lineNumber": 256
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 257
          },
          {
            "text": "# Install Supabase CLI",
            "lineNumber": 258
          },
          {
            "text": "npm install -D supabase",
            "lineNumber": 259
          },
          {
            "lineNumber": 260
          },
          {
            "text": "# Login and generate types",
            "lineNumber": 261
          },
          {
            "text": "npx supabase login",
            "lineNumber": 262
          },
          {
            "text": "npx supabase gen types typescript --project-id YOUR_PROJECT_ID &gt; src/types/database.ts",
            "lineNumber": 263
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 264
          },
          {
            "lineNumber": 265
          },
          {
            "text": "Then use with your client:",
            "lineNumber": 266
          },
          {
            "lineNumber": 267
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 268
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js';",
            "lineNumber": 269
          },
          {
            "text": "import type { Database } from '@/types/database';",
            "lineNumber": 270
          },
          {
            "lineNumber": 271
          },
          {
            "text": "export const supabase = createClient&lt;Database&gt;(",
            "lineNumber": 272
          },
          {
            "text": "  process.env.NEXT_PUBLIC_SUPABASE_URL!,",
            "lineNumber": 273
          },
          {
            "text": "  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!",
            "lineNumber": 274
          },
          {
            "text": ");",
            "lineNumber": 275
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 276
          },
          {
            "lineNumber": 277
          },
          {
            "text": "---",
            "lineNumber": 278
          },
          {
            "lineNumber": 279
          },
          {
            "text": "## Notes",
            "lineNumber": 280
          },
          {
            "lineNumber": 281
          },
          {
            "text": "- **This repo (&#96;dev-studio&#96;)** is for documentation and SQL migrations only",
            "lineNumber": 282
          },
          {
            "text": "- **Actual apps** live in their own repos",
            "lineNumber": 283
          },
          {
            "text": "- **Supabase migrations** can be stored in &#96;supabase/migrations/&#96; here for version control",
            "lineNumber": 284
          },
          {
            "text": "- **Never commit** &#96;.env.local&#96; or any files containing API keys",
            "lineNumber": 285
          }
        ]
      },
      "score": 0.384750097990036
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./package.json",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 57
          }
        },
        "contents": "{\n  \"name\": \"festmgmt\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"next dev --turbopack\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"eslint\",\n    \"db:generate\": \"drizzle-kit generate\",\n    \"db:migrate\": \"drizzle-kit migrate\",\n    \"db:push\": \"drizzle-kit push\",\n    \"db:studio\": \"drizzle-kit studio\",\n    \"wp:import\": \"tsx scripts/import-wp-to-db.ts\",\n    \"wp:setup-storage\": \"tsx scripts/setup-supabase-storage.ts\",\n    \"wp:migrate-images\": \"tsx scripts/migrate-images-to-supabase.ts\",\n    \"create-admin\": \"tsx scripts/create-admin-user.ts\",\n    \"postbuild\": \"next-sitemap\"\n  },\n  \"dependencies\": {\n    \"@ai-sdk/anthropic\": \"^2.0.44\",\n    \"@ai-sdk/openai\": \"^2.0.67\",\n    \"@ai-sdk/react\": \"^2.0.93\",\n    \"@hookform/resolvers\": \"^5.2.2\",\n    \"@neondatabase/serverless\": \"^1.0.2\",\n    \"@radix-ui/react-slot\": \"^1.2.4\",\n    \"@supabase/supabase-js\": \"^2.86.2\",\n    \"@tiptap/pm\": \"^3.10.7\",\n    \"@tiptap/react\": \"^3.10.7\",\n    \"@tiptap/starter-kit\": \"^3.10.7\",\n    \"@uploadthing/react\": \"^7.3.3\",\n    \"ai\": \"^5.0.93\",\n    \"bcryptjs\": \"^3.0.3\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"clsx\": \"^2.1.1\",\n    \"drizzle-orm\": \"^0.44.7\",\n    \"gray-matter\": \"^4.0.3\",\n    \"lucide-react\": \"^0.553.0\",\n    \"next\": \"16.0.3\",\n    \"next-auth\": \"^5.0.0-beta.30\",\n    \"next-seo\": \"^7.0.1\",\n    \"next-sitemap\": \"^4.2.3\",\n    \"postgres\": \"^3.4.7\",\n    \"react\": \"19.2.0\",\n    \"react-dom\": \"19.2.0\",\n    \"react-hook-form\": \"^7.66.0\",\n    \"react-markdown\": \"^10.1.0\",\n    \"rehype-raw\": \"^7.0.0\",\n    \"remark-gfm\": \"^4.0.1\",\n    \"tailwind-merge\": \"^3.4.0\",\n    \"turndown\": \"^7.2.2\",\n    \"turndown-plugin-gfm\": \"^1.0.2\",\n    \"uploadthing\": \"^7.7.4\",\n    \"zod\": \"^4.1.12\"\n  },\n  \"devDependencies\": {\n    \"@tailwindcss/postcss\": \"^4\",",
        "signatures": {},
        "detailedLines": [
          {
            "text": "{",
            "lineNumber": 1
          },
          {
            "text": "  \"name\": \"festmgmt\",",
            "lineNumber": 2
          },
          {
            "text": "  \"version\": \"0.1.0\",",
            "lineNumber": 3
          },
          {
            "text": "  \"private\": true,",
            "lineNumber": 4
          },
          {
            "text": "  \"scripts\": {",
            "lineNumber": 5
          },
          {
            "text": "    \"dev\": \"next dev --turbopack\",",
            "lineNumber": 6
          },
          {
            "text": "    \"build\": \"next build\",",
            "lineNumber": 7
          },
          {
            "text": "    \"start\": \"next start\",",
            "lineNumber": 8
          },
          {
            "text": "    \"lint\": \"eslint\",",
            "lineNumber": 9
          },
          {
            "text": "    \"db:generate\": \"drizzle-kit generate\",",
            "lineNumber": 10
          },
          {
            "text": "    \"db:migrate\": \"drizzle-kit migrate\",",
            "lineNumber": 11
          },
          {
            "text": "    \"db:push\": \"drizzle-kit push\",",
            "lineNumber": 12
          },
          {
            "text": "    \"db:studio\": \"drizzle-kit studio\",",
            "lineNumber": 13
          },
          {
            "text": "    \"wp:import\": \"tsx scripts/import-wp-to-db.ts\",",
            "lineNumber": 14
          },
          {
            "text": "    \"wp:setup-storage\": \"tsx scripts/setup-supabase-storage.ts\",",
            "lineNumber": 15
          },
          {
            "text": "    \"wp:migrate-images\": \"tsx scripts/migrate-images-to-supabase.ts\",",
            "lineNumber": 16
          },
          {
            "text": "    \"create-admin\": \"tsx scripts/create-admin-user.ts\",",
            "lineNumber": 17
          },
          {
            "text": "    \"postbuild\": \"next-sitemap\"",
            "lineNumber": 18
          },
          {
            "text": "  },",
            "lineNumber": 19
          },
          {
            "text": "  \"dependencies\": {",
            "lineNumber": 20
          },
          {
            "text": "    \"@ai-sdk/anthropic\": \"^2.0.44\",",
            "lineNumber": 21
          },
          {
            "text": "    \"@ai-sdk/openai\": \"^2.0.67\",",
            "lineNumber": 22
          },
          {
            "text": "    \"@ai-sdk/react\": \"^2.0.93\",",
            "lineNumber": 23
          },
          {
            "text": "    \"@hookform/resolvers\": \"^5.2.2\",",
            "lineNumber": 24
          },
          {
            "text": "    \"@neondatabase/serverless\": \"^1.0.2\",",
            "lineNumber": 25
          },
          {
            "text": "    \"@radix-ui/react-slot\": \"^1.2.4\",",
            "lineNumber": 26
          },
          {
            "text": "    \"@supabase/supabase-js\": \"^2.86.2\",",
            "lineNumber": 27
          },
          {
            "text": "    \"@tiptap/pm\": \"^3.10.7\",",
            "lineNumber": 28
          },
          {
            "text": "    \"@tiptap/react\": \"^3.10.7\",",
            "lineNumber": 29
          },
          {
            "text": "    \"@tiptap/starter-kit\": \"^3.10.7\",",
            "lineNumber": 30
          },
          {
            "text": "    \"@uploadthing/react\": \"^7.3.3\",",
            "lineNumber": 31
          },
          {
            "text": "    \"ai\": \"^5.0.93\",",
            "lineNumber": 32
          },
          {
            "text": "    \"bcryptjs\": \"^3.0.3\",",
            "lineNumber": 33
          },
          {
            "text": "    \"class-variance-authority\": \"^0.7.1\",",
            "lineNumber": 34
          },
          {
            "text": "    \"clsx\": \"^2.1.1\",",
            "lineNumber": 35
          },
          {
            "text": "    \"drizzle-orm\": \"^0.44.7\",",
            "lineNumber": 36
          },
          {
            "text": "    \"gray-matter\": \"^4.0.3\",",
            "lineNumber": 37
          },
          {
            "text": "    \"lucide-react\": \"^0.553.0\",",
            "lineNumber": 38
          },
          {
            "text": "    \"next\": \"16.0.3\",",
            "lineNumber": 39
          },
          {
            "text": "    \"next-auth\": \"^5.0.0-beta.30\",",
            "lineNumber": 40
          },
          {
            "text": "    \"next-seo\": \"^7.0.1\",",
            "lineNumber": 41
          },
          {
            "text": "    \"next-sitemap\": \"^4.2.3\",",
            "lineNumber": 42
          },
          {
            "text": "    \"postgres\": \"^3.4.7\",",
            "lineNumber": 43
          },
          {
            "text": "    \"react\": \"19.2.0\",",
            "lineNumber": 44
          },
          {
            "text": "    \"react-dom\": \"19.2.0\",",
            "lineNumber": 45
          },
          {
            "text": "    \"react-hook-form\": \"^7.66.0\",",
            "lineNumber": 46
          },
          {
            "text": "    \"react-markdown\": \"^10.1.0\",",
            "lineNumber": 47
          },
          {
            "text": "    \"rehype-raw\": \"^7.0.0\",",
            "lineNumber": 48
          },
          {
            "text": "    \"remark-gfm\": \"^4.0.1\",",
            "lineNumber": 49
          },
          {
            "text": "    \"tailwind-merge\": \"^3.4.0\",",
            "lineNumber": 50
          },
          {
            "text": "    \"turndown\": \"^7.2.2\",",
            "lineNumber": 51
          },
          {
            "text": "    \"turndown-plugin-gfm\": \"^1.0.2\",",
            "lineNumber": 52
          },
          {
            "text": "    \"uploadthing\": \"^7.7.4\",",
            "lineNumber": 53
          },
          {
            "text": "    \"zod\": \"^4.1.12\"",
            "lineNumber": 54
          },
          {
            "text": "  },",
            "lineNumber": 55
          },
          {
            "text": "  \"devDependencies\": {",
            "lineNumber": 56
          },
          {
            "text": "    \"@tailwindcss/postcss\": \"^4\",",
            "lineNumber": 57
          }
        ]
      },
      "score": 0.3716239929199219
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/index.ts",
        "range": {
          "startPosition": {
            "column": 49
          },
          "endPosition": {
            "line": 16,
            "column": 25
          }
        },
        "contents": "import postgres from 'postgres'\nimport * as schema from './schema'\n\nfunction getDb() {\n  if (!process.env.DATABASE_URL) {\n    throw new Error('DATABASE_URL is not set. Please add it to .env.local')\n  }\n  const client = postgres(process.env.DATABASE_URL, {\n    connect_timeout: 60,\n    idle_timeout: 20,\n    max_lifetime: 60 * 30,\n  })\n  return drizzle(client, { schema })\n}\n\nexport const db = getDb()",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import postgres from 'postgres'",
            "lineNumber": 2
          },
          {
            "text": "import * as schema from './schema'",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "function getDb() {",
            "lineNumber": 5,
            "isSignature": true
          },
          {
            "text": "  if (!process.env.DATABASE_URL) {",
            "lineNumber": 6
          },
          {
            "text": "    throw new Error('DATABASE_URL is not set. Please add it to .env.local')",
            "lineNumber": 7
          },
          {
            "text": "  }",
            "lineNumber": 8
          },
          {
            "text": "  const client = postgres(process.env.DATABASE_URL, {",
            "lineNumber": 9
          },
          {
            "text": "    connect_timeout: 60,",
            "lineNumber": 10
          },
          {
            "text": "    idle_timeout: 20,",
            "lineNumber": 11
          },
          {
            "text": "    max_lifetime: 60 * 30,",
            "lineNumber": 12
          },
          {
            "text": "  })",
            "lineNumber": 13
          },
          {
            "text": "  return drizzle(client, { schema })",
            "lineNumber": 14
          },
          {
            "text": "}",
            "lineNumber": 15,
            "isSignature": true
          },
          {
            "lineNumber": 16
          },
          {
            "text": "export const db = getDb()",
            "lineNumber": 17
          }
        ]
      },
      "score": 0.370615690946579
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/INFRASTRUCTURE.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 69
          }
        },
        "contents": "# HIIIWAV Infrastructure &amp; Accounts\n\n&gt; Quick reference for all services and accounts needed to manage hiiiwav.org\n\n## Services Overview\n\n| Service | Purpose | Account | Dashboard |\n|---------|---------|---------|-----------|\n| **Supabase** | Database &amp; Storage | GitHub: &#96;boscokante&#96; | [Dashboard](https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj) |\n| **Vercel** | Hosting &amp; Deployment | _TBD_ | [Dashboard](https://vercel.com/dashboard) |\n| **GitHub** | Code Repository | &#96;boscokante&#96; | [Repo](https://github.com/boscokante/hiiiwav-website) |\n| **Domain Registrar** | DNS for hiiiwav.org | _TBD_ | _TBD_ |\n| **Kinsta** | OLD WordPress (to be decommissioned) | _TBD_ | [Dashboard](https://my.kinsta.com/) |\n\n---\n\n## Supabase\n\n- **Project ID:** &#96;pzoyeigicwgmmlngxowj&#96;\n- **Region:** &#96;us-west-2&#96; (Oregon)\n- **Login:** GitHub OAuth (&#96;boscokante&#96;)\n- **Dashboard:** https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj\n\n### Resources Used\n- [x] PostgreSQL Database\n- [ ] Storage (for migrated WordPress images)\n- [ ] Auth (if needed later)\n\n### Key URLs\n- Database: &#96;aws-0-us-west-2.pooler.supabase.com&#96;\n- Storage: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/&#96;\n\n---\n\n## Vercel (Hosting)\n\n- **Account:** &#96;boscokante&#96; (or linked GitHub account)\n- **Project Name:** &#96;hiiiwav-website&#96;\n- **Preview URL:** https://hiiiwav-website.vercel.app\n- **Dashboard:** https://vercel.com/dashboard\n\n### Environment Variables to Set\n&#96;&#96;&#96;\nDATABASE_URL=postgresql://...\nNEXTAUTH_SECRET=...\nNEXTAUTH_URL=https://hiiiwav.org\nOPENAI_API_KEY=...\nNEXT_PUBLIC_SUPABASE_URL=https://pzoyeigicwgmmlngxowj.supabase.co\nNEXT_PUBLIC_SUPABASE_ANON_KEY=...\n&#96;&#96;&#96;\n\n---\n\n## GitHub\n\n- **Account:** &#96;boscokante&#96;\n- **Repo:** https://github.com/boscokante/hiiiwav-website\n- **Archive Repo:** https://github.com/boscokante/hiiiwav-wordpress-archive\n\n---\n\n## Domain &amp; DNS\n\n- **Domain:** &#96;hiiiwav.org&#96;\n- **Registrar:** _TBD (GoDaddy? Namecheap? Cloudflare?)_\n- **Current DNS:** Points to Kinsta (WordPress)\n- **After Migration:** Will point to Vercel\n\n### DNS Records Needed for Vercel",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# HIIIWAV Infrastructure &amp; Accounts",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "&gt; Quick reference for all services and accounts needed to manage hiiiwav.org",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "## Services Overview",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "| Service | Purpose | Account | Dashboard |",
            "lineNumber": 7
          },
          {
            "text": "|---------|---------|---------|-----------|",
            "lineNumber": 8
          },
          {
            "text": "| **Supabase** | Database &amp; Storage | GitHub: &#96;boscokante&#96; | [Dashboard](https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj) |",
            "lineNumber": 9
          },
          {
            "text": "| **Vercel** | Hosting &amp; Deployment | _TBD_ | [Dashboard](https://vercel.com/dashboard) |",
            "lineNumber": 10
          },
          {
            "text": "| **GitHub** | Code Repository | &#96;boscokante&#96; | [Repo](https://github.com/boscokante/hiiiwav-website) |",
            "lineNumber": 11
          },
          {
            "text": "| **Domain Registrar** | DNS for hiiiwav.org | _TBD_ | _TBD_ |",
            "lineNumber": 12
          },
          {
            "text": "| **Kinsta** | OLD WordPress (to be decommissioned) | _TBD_ | [Dashboard](https://my.kinsta.com/) |",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "---",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "## Supabase",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "- **Project ID:** &#96;pzoyeigicwgmmlngxowj&#96;",
            "lineNumber": 19
          },
          {
            "text": "- **Region:** &#96;us-west-2&#96; (Oregon)",
            "lineNumber": 20
          },
          {
            "text": "- **Login:** GitHub OAuth (&#96;boscokante&#96;)",
            "lineNumber": 21
          },
          {
            "text": "- **Dashboard:** https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "### Resources Used",
            "lineNumber": 24
          },
          {
            "text": "- [x] PostgreSQL Database",
            "lineNumber": 25
          },
          {
            "text": "- [ ] Storage (for migrated WordPress images)",
            "lineNumber": 26
          },
          {
            "text": "- [ ] Auth (if needed later)",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "### Key URLs",
            "lineNumber": 29
          },
          {
            "text": "- Database: &#96;aws-0-us-west-2.pooler.supabase.com&#96;",
            "lineNumber": 30
          },
          {
            "text": "- Storage: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/&#96;",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "---",
            "lineNumber": 33
          },
          {
            "lineNumber": 34
          },
          {
            "text": "## Vercel (Hosting)",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "- **Account:** &#96;boscokante&#96; (or linked GitHub account)",
            "lineNumber": 37
          },
          {
            "text": "- **Project Name:** &#96;hiiiwav-website&#96;",
            "lineNumber": 38
          },
          {
            "text": "- **Preview URL:** https://hiiiwav-website.vercel.app",
            "lineNumber": 39
          },
          {
            "text": "- **Dashboard:** https://vercel.com/dashboard",
            "lineNumber": 40
          },
          {
            "lineNumber": 41
          },
          {
            "text": "### Environment Variables to Set",
            "lineNumber": 42
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 43
          },
          {
            "text": "DATABASE_URL=postgresql://...",
            "lineNumber": 44
          },
          {
            "text": "NEXTAUTH_SECRET=...",
            "lineNumber": 45
          },
          {
            "text": "NEXTAUTH_URL=https://hiiiwav.org",
            "lineNumber": 46
          },
          {
            "text": "OPENAI_API_KEY=...",
            "lineNumber": 47
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_URL=https://pzoyeigicwgmmlngxowj.supabase.co",
            "lineNumber": 48
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_ANON_KEY=...",
            "lineNumber": 49
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "---",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "## GitHub",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "- **Account:** &#96;boscokante&#96;",
            "lineNumber": 56
          },
          {
            "text": "- **Repo:** https://github.com/boscokante/hiiiwav-website",
            "lineNumber": 57
          },
          {
            "text": "- **Archive Repo:** https://github.com/boscokante/hiiiwav-wordpress-archive",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "---",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "## Domain &amp; DNS",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "- **Domain:** &#96;hiiiwav.org&#96;",
            "lineNumber": 64
          },
          {
            "text": "- **Registrar:** _TBD (GoDaddy? Namecheap? Cloudflare?)_",
            "lineNumber": 65
          },
          {
            "text": "- **Current DNS:** Points to Kinsta (WordPress)",
            "lineNumber": 66
          },
          {
            "text": "- **After Migration:** Will point to Vercel",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "### DNS Records Needed for Vercel",
            "lineNumber": 69
          }
        ]
      },
      "score": 0.370418906211853
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./README.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 87
          }
        },
        "contents": "# HIIIWAV Website - Next.js Migration\n\nModern, AI-powered website migrated from WordPress to Next.js 15.\n\n## Tech Stack\n\n- **Next.js 15** (App Router, React Server Components)\n- **TypeScript**\n- **Tailwind CSS** + shadcn/ui\n- **Drizzle ORM** + **Postgres** (Neon/Vercel)\n- **NextAuth.js v5** for authentication\n- **Vercel AI SDK** (OpenAI/Anthropic)\n- **TipTap** rich text editor\n\n## Getting Started\n\n### 1. Install Dependencies\n\n&#96;&#96;&#96;bash\nnpm install\n&#96;&#96;&#96;\n\n### 2. Set Up Database\n\nCreate a Neon or Vercel Postgres database, then:\n\n&#96;&#96;&#96;bash\n# Copy env example\ncp .env.local.example .env.local\n\n# Edit .env.local and add your DATABASE_URL\n# Then push the schema\nnpm run db:push\n&#96;&#96;&#96;\n\n### 3. Import WordPress Content\n\n&#96;&#96;&#96;bash\n# Set WP_BASE if different from default\nWP_BASE=https://hiiiwav.org/wp-json/wp/v2 npm run wp:import\n&#96;&#96;&#96;\n\n### 4. Create Admin User\n\nYou'll need to manually insert a user or create a signup script. Quick SQL:\n\n&#96;&#96;&#96;sql\nINSERT INTO users (email, name, role, password_hash)\nVALUES (\n  'admin@hiiiwav.org',\n  'Admin',\n  'admin',\n  -- Run: node -e \"console.log(require('bcryptjs').hashSync('your-password', 10))\"\n  '$2a$10$...'\n);\n&#96;&#96;&#96;\n\n### 5. Run Development Server\n\n&#96;&#96;&#96;bash\nnpm run dev\n&#96;&#96;&#96;\n\nOpen [http://localhost:3000](http://localhost:3000)\n\n## Project Structure\n\n&#96;&#96;&#96;\n‚îú‚îÄ‚îÄ app/                    # Next.js App Router\n‚îÇ   ‚îú‚îÄ‚îÄ (public)/          # Public pages\n‚îÇ   ‚îú‚îÄ‚îÄ admin/             # Admin dashboard\n‚îÇ   ‚îú‚îÄ‚îÄ api/               # API routes\n‚îÇ   ‚îî‚îÄ‚îÄ blog/              # Blog pages\n‚îú‚îÄ‚îÄ components/            # React components\n‚îÇ   ‚îú‚îÄ‚îÄ ui/               # shadcn components\n‚îÇ   ‚îú‚îÄ‚îÄ admin/            # Admin components\n‚îÇ   ‚îî‚îÄ‚îÄ ai/               # AI components\n‚îú‚îÄ‚îÄ db/                    # Database\n‚îÇ   ‚îú‚îÄ‚îÄ schema.ts         # Drizzle schema\n‚îÇ   ‚îî‚îÄ‚îÄ index.ts          # DB client\n‚îú‚îÄ‚îÄ lib/                   # Utilities\n‚îú‚îÄ‚îÄ scripts/               # Migration scripts\n‚îî‚îÄ‚îÄ docs/                  # Documentation\n&#96;&#96;&#96;\n\n## Key Features",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# HIIIWAV Website - Next.js Migration",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "Modern, AI-powered website migrated from WordPress to Next.js 15.",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "## Tech Stack",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "- **Next.js 15** (App Router, React Server Components)",
            "lineNumber": 7
          },
          {
            "text": "- **TypeScript**",
            "lineNumber": 8
          },
          {
            "text": "- **Tailwind CSS** + shadcn/ui",
            "lineNumber": 9
          },
          {
            "text": "- **Drizzle ORM** + **Postgres** (Neon/Vercel)",
            "lineNumber": 10
          },
          {
            "text": "- **NextAuth.js v5** for authentication",
            "lineNumber": 11
          },
          {
            "text": "- **Vercel AI SDK** (OpenAI/Anthropic)",
            "lineNumber": 12
          },
          {
            "text": "- **TipTap** rich text editor",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "## Getting Started",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "### 1. Install Dependencies",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 19
          },
          {
            "text": "npm install",
            "lineNumber": 20
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 21
          },
          {
            "lineNumber": 22
          },
          {
            "text": "### 2. Set Up Database",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "Create a Neon or Vercel Postgres database, then:",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 27
          },
          {
            "text": "# Copy env example",
            "lineNumber": 28
          },
          {
            "text": "cp .env.local.example .env.local",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "# Edit .env.local and add your DATABASE_URL",
            "lineNumber": 31
          },
          {
            "text": "# Then push the schema",
            "lineNumber": 32
          },
          {
            "text": "npm run db:push",
            "lineNumber": 33
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "### 3. Import WordPress Content",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 38
          },
          {
            "text": "# Set WP_BASE if different from default",
            "lineNumber": 39
          },
          {
            "text": "WP_BASE=https://hiiiwav.org/wp-json/wp/v2 npm run wp:import",
            "lineNumber": 40
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 41
          },
          {
            "lineNumber": 42
          },
          {
            "text": "### 4. Create Admin User",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "You'll need to manually insert a user or create a signup script. Quick SQL:",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "&#96;&#96;&#96;sql",
            "lineNumber": 47
          },
          {
            "text": "INSERT INTO users (email, name, role, password_hash)",
            "lineNumber": 48
          },
          {
            "text": "VALUES (",
            "lineNumber": 49
          },
          {
            "text": "  'admin@hiiiwav.org',",
            "lineNumber": 50
          },
          {
            "text": "  'Admin',",
            "lineNumber": 51
          },
          {
            "text": "  'admin',",
            "lineNumber": 52
          },
          {
            "text": "  -- Run: node -e \"console.log(require('bcryptjs').hashSync('your-password', 10))\"",
            "lineNumber": 53
          },
          {
            "text": "  '$2a$10$...'",
            "lineNumber": 54
          },
          {
            "text": ");",
            "lineNumber": 55
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 56
          },
          {
            "lineNumber": 57
          },
          {
            "text": "### 5. Run Development Server",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 60
          },
          {
            "text": "npm run dev",
            "lineNumber": 61
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "Open [http://localhost:3000](http://localhost:3000)",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "## Project Structure",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 68
          },
          {
            "text": "‚îú‚îÄ‚îÄ app/                    # Next.js App Router",
            "lineNumber": 69
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ (public)/          # Public pages",
            "lineNumber": 70
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ admin/             # Admin dashboard",
            "lineNumber": 71
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ api/               # API routes",
            "lineNumber": 72
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ blog/              # Blog pages",
            "lineNumber": 73
          },
          {
            "text": "‚îú‚îÄ‚îÄ components/            # React components",
            "lineNumber": 74
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ ui/               # shadcn components",
            "lineNumber": 75
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ admin/            # Admin components",
            "lineNumber": 76
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ ai/               # AI components",
            "lineNumber": 77
          },
          {
            "text": "‚îú‚îÄ‚îÄ db/                    # Database",
            "lineNumber": 78
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ schema.ts         # Drizzle schema",
            "lineNumber": 79
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ index.ts          # DB client",
            "lineNumber": 80
          },
          {
            "text": "‚îú‚îÄ‚îÄ lib/                   # Utilities",
            "lineNumber": 81
          },
          {
            "text": "‚îú‚îÄ‚îÄ scripts/               # Migration scripts",
            "lineNumber": 82
          },
          {
            "text": "‚îî‚îÄ‚îÄ docs/                  # Documentation",
            "lineNumber": 83
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 84
          },
          {
            "lineNumber": 85
          },
          {
            "text": "## Key Features",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.34725522994995117
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/setup-supabase-storage.ts",
        "range": {
          "startPosition": {
            "line": 12,
            "column": 54
          },
          "endPosition": {
            "line": 117,
            "column": 1
          }
        },
        "contents": "import { createClient } from '@supabase/supabase-js'\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY\nconst BUCKET_NAME = 'uploads'\n\nasync function main() {\n  console.log('üöÄ Setting up Supabase Storage\\n')\n\n  // Validate environment\n  if (!SUPABASE_URL) {\n    console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL in .env.local')\n    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')\n    process.exit(1)\n  }\n\n  if (!SUPABASE_SERVICE_KEY) {\n    console.error('‚ùå Missing SUPABASE_SERVICE_ROLE_KEY in .env.local')\n    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')\n    console.log('(Look for \"service_role\" key - keep this secret!)\\n')\n    \n    // Provide the exact URL for their project\n    const projectId = SUPABASE_URL.match(/https:\\/\\/([^.]+)/)?.[1]\n    if (projectId) {\n      console.log(&#96;Direct link: https://supabase.com/dashboard/project/${projectId}/settings/api&#96;)\n    }\n    process.exit(1)\n  }\n\n  // Create admin client with service role key\n  const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {\n    auth: { persistSession: false }\n  })\n\n  console.log(&#96;üìç Supabase URL: ${SUPABASE_URL}&#96;)\n  console.log(&#96;ü™£ Bucket name: ${BUCKET_NAME}\\n&#96;)\n\n  // Check existing buckets\n  console.log('üîç Checking existing buckets...')\n  const { data: buckets, error: listError } = await supabase.storage.listBuckets()\n\n  if (listError) {\n    console.error('‚ùå Failed to list buckets:', listError.message)\n    process.exit(1)\n  }\n\n  const existingBucket = buckets?.find(b =&gt; b.name === BUCKET_NAME)\n\n  if (existingBucket) {\n    console.log\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "const SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL",
            "lineNumber": 17
          },
          {
            "text": "const SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY",
            "lineNumber": 18
          },
          {
            "text": "const BUCKET_NAME = 'uploads'",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "async function main() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "  console.log('üöÄ Setting up Supabase Storage\\n')",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "  // Validate environment",
            "lineNumber": 24
          },
          {
            "text": "  if (!SUPABASE_URL) {",
            "lineNumber": 25
          },
          {
            "text": "    console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL in .env.local')",
            "lineNumber": 26
          },
          {
            "text": "    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')",
            "lineNumber": 27
          },
          {
            "text": "    process.exit(1)",
            "lineNumber": 28
          },
          {
            "text": "  }",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "  if (!SUPABASE_SERVICE_KEY) {",
            "lineNumber": 31
          },
          {
            "text": "    console.error('‚ùå Missing SUPABASE_SERVICE_ROLE_KEY in .env.local')",
            "lineNumber": 32
          },
          {
            "text": "    console.log('\\nGet it from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api')",
            "lineNumber": 33
          },
          {
            "text": "    console.log('(Look for \"service_role\" key - keep this secret!)\\n')",
            "lineNumber": 34
          },
          {
            "text": "    ",
            "lineNumber": 35
          },
          {
            "text": "    // Provide the exact URL for their project",
            "lineNumber": 36
          },
          {
            "text": "    const projectId = SUPABASE_URL.match(/https:\\/\\/([^.]+)/)?.[1]",
            "lineNumber": 37
          },
          {
            "text": "    if (projectId) {",
            "lineNumber": 38
          },
          {
            "text": "      console.log(&#96;Direct link: https://supabase.com/dashboard/project/${projectId}/settings/api&#96;)",
            "lineNumber": 39
          },
          {
            "text": "    }",
            "lineNumber": 40
          },
          {
            "text": "    process.exit(1)",
            "lineNumber": 41
          },
          {
            "text": "  }",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "  // Create admin client with service role key",
            "lineNumber": 44
          },
          {
            "text": "  const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {",
            "lineNumber": 45
          },
          {
            "text": "    auth: { persistSession: false }",
            "lineNumber": 46
          },
          {
            "text": "  })",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "  console.log(&#96;üìç Supabase URL: ${SUPABASE_URL}&#96;)",
            "lineNumber": 49
          },
          {
            "text": "  console.log(&#96;ü™£ Bucket name: ${BUCKET_NAME}\\n&#96;)",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "  // Check existing buckets",
            "lineNumber": 52
          },
          {
            "text": "  console.log('üîç Checking existing buckets...')",
            "lineNumber": 53
          },
          {
            "text": "  const { data: buckets, error: listError } = await supabase.storage.listBuckets()",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "  if (listError) {",
            "lineNumber": 56
          },
          {
            "text": "    console.error('‚ùå Failed to list buckets:', listError.message)",
            "lineNumber": 57
          },
          {
            "text": "    process.exit(1)",
            "lineNumber": 58
          },
          {
            "text": "  }",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "  const existingBucket = buckets?.find(b =&gt; b.name === BUCKET_NAME)",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "  if (existingBucket) {",
            "lineNumber": 63
          },
          {
            "text": "    console.log",
            "lineNumber": 64
          },
          {
            "text": "}",
            "lineNumber": 118,
            "isSignature": true
          }
        ]
      },
      "score": 0.32941940426826477
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 13,
            "column": 54
          },
          "endPosition": {
            "line": 97,
            "column": 1
          }
        },
        "contents": "// Now import everything else\nimport { createClient } from '@supabase/supabase-js'\nimport * as fs from 'fs'\nimport * as path from 'path'\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY\nconst WP_UPLOADS_PATH = '/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/app/public/wp-content/uploads'\nconst BUCKET_NAME = 'uploads'\n\nif (!SUPABASE_URL || !SUPABASE_SERVICE_KEY) {\n  console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in .env.local')\n  console.log('\\nThe service role key is needed to bypass RLS for uploads.')\n  console.log('Get it from: https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj/settings/api')\n  process.exit(1)\n}\n\n// Use service role key to bypass RLS\nconst supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {\n  auth: { persistSession: false }\n})\n\n// Dynamically import db after env is loaded\nlet db: Awaited&lt;typeof import('../db')&gt;['db']\nlet posts: typeof import('../db/schema')['posts']\nlet pages: typeof import('../db/schema')['pages']\nlet eq: typeof import('drizzle-orm')['eq']\n\nasync function extractImageUrls(): Promise&lt;Set&lt;string&gt;&gt; {\n  const allPosts = await db.select().from(posts)\n  const allPages = await db.select().from(pages)\n  \n  const urls = new Set&lt;string&gt;()\n  \n  ;[...allPosts, ...allPages].forEach(item =&gt; {\n    // Cover images\n    if ('coverImage' in item &amp;&amp; item.coverImage?.includes('hiiiwav.org/wp-content/uploads')) {\n      urls.add(item.coverImage)\n    }\n    \n    // Images in content\n    const imgRegex = /https?:\\/\\/hiiiwav\\.org\\/wp-content\\/uploads\\/[^\\s\\)\\\"\\']+/g\n    const matches = item.content.match(imgRegex) || []\n    matches.forEach(m =&gt; urls.add(m.replace(/[)\\]\"']$/, ''))) // Clean trailing chars\n  })\n  \n  return urls\n}\n\nasync function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {\n  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// Now import everything else",
            "lineNumber": 16
          },
          {
            "text": "import { createClient } from '@supabase/supabase-js'",
            "lineNumber": 17
          },
          {
            "text": "import * as fs from 'fs'",
            "lineNumber": 18
          },
          {
            "text": "import * as path from 'path'",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "const SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL",
            "lineNumber": 21
          },
          {
            "text": "const SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY",
            "lineNumber": 22
          },
          {
            "text": "const WP_UPLOADS_PATH = '/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/app/public/wp-content/uploads'",
            "lineNumber": 23
          },
          {
            "text": "const BUCKET_NAME = 'uploads'",
            "lineNumber": 24
          },
          {
            "lineNumber": 25
          },
          {
            "text": "if (!SUPABASE_URL || !SUPABASE_SERVICE_KEY) {",
            "lineNumber": 26
          },
          {
            "text": "  console.error('‚ùå Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in .env.local')",
            "lineNumber": 27
          },
          {
            "text": "  console.log('\\nThe service role key is needed to bypass RLS for uploads.')",
            "lineNumber": 28
          },
          {
            "text": "  console.log('Get it from: https://supabase.com/dashboard/project/pzoyeigicwgmmlngxowj/settings/api')",
            "lineNumber": 29
          },
          {
            "text": "  process.exit(1)",
            "lineNumber": 30
          },
          {
            "text": "}",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "// Use service role key to bypass RLS",
            "lineNumber": 33
          },
          {
            "text": "const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {",
            "lineNumber": 34
          },
          {
            "text": "  auth: { persistSession: false }",
            "lineNumber": 35
          },
          {
            "text": "})",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "// Dynamically import db after env is loaded",
            "lineNumber": 38
          },
          {
            "text": "let db: Awaited&lt;typeof import('../db')&gt;['db']",
            "lineNumber": 39
          },
          {
            "text": "let posts: typeof import('../db/schema')['posts']",
            "lineNumber": 40
          },
          {
            "text": "let pages: typeof import('../db/schema')['pages']",
            "lineNumber": 41
          },
          {
            "text": "let eq: typeof import('drizzle-orm')['eq']",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "async function extractImageUrls(): Promise&lt;Set&lt;string&gt;&gt; {",
            "lineNumber": 44,
            "isSignature": true
          },
          {
            "text": "  const allPosts = await db.select().from(posts)",
            "lineNumber": 45
          },
          {
            "text": "  const allPages = await db.select().from(pages)",
            "lineNumber": 46
          },
          {
            "text": "  ",
            "lineNumber": 47
          },
          {
            "text": "  const urls = new Set&lt;string&gt;()",
            "lineNumber": 48
          },
          {
            "text": "  ",
            "lineNumber": 49
          },
          {
            "text": "  ;[...allPosts, ...allPages].forEach(item =&gt; {",
            "lineNumber": 50
          },
          {
            "text": "    // Cover images",
            "lineNumber": 51
          },
          {
            "text": "    if ('coverImage' in item &amp;&amp; item.coverImage?.includes('hiiiwav.org/wp-content/uploads')) {",
            "lineNumber": 52
          },
          {
            "text": "      urls.add(item.coverImage)",
            "lineNumber": 53
          },
          {
            "text": "    }",
            "lineNumber": 54
          },
          {
            "text": "    ",
            "lineNumber": 55
          },
          {
            "text": "    // Images in content",
            "lineNumber": 56
          },
          {
            "text": "    const imgRegex = /https?:\\/\\/hiiiwav\\.org\\/wp-content\\/uploads\\/[^\\s\\)\\\"\\']+/g",
            "lineNumber": 57
          },
          {
            "text": "    const matches = item.content.match(imgRegex) || []",
            "lineNumber": 58
          },
          {
            "text": "    matches.forEach(m =&gt; urls.add(m.replace(/[)\\]\"']$/, ''))) // Clean trailing chars",
            "lineNumber": 59
          },
          {
            "text": "  })",
            "lineNumber": 60
          },
          {
            "text": "  ",
            "lineNumber": 61
          },
          {
            "text": "  return urls",
            "lineNumber": 62
          },
          {
            "text": "}",
            "lineNumber": 63,
            "isSignature": true
          },
          {
            "lineNumber": 64
          },
          {
            "text": "async function uploadImage(wpUrl: string): Promise&lt;string | null&gt; {",
            "lineNumber": 65,
            "isSignature": true
          },
          {
            "text": "  const relativePath = wpUrl.replace('https://hiiiwav.org/wp-content/uploads/', '')",
            "lineNumber": 66
          },
          {
            "text": "}",
            "lineNumber": 98,
            "isSignature": true
          }
        ]
      },
      "score": 0.32509100437164307
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./lib/auth.ts",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 64,
            "column": 2
          }
        },
        "contents": "import NextAuth from 'next-auth'\nimport Credentials from 'next-auth/providers/credentials'\nimport { db } from '@/db'\nimport { users } from '@/db/schema'\nimport { eq } from 'drizzle-orm'\nimport { compare } from 'bcryptjs'\n\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n  providers: [\n    Credentials({\n      credentials: {\n        email: { label: 'Email', type: 'email' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          return null\n        }\n\n        const user = await db\n          .select()\n          .from(users)\n          .where(eq(users.email, credentials.email as string))\n          .limit(1)\n          .then((rows) =&gt; rows[0])\n\n        if (!user || !user.passwordHash) {\n          return null\n        }\n\n        const isValid = await compare(credentials.password as string, user.passwordHash)\n\n        if (!isValid) {\n          return null\n        }\n\n        return {\n          id: user.id.toString(),\n          email: user.email,\n          name: user.name,\n          role: user.role,\n        }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.role = (user as any).role\n        token.id = user.id\n      }\n      return token\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        (session.user as any).role = token.role as string\n        (session.user as any).id = token.id as string\n      }\n      return session\n    },\n  },\n  pages: {\n    signIn: '/login',\n  },\n})",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import NextAuth from 'next-auth'",
            "lineNumber": 1
          },
          {
            "text": "import Credentials from 'next-auth/providers/credentials'",
            "lineNumber": 2
          },
          {
            "text": "import { db } from '@/db'",
            "lineNumber": 3
          },
          {
            "text": "import { users } from '@/db/schema'",
            "lineNumber": 4
          },
          {
            "text": "import { eq } from 'drizzle-orm'",
            "lineNumber": 5
          },
          {
            "text": "import { compare } from 'bcryptjs'",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "export const { handlers, signIn, signOut, auth } = NextAuth({",
            "lineNumber": 8
          },
          {
            "text": "  providers: [",
            "lineNumber": 9
          },
          {
            "text": "    Credentials({",
            "lineNumber": 10
          },
          {
            "text": "      credentials: {",
            "lineNumber": 11
          },
          {
            "text": "        email: { label: 'Email', type: 'email' },",
            "lineNumber": 12
          },
          {
            "text": "        password: { label: 'Password', type: 'password' },",
            "lineNumber": 13
          },
          {
            "text": "      },",
            "lineNumber": 14
          },
          {
            "text": "      async authorize(credentials) {",
            "lineNumber": 15
          },
          {
            "text": "        if (!credentials?.email || !credentials?.password) {",
            "lineNumber": 16
          },
          {
            "text": "          return null",
            "lineNumber": 17
          },
          {
            "text": "        }",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "        const user = await db",
            "lineNumber": 20
          },
          {
            "text": "          .select()",
            "lineNumber": 21
          },
          {
            "text": "          .from(users)",
            "lineNumber": 22
          },
          {
            "text": "          .where(eq(users.email, credentials.email as string))",
            "lineNumber": 23
          },
          {
            "text": "          .limit(1)",
            "lineNumber": 24
          },
          {
            "text": "          .then((rows) =&gt; rows[0])",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "        if (!user || !user.passwordHash) {",
            "lineNumber": 27
          },
          {
            "text": "          return null",
            "lineNumber": 28
          },
          {
            "text": "        }",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "        const isValid = await compare(credentials.password as string, user.passwordHash)",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "        if (!isValid) {",
            "lineNumber": 33
          },
          {
            "text": "          return null",
            "lineNumber": 34
          },
          {
            "text": "        }",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "        return {",
            "lineNumber": 37
          },
          {
            "text": "          id: user.id.toString(),",
            "lineNumber": 38
          },
          {
            "text": "          email: user.email,",
            "lineNumber": 39
          },
          {
            "text": "          name: user.name,",
            "lineNumber": 40
          },
          {
            "text": "          role: user.role,",
            "lineNumber": 41
          },
          {
            "text": "        }",
            "lineNumber": 42
          },
          {
            "text": "      },",
            "lineNumber": 43
          },
          {
            "text": "    }),",
            "lineNumber": 44
          },
          {
            "text": "  ],",
            "lineNumber": 45
          },
          {
            "text": "  callbacks: {",
            "lineNumber": 46
          },
          {
            "text": "    async jwt({ token, user }) {",
            "lineNumber": 47
          },
          {
            "text": "      if (user) {",
            "lineNumber": 48
          },
          {
            "text": "        token.role = (user as any).role",
            "lineNumber": 49
          },
          {
            "text": "        token.id = user.id",
            "lineNumber": 50
          },
          {
            "text": "      }",
            "lineNumber": 51
          },
          {
            "text": "      return token",
            "lineNumber": 52
          },
          {
            "text": "    },",
            "lineNumber": 53
          },
          {
            "text": "    async session({ session, token }) {",
            "lineNumber": 54
          },
          {
            "text": "      if (session.user) {",
            "lineNumber": 55
          },
          {
            "text": "        (session.user as any).role = token.role as string",
            "lineNumber": 56
          },
          {
            "text": "        (session.user as any).id = token.id as string",
            "lineNumber": 57
          },
          {
            "text": "      }",
            "lineNumber": 58
          },
          {
            "text": "      return session",
            "lineNumber": 59
          },
          {
            "text": "    },",
            "lineNumber": 60
          },
          {
            "text": "  },",
            "lineNumber": 61
          },
          {
            "text": "  pages: {",
            "lineNumber": 62
          },
          {
            "text": "    signIn: '/login',",
            "lineNumber": 63
          },
          {
            "text": "  },",
            "lineNumber": 64
          },
          {
            "text": "})",
            "lineNumber": 65
          }
        ]
      },
      "score": 0.30894696712493896
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/SETUP.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 124
          }
        },
        "contents": "# Setup Guide\n\n## Quick Start (5 minutes)\n\n### 1. Database Setup (Neon - Free Tier)\n\n1. Go to [neon.tech](https://neon.tech)\n2. Sign up / Login\n3. Create new project: \"hiiiwav\"\n4. Copy the connection string\n\n&#96;&#96;&#96;bash\n# Add to .env.local\nDATABASE_URL=\"postgresql://user:pass@ep-xxx.us-east-2.aws.neon.tech/neondb?sslmode=require\"\n&#96;&#96;&#96;\n\n### 2. Push Database Schema\n\n&#96;&#96;&#96;bash\nnpm run db:push\n&#96;&#96;&#96;\n\nThis creates all tables (posts, pages, users, media).\n\n### 3. Generate Auth Secret\n\n&#96;&#96;&#96;bash\nopenssl rand -base64 32\n&#96;&#96;&#96;\n\nAdd to &#96;.env.local&#96;:\n\n&#96;&#96;&#96;bash\nNEXTAUTH_SECRET=\"your-generated-secret\"\nNEXTAUTH_URL=\"http://localhost:3000\"\n&#96;&#96;&#96;\n\n### 4. Import WordPress Content\n\n&#96;&#96;&#96;bash\n# Default: hiiiwav.org\nnpm run wp:import\n\n# Or specify custom URL\nWP_BASE=https://your-site.com/wp-json/wp/v2 npm run wp:import\n&#96;&#96;&#96;\n\nThis will:\n- Fetch all posts and pages via WP REST API\n- Convert HTML to Markdown\n- Download metadata\n- Insert into Postgres\n\n### 5. Create Admin User\n\nGenerate a password hash:\n\n&#96;&#96;&#96;bash\nnode -e \"console.log(require('bcryptjs').hashSync('YourPassword123', 10))\"\n&#96;&#96;&#96;\n\nInsert user via Drizzle Studio or SQL:\n\n&#96;&#96;&#96;bash\nnpm run db:studio\n&#96;&#96;&#96;\n\nOr direct SQL:\n\n&#96;&#96;&#96;sql\nINSERT INTO users (email, name, role, password_hash, created_at)\nVALUES (\n  'admin@hiiiwav.org',\n  'Admin',\n  'admin',\n  '$2a$10$YOUR_GENERATED_HASH',\n  NOW()\n);\n&#96;&#96;&#96;\n\n### 6. Start Development Server\n\n&#96;&#96;&#96;bash\nnpm run dev\n&#96;&#96;&#96;\n\nVisit:\n- **Homepage**: http://localhost:3000\n- **Blog**: http://localhost:3000/blog\n- **Admin**: http://localhost:3000/admin\n- **Login**: http://localhost:3000/login\n\n---\n\n## Optional: AI Features\n\n### OpenAI Setup\n\n1. Get API key from [platform.openai.com](https://platform.openai.com)\n2. Add to &#96;.env.local&#96;:\n\n&#96;&#96;&#96;bash\nOPENAI_API_KEY=\"sk-proj-...\"\n&#96;&#96;&#96;\n\nThe AI chat widget will now work on all pages.\n\n### Test AI Chat\n\n1. Visit homepage\n2. Click floating chat button (bottom-right)\n3. Ask: \"What is HIIIWAV about?\"\n\n---\n\n## Optional: Anthropic (Claude)\n\n&#96;&#96;&#96;bash\nANTHROPIC_API_KEY=\"sk-ant-...\"\n&#96;&#96;&#96;\n\nThen update &#96;app/api/ai/chat/route.ts&#96;:\n\n&#96;&#96;&#96;ts",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# Setup Guide",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "## Quick Start (5 minutes)",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "### 1. Database Setup (Neon - Free Tier)",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "1. Go to [neon.tech](https://neon.tech)",
            "lineNumber": 7
          },
          {
            "text": "2. Sign up / Login",
            "lineNumber": 8
          },
          {
            "text": "3. Create new project: \"hiiiwav\"",
            "lineNumber": 9
          },
          {
            "text": "4. Copy the connection string",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 12
          },
          {
            "text": "# Add to .env.local",
            "lineNumber": 13
          },
          {
            "text": "DATABASE_URL=\"postgresql://user:pass@ep-xxx.us-east-2.aws.neon.tech/neondb?sslmode=require\"",
            "lineNumber": 14
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "### 2. Push Database Schema",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 19
          },
          {
            "text": "npm run db:push",
            "lineNumber": 20
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 21
          },
          {
            "lineNumber": 22
          },
          {
            "text": "This creates all tables (posts, pages, users, media).",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "### 3. Generate Auth Secret",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 27
          },
          {
            "text": "openssl rand -base64 32",
            "lineNumber": 28
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "Add to &#96;.env.local&#96;:",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 33
          },
          {
            "text": "NEXTAUTH_SECRET=\"your-generated-secret\"",
            "lineNumber": 34
          },
          {
            "text": "NEXTAUTH_URL=\"http://localhost:3000\"",
            "lineNumber": 35
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "### 4. Import WordPress Content",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 40
          },
          {
            "text": "# Default: hiiiwav.org",
            "lineNumber": 41
          },
          {
            "text": "npm run wp:import",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "# Or specify custom URL",
            "lineNumber": 44
          },
          {
            "text": "WP_BASE=https://your-site.com/wp-json/wp/v2 npm run wp:import",
            "lineNumber": 45
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 46
          },
          {
            "lineNumber": 47
          },
          {
            "text": "This will:",
            "lineNumber": 48
          },
          {
            "text": "- Fetch all posts and pages via WP REST API",
            "lineNumber": 49
          },
          {
            "text": "- Convert HTML to Markdown",
            "lineNumber": 50
          },
          {
            "text": "- Download metadata",
            "lineNumber": 51
          },
          {
            "text": "- Insert into Postgres",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "### 5. Create Admin User",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "Generate a password hash:",
            "lineNumber": 56
          },
          {
            "lineNumber": 57
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 58
          },
          {
            "text": "node -e \"console.log(require('bcryptjs').hashSync('YourPassword123', 10))\"",
            "lineNumber": 59
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "Insert user via Drizzle Studio or SQL:",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 64
          },
          {
            "text": "npm run db:studio",
            "lineNumber": 65
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "Or direct SQL:",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "&#96;&#96;&#96;sql",
            "lineNumber": 70
          },
          {
            "text": "INSERT INTO users (email, name, role, password_hash, created_at)",
            "lineNumber": 71
          },
          {
            "text": "VALUES (",
            "lineNumber": 72
          },
          {
            "text": "  'admin@hiiiwav.org',",
            "lineNumber": 73
          },
          {
            "text": "  'Admin',",
            "lineNumber": 74
          },
          {
            "text": "  'admin',",
            "lineNumber": 75
          },
          {
            "text": "  '$2a$10$YOUR_GENERATED_HASH',",
            "lineNumber": 76
          },
          {
            "text": "  NOW()",
            "lineNumber": 77
          },
          {
            "text": ");",
            "lineNumber": 78
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 79
          },
          {
            "lineNumber": 80
          },
          {
            "text": "### 6. Start Development Server",
            "lineNumber": 81
          },
          {
            "lineNumber": 82
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 83
          },
          {
            "text": "npm run dev",
            "lineNumber": 84
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 85
          },
          {
            "lineNumber": 86
          },
          {
            "text": "Visit:",
            "lineNumber": 87
          },
          {
            "text": "- **Homepage**: http://localhost:3000",
            "lineNumber": 88
          },
          {
            "text": "- **Blog**: http://localhost:3000/blog",
            "lineNumber": 89
          },
          {
            "text": "- **Admin**: http://localhost:3000/admin",
            "lineNumber": 90
          },
          {
            "text": "- **Login**: http://localhost:3000/login",
            "lineNumber": 91
          },
          {
            "lineNumber": 92
          },
          {
            "text": "---",
            "lineNumber": 93
          },
          {
            "lineNumber": 94
          },
          {
            "text": "## Optional: AI Features",
            "lineNumber": 95
          },
          {
            "lineNumber": 96
          },
          {
            "text": "### OpenAI Setup",
            "lineNumber": 97
          },
          {
            "lineNumber": 98
          },
          {
            "text": "1. Get API key from [platform.openai.com](https://platform.openai.com)",
            "lineNumber": 99
          },
          {
            "text": "2. Add to &#96;.env.local&#96;:",
            "lineNumber": 100
          },
          {
            "lineNumber": 101
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 102
          },
          {
            "text": "OPENAI_API_KEY=\"sk-proj-...\"",
            "lineNumber": 103
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 104
          },
          {
            "lineNumber": 105
          },
          {
            "text": "The AI chat widget will now work on all pages.",
            "lineNumber": 106
          },
          {
            "lineNumber": 107
          },
          {
            "text": "### Test AI Chat",
            "lineNumber": 108
          },
          {
            "lineNumber": 109
          },
          {
            "text": "1. Visit homepage",
            "lineNumber": 110
          },
          {
            "text": "2. Click floating chat button (bottom-right)",
            "lineNumber": 111
          },
          {
            "text": "3. Ask: \"What is HIIIWAV about?\"",
            "lineNumber": 112
          },
          {
            "lineNumber": 113
          },
          {
            "text": "---",
            "lineNumber": 114
          },
          {
            "lineNumber": 115
          },
          {
            "text": "## Optional: Anthropic (Claude)",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 118
          },
          {
            "text": "ANTHROPIC_API_KEY=\"sk-ant-...\"",
            "lineNumber": 119
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 120
          },
          {
            "lineNumber": 121
          },
          {
            "text": "Then update &#96;app/api/ai/chat/route.ts&#96;:",
            "lineNumber": 122
          },
          {
            "lineNumber": 123
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 124
          }
        ]
      },
      "score": 0.29763203859329224
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./db/index.ts",
        "range": {
          "startPosition": {
            "line": 14,
            "column": 1
          },
          "endPosition": {
            "line": 16,
            "column": 25
          }
        },
        "contents": "export const db = getDb()",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export const db = getDb()",
            "lineNumber": 17
          }
        ]
      },
      "score": 0.2902218997478485
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/MIGRATION_COMPLETE.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 87
          }
        },
        "contents": "# üéâ Migration Complete!\n\nYour WordPress to Next.js migration is **DONE**! The foundation is built and ready for you to customize.\n\n## ‚úÖ What's Been Built\n\n### Core Infrastructure\n- ‚úÖ Next.js 15 (App Router, Turbopack)\n- ‚úÖ TypeScript + Tailwind CSS\n- ‚úÖ Drizzle ORM + Postgres schema\n- ‚úÖ NextAuth.js v5 authentication\n- ‚úÖ SEO (sitemap, metadata, OpenGraph)\n- ‚úÖ Image optimization (&#96;next/image&#96;)\n- ‚úÖ AI API routes (OpenAI integration ready)\n\n### Pages &amp; Routes\n- ‚úÖ Homepage (&#96;/&#96;)\n- ‚úÖ Blog listing (&#96;/blog&#96;)\n- ‚úÖ Blog posts (&#96;/blog/[slug]&#96;)\n- ‚úÖ Login (&#96;/login&#96;)\n- ‚úÖ Admin dashboard (&#96;/admin/dashboard&#96;)\n- ‚úÖ Admin posts manager (&#96;/admin/posts&#96;)\n- ‚úÖ Post editor with TipTap (&#96;/admin/posts/new&#96;)\n\n### Components\n- ‚úÖ Site header with navigation\n- ‚úÖ Site footer\n- ‚úÖ AI chat widget (ready to enable)\n- ‚úÖ shadcn/ui components (Button, Input, Textarea)\n- ‚úÖ Rich text editor (TipTap)\n\n### Scripts\n- ‚úÖ WordPress import script (&#96;npm run wp:import&#96;)\n- ‚úÖ Database migration commands\n- ‚úÖ Automatic sitemap generation\n\n### Configuration\n- ‚úÖ Image remote patterns (WordPress CDN)\n- ‚úÖ 301 redirects system (via &#96;redirects.json&#96;)\n- ‚úÖ Environment variable templates\n- ‚úÖ Build scripts\n\n---\n\n## üöÄ Next Steps (5-10 minutes)\n\n### 1. Set Up Database\n\n**Option A: Neon (Recommended - Free)**\n1. Go to [neon.tech](https://neon.tech)\n2. Create project \"hiiiwav\"\n3. Copy connection string\n4. Create &#96;.env.local&#96;:\n\n&#96;&#96;&#96;bash\nDATABASE_URL=\"postgresql://user:pass@host:5432/db\"\nNEXTAUTH_SECRET=\"$(openssl rand -base64 32)\"\nNEXTAUTH_URL=\"http://localhost:3000\"\n&#96;&#96;&#96;\n\n**Option B: Vercel Postgres**\n1. Go to Vercel dashboard\n2. Create Postgres database\n3. Copy connection string\n\n### 2. Push Database Schema\n\n&#96;&#96;&#96;bash\nnpm run db:push\n&#96;&#96;&#96;\n\nThis creates all tables (posts, pages, users, media).\n\n### 3. Import WordPress Content\n\n&#96;&#96;&#96;bash\nnpm run wp:import\n&#96;&#96;&#96;\n\nThis will:\n- Fetch all posts/pages from hiiiwav.org via REST API\n- Convert HTML ‚Üí Markdown\n- Insert into your database\n- Preserve metadata (titles, dates, tags, images)\n\n### 4. Create Admin User",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# üéâ Migration Complete!",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "Your WordPress to Next.js migration is **DONE**! The foundation is built and ready for you to customize.",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "## ‚úÖ What's Been Built",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "### Core Infrastructure",
            "lineNumber": 7
          },
          {
            "text": "- ‚úÖ Next.js 15 (App Router, Turbopack)",
            "lineNumber": 8
          },
          {
            "text": "- ‚úÖ TypeScript + Tailwind CSS",
            "lineNumber": 9
          },
          {
            "text": "- ‚úÖ Drizzle ORM + Postgres schema",
            "lineNumber": 10
          },
          {
            "text": "- ‚úÖ NextAuth.js v5 authentication",
            "lineNumber": 11
          },
          {
            "text": "- ‚úÖ SEO (sitemap, metadata, OpenGraph)",
            "lineNumber": 12
          },
          {
            "text": "- ‚úÖ Image optimization (&#96;next/image&#96;)",
            "lineNumber": 13
          },
          {
            "text": "- ‚úÖ AI API routes (OpenAI integration ready)",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "### Pages &amp; Routes",
            "lineNumber": 16
          },
          {
            "text": "- ‚úÖ Homepage (&#96;/&#96;)",
            "lineNumber": 17
          },
          {
            "text": "- ‚úÖ Blog listing (&#96;/blog&#96;)",
            "lineNumber": 18
          },
          {
            "text": "- ‚úÖ Blog posts (&#96;/blog/[slug]&#96;)",
            "lineNumber": 19
          },
          {
            "text": "- ‚úÖ Login (&#96;/login&#96;)",
            "lineNumber": 20
          },
          {
            "text": "- ‚úÖ Admin dashboard (&#96;/admin/dashboard&#96;)",
            "lineNumber": 21
          },
          {
            "text": "- ‚úÖ Admin posts manager (&#96;/admin/posts&#96;)",
            "lineNumber": 22
          },
          {
            "text": "- ‚úÖ Post editor with TipTap (&#96;/admin/posts/new&#96;)",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "### Components",
            "lineNumber": 25
          },
          {
            "text": "- ‚úÖ Site header with navigation",
            "lineNumber": 26
          },
          {
            "text": "- ‚úÖ Site footer",
            "lineNumber": 27
          },
          {
            "text": "- ‚úÖ AI chat widget (ready to enable)",
            "lineNumber": 28
          },
          {
            "text": "- ‚úÖ shadcn/ui components (Button, Input, Textarea)",
            "lineNumber": 29
          },
          {
            "text": "- ‚úÖ Rich text editor (TipTap)",
            "lineNumber": 30
          },
          {
            "lineNumber": 31
          },
          {
            "text": "### Scripts",
            "lineNumber": 32
          },
          {
            "text": "- ‚úÖ WordPress import script (&#96;npm run wp:import&#96;)",
            "lineNumber": 33
          },
          {
            "text": "- ‚úÖ Database migration commands",
            "lineNumber": 34
          },
          {
            "text": "- ‚úÖ Automatic sitemap generation",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "### Configuration",
            "lineNumber": 37
          },
          {
            "text": "- ‚úÖ Image remote patterns (WordPress CDN)",
            "lineNumber": 38
          },
          {
            "text": "- ‚úÖ 301 redirects system (via &#96;redirects.json&#96;)",
            "lineNumber": 39
          },
          {
            "text": "- ‚úÖ Environment variable templates",
            "lineNumber": 40
          },
          {
            "text": "- ‚úÖ Build scripts",
            "lineNumber": 41
          },
          {
            "lineNumber": 42
          },
          {
            "text": "---",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "## üöÄ Next Steps (5-10 minutes)",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "### 1. Set Up Database",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "**Option A: Neon (Recommended - Free)**",
            "lineNumber": 49
          },
          {
            "text": "1. Go to [neon.tech](https://neon.tech)",
            "lineNumber": 50
          },
          {
            "text": "2. Create project \"hiiiwav\"",
            "lineNumber": 51
          },
          {
            "text": "3. Copy connection string",
            "lineNumber": 52
          },
          {
            "text": "4. Create &#96;.env.local&#96;:",
            "lineNumber": 53
          },
          {
            "lineNumber": 54
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 55
          },
          {
            "text": "DATABASE_URL=\"postgresql://user:pass@host:5432/db\"",
            "lineNumber": 56
          },
          {
            "text": "NEXTAUTH_SECRET=\"$(openssl rand -base64 32)\"",
            "lineNumber": 57
          },
          {
            "text": "NEXTAUTH_URL=\"http://localhost:3000\"",
            "lineNumber": 58
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "**Option B: Vercel Postgres**",
            "lineNumber": 61
          },
          {
            "text": "1. Go to Vercel dashboard",
            "lineNumber": 62
          },
          {
            "text": "2. Create Postgres database",
            "lineNumber": 63
          },
          {
            "text": "3. Copy connection string",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "### 2. Push Database Schema",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 68
          },
          {
            "text": "npm run db:push",
            "lineNumber": 69
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 70
          },
          {
            "lineNumber": 71
          },
          {
            "text": "This creates all tables (posts, pages, users, media).",
            "lineNumber": 72
          },
          {
            "lineNumber": 73
          },
          {
            "text": "### 3. Import WordPress Content",
            "lineNumber": 74
          },
          {
            "lineNumber": 75
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 76
          },
          {
            "text": "npm run wp:import",
            "lineNumber": 77
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "This will:",
            "lineNumber": 80
          },
          {
            "text": "- Fetch all posts/pages from hiiiwav.org via REST API",
            "lineNumber": 81
          },
          {
            "text": "- Convert HTML ‚Üí Markdown",
            "lineNumber": 82
          },
          {
            "text": "- Insert into your database",
            "lineNumber": 83
          },
          {
            "text": "- Preserve metadata (titles, dates, tags, images)",
            "lineNumber": 84
          },
          {
            "lineNumber": 85
          },
          {
            "text": "### 4. Create Admin User",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.2888205945491791
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./QUICKSTART.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 111
          }
        },
        "contents": "# üöÄ Quick Start Guide\n\n## Step 1: Install Dependencies (done)\n&#96;&#96;&#96;bash\nnpm install  # Already done ‚úÖ\n&#96;&#96;&#96;\n\n## Step 2: Set Up Database (2 minutes)\n\n### Create Neon Database\n1. Go to https://neon.tech\n2. Sign up/login\n3. Click \"Create Project\"\n4. Name: \"hiiiwav\"\n5. Copy connection string\n\n### Create &#96;.env.local&#96;\n&#96;&#96;&#96;bash\n# Create file\ncat &gt; .env.local &lt;&lt; 'EOF'\nDATABASE_URL=\"your-connection-string-here\"\nNEXTAUTH_SECRET=\"your-secret-here\"\nNEXTAUTH_URL=\"http://localhost:3000\"\nEOF\n&#96;&#96;&#96;\n\n### Generate Auth Secret\n&#96;&#96;&#96;bash\nopenssl rand -base64 32\n&#96;&#96;&#96;\n\nCopy the output and replace &#96;your-secret-here&#96; in &#96;.env.local&#96;.\n\n### Push Schema to Database\n&#96;&#96;&#96;bash\nnpm run db:push\n&#96;&#96;&#96;\n\n## Step 3: Import WordPress Content (1 minute)\n\n&#96;&#96;&#96;bash\nnpm run wp:import\n&#96;&#96;&#96;\n\nThis fetches all posts and pages from hiiiwav.org and imports them into your database.\n\n## Step 4: Create Admin User (30 seconds)\n\n### Generate Password Hash\n&#96;&#96;&#96;bash\nnode -e \"console.log(require('bcryptjs').hashSync('YourPassword123', 10))\"\n&#96;&#96;&#96;\n\n### Open Database Studio\n&#96;&#96;&#96;bash\nnpm run db:studio\n&#96;&#96;&#96;\n\n### Insert User\n1. Go to http://localhost:4983\n2. Click \"users\" table\n3. Click \"Add Row\"\n4. Fill in:\n   - email: &#96;admin@hiiiwav.org&#96;\n   - name: &#96;Admin&#96;\n   - role: &#96;admin&#96;\n   - password_hash: (paste the hash from step 1)\n5. Click \"Create\"\n\n## Step 5: Start Dev Server\n\n&#96;&#96;&#96;bash\nnpm run dev\n&#96;&#96;&#96;\n\nVisit http://localhost:3000\n\n## Step 6: Test Everything\n\n- **Homepage**: http://localhost:3000 ‚úÖ\n- **Blog**: http://localhost:3000/blog ‚úÖ\n- **Login**: http://localhost:3000/login ‚úÖ\n- **Admin**: http://localhost:3000/admin ‚úÖ\n\n---\n\n## Optional: Enable AI Chat Widget\n\n1. Get OpenAI API key from https://platform.openai.com\n2. Add to &#96;.env.local&#96;:\n&#96;&#96;&#96;bash\nOPENAI_API_KEY=\"sk-proj-...\"\n&#96;&#96;&#96;\n3. Uncomment in &#96;app/layout.tsx&#96;:\n&#96;&#96;&#96;tsx\nimport { ChatWidget } from \"@/components/ai/chat-widget\";\n// ...\n&lt;ChatWidget /&gt;\n&#96;&#96;&#96;\n4. Restart dev server\n\n---\n\n## Optional: Deploy to Vercel (5 minutes)\n\n&#96;&#96;&#96;bash\n# 1. Push to GitHub\ngit add .\ngit commit -m \"Initial migration\"\ngit push origin main",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# üöÄ Quick Start Guide",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "## Step 1: Install Dependencies (done)",
            "lineNumber": 3
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 4
          },
          {
            "text": "npm install  # Already done ‚úÖ",
            "lineNumber": 5
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "## Step 2: Set Up Database (2 minutes)",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "### Create Neon Database",
            "lineNumber": 10
          },
          {
            "text": "1. Go to https://neon.tech",
            "lineNumber": 11
          },
          {
            "text": "2. Sign up/login",
            "lineNumber": 12
          },
          {
            "text": "3. Click \"Create Project\"",
            "lineNumber": 13
          },
          {
            "text": "4. Name: \"hiiiwav\"",
            "lineNumber": 14
          },
          {
            "text": "5. Copy connection string",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "### Create &#96;.env.local&#96;",
            "lineNumber": 17
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 18
          },
          {
            "text": "# Create file",
            "lineNumber": 19
          },
          {
            "text": "cat &gt; .env.local &lt;&lt; 'EOF'",
            "lineNumber": 20
          },
          {
            "text": "DATABASE_URL=\"your-connection-string-here\"",
            "lineNumber": 21
          },
          {
            "text": "NEXTAUTH_SECRET=\"your-secret-here\"",
            "lineNumber": 22
          },
          {
            "text": "NEXTAUTH_URL=\"http://localhost:3000\"",
            "lineNumber": 23
          },
          {
            "text": "EOF",
            "lineNumber": 24
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "### Generate Auth Secret",
            "lineNumber": 27
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 28
          },
          {
            "text": "openssl rand -base64 32",
            "lineNumber": 29
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 30
          },
          {
            "lineNumber": 31
          },
          {
            "text": "Copy the output and replace &#96;your-secret-here&#96; in &#96;.env.local&#96;.",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "text": "### Push Schema to Database",
            "lineNumber": 34
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 35
          },
          {
            "text": "npm run db:push",
            "lineNumber": 36
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "## Step 3: Import WordPress Content (1 minute)",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 41
          },
          {
            "text": "npm run wp:import",
            "lineNumber": 42
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "This fetches all posts and pages from hiiiwav.org and imports them into your database.",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "## Step 4: Create Admin User (30 seconds)",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "### Generate Password Hash",
            "lineNumber": 49
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 50
          },
          {
            "text": "node -e \"console.log(require('bcryptjs').hashSync('YourPassword123', 10))\"",
            "lineNumber": 51
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "### Open Database Studio",
            "lineNumber": 54
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 55
          },
          {
            "text": "npm run db:studio",
            "lineNumber": 56
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 57
          },
          {
            "lineNumber": 58
          },
          {
            "text": "### Insert User",
            "lineNumber": 59
          },
          {
            "text": "1. Go to http://localhost:4983",
            "lineNumber": 60
          },
          {
            "text": "2. Click \"users\" table",
            "lineNumber": 61
          },
          {
            "text": "3. Click \"Add Row\"",
            "lineNumber": 62
          },
          {
            "text": "4. Fill in:",
            "lineNumber": 63
          },
          {
            "text": "   - email: &#96;admin@hiiiwav.org&#96;",
            "lineNumber": 64
          },
          {
            "text": "   - name: &#96;Admin&#96;",
            "lineNumber": 65
          },
          {
            "text": "   - role: &#96;admin&#96;",
            "lineNumber": 66
          },
          {
            "text": "   - password_hash: (paste the hash from step 1)",
            "lineNumber": 67
          },
          {
            "text": "5. Click \"Create\"",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "## Step 5: Start Dev Server",
            "lineNumber": 70
          },
          {
            "lineNumber": 71
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 72
          },
          {
            "text": "npm run dev",
            "lineNumber": 73
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 74
          },
          {
            "lineNumber": 75
          },
          {
            "text": "Visit http://localhost:3000",
            "lineNumber": 76
          },
          {
            "lineNumber": 77
          },
          {
            "text": "## Step 6: Test Everything",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "- **Homepage**: http://localhost:3000 ‚úÖ",
            "lineNumber": 80
          },
          {
            "text": "- **Blog**: http://localhost:3000/blog ‚úÖ",
            "lineNumber": 81
          },
          {
            "text": "- **Login**: http://localhost:3000/login ‚úÖ",
            "lineNumber": 82
          },
          {
            "text": "- **Admin**: http://localhost:3000/admin ‚úÖ",
            "lineNumber": 83
          },
          {
            "lineNumber": 84
          },
          {
            "text": "---",
            "lineNumber": 85
          },
          {
            "lineNumber": 86
          },
          {
            "text": "## Optional: Enable AI Chat Widget",
            "lineNumber": 87
          },
          {
            "lineNumber": 88
          },
          {
            "text": "1. Get OpenAI API key from https://platform.openai.com",
            "lineNumber": 89
          },
          {
            "text": "2. Add to &#96;.env.local&#96;:",
            "lineNumber": 90
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 91
          },
          {
            "text": "OPENAI_API_KEY=\"sk-proj-...\"",
            "lineNumber": 92
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 93
          },
          {
            "text": "3. Uncomment in &#96;app/layout.tsx&#96;:",
            "lineNumber": 94
          },
          {
            "text": "&#96;&#96;&#96;tsx",
            "lineNumber": 95
          },
          {
            "text": "import { ChatWidget } from \"@/components/ai/chat-widget\";",
            "lineNumber": 96
          },
          {
            "text": "// ...",
            "lineNumber": 97
          },
          {
            "text": "&lt;ChatWidget /&gt;",
            "lineNumber": 98
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 99
          },
          {
            "text": "4. Restart dev server",
            "lineNumber": 100
          },
          {
            "lineNumber": 101
          },
          {
            "text": "---",
            "lineNumber": 102
          },
          {
            "lineNumber": 103
          },
          {
            "text": "## Optional: Deploy to Vercel (5 minutes)",
            "lineNumber": 104
          },
          {
            "lineNumber": 105
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 106
          },
          {
            "text": "# 1. Push to GitHub",
            "lineNumber": 107
          },
          {
            "text": "git add .",
            "lineNumber": 108
          },
          {
            "text": "git commit -m \"Initial migration\"",
            "lineNumber": 109
          },
          {
            "text": "git push origin main",
            "lineNumber": 110
          }
        ]
      },
      "score": 0.28202998638153076
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/WORDPRESS_MIGRATION_PLAYBOOK.md",
        "range": {
          "startPosition": {
            "line": 70
          },
          "endPosition": {
            "line": 154
          }
        },
        "contents": "1. Go to https://supabase.com/dashboard\n2. Create new project\n3. Note the project ID and region\n\n**Project details:**\n- ID: &#96;pzoyeigicwgmmlngxowj&#96;\n- Region: &#96;us-west-2&#96;\n\n### 2.2 Configure Environment\n&#96;&#96;&#96;bash\n# .env.local\nDATABASE_URL=\"postgresql://postgres.[project-id]:[password]@aws-0-us-west-2.pooler.supabase.com:5432/postgres\"\n&#96;&#96;&#96;\n\n### 2.3 Push Schema\n&#96;&#96;&#96;bash\nnpm run db:push\n&#96;&#96;&#96;\n\n**Automation opportunity:** CLI tool that creates Supabase project and configures env vars automatically.\n\n---\n\n## Phase 3: Content Migration ‚úÖ\n\n### 3.1 Import Posts &amp; Pages\n&#96;&#96;&#96;bash\n# Fetches all content via WordPress REST API\nWP_BASE=https://your-site.com/wp-json/wp/v2 npm run wp:import\n&#96;&#96;&#96;\n\n**What gets imported:**\n- Posts ‚Üí &#96;posts&#96; table (title, content, excerpt, cover image URL, tags, SEO fields)\n- Pages ‚Üí &#96;pages&#96; table (title, content, SEO fields)\n\n**Content is converted:**\n- HTML ‚Üí Markdown (via Turndown)\n- Dates preserved\n- Slugs sanitized\n\n**Completed:** 21 posts, 29 pages imported\n\n### 3.2 Verify Import\n&#96;&#96;&#96;bash\nnpx tsx scripts/check-db-content.ts\n&#96;&#96;&#96;\n\n---\n\n## Phase 4: Image Migration ‚úÖ COMPLETE\n\n### 4.1 Create Storage Bucket\n1. Go to Supabase Dashboard ‚Üí Storage\n2. Create bucket named &#96;uploads&#96;\n3. Set to **Public**\n\n### 4.2 Add Storage Credentials\n&#96;&#96;&#96;bash\n# Add to .env.local\nNEXT_PUBLIC_SUPABASE_URL=\"https://[project-id].supabase.co\"\nSUPABASE_SERVICE_ROLE_KEY=\"your-service-role-key\"  # Needed for uploads (bypasses RLS)\n&#96;&#96;&#96;\n\n### 4.3 Run Image Migration\n&#96;&#96;&#96;bash\nnpm run wp:migrate-images\n&#96;&#96;&#96;\n\n**What this does:**\n1. Scans database for all &#96;hiiiwav.org/wp-content/uploads/&#96; URLs\n2. Finds corresponding files in local WordPress installation\n3. Uploads to Supabase Storage\n4. Updates all URLs in database\n\n**Completed: December 7, 2024**\n- Images uploaded: 356 ‚úÖ\n- Failed: 1 (special character in filename)\n- Posts updated: 20\n- Pages updated: 22\n- Storage URL: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/&#96;\n\n### 4.4 Automation Opportunity: Auto-Create Storage Bucket\n\n&#96;&#96;&#96;typescript",
        "signatures": {},
        "detailedLines": [
          {
            "text": "1. Go to https://supabase.com/dashboard",
            "lineNumber": 71
          },
          {
            "text": "2. Create new project",
            "lineNumber": 72
          },
          {
            "text": "3. Note the project ID and region",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "**Project details:**",
            "lineNumber": 75
          },
          {
            "text": "- ID: &#96;pzoyeigicwgmmlngxowj&#96;",
            "lineNumber": 76
          },
          {
            "text": "- Region: &#96;us-west-2&#96;",
            "lineNumber": 77
          },
          {
            "lineNumber": 78
          },
          {
            "text": "### 2.2 Configure Environment",
            "lineNumber": 79
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 80
          },
          {
            "text": "# .env.local",
            "lineNumber": 81
          },
          {
            "text": "DATABASE_URL=\"postgresql://postgres.[project-id]:[password]@aws-0-us-west-2.pooler.supabase.com:5432/postgres\"",
            "lineNumber": 82
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 83
          },
          {
            "lineNumber": 84
          },
          {
            "text": "### 2.3 Push Schema",
            "lineNumber": 85
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 86
          },
          {
            "text": "npm run db:push",
            "lineNumber": 87
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 88
          },
          {
            "lineNumber": 89
          },
          {
            "text": "**Automation opportunity:** CLI tool that creates Supabase project and configures env vars automatically.",
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "text": "---",
            "lineNumber": 92
          },
          {
            "lineNumber": 93
          },
          {
            "text": "## Phase 3: Content Migration ‚úÖ",
            "lineNumber": 94
          },
          {
            "lineNumber": 95
          },
          {
            "text": "### 3.1 Import Posts &amp; Pages",
            "lineNumber": 96
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 97
          },
          {
            "text": "# Fetches all content via WordPress REST API",
            "lineNumber": 98
          },
          {
            "text": "WP_BASE=https://your-site.com/wp-json/wp/v2 npm run wp:import",
            "lineNumber": 99
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 100
          },
          {
            "lineNumber": 101
          },
          {
            "text": "**What gets imported:**",
            "lineNumber": 102
          },
          {
            "text": "- Posts ‚Üí &#96;posts&#96; table (title, content, excerpt, cover image URL, tags, SEO fields)",
            "lineNumber": 103
          },
          {
            "text": "- Pages ‚Üí &#96;pages&#96; table (title, content, SEO fields)",
            "lineNumber": 104
          },
          {
            "lineNumber": 105
          },
          {
            "text": "**Content is converted:**",
            "lineNumber": 106
          },
          {
            "text": "- HTML ‚Üí Markdown (via Turndown)",
            "lineNumber": 107
          },
          {
            "text": "- Dates preserved",
            "lineNumber": 108
          },
          {
            "text": "- Slugs sanitized",
            "lineNumber": 109
          },
          {
            "lineNumber": 110
          },
          {
            "text": "**Completed:** 21 posts, 29 pages imported",
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "### 3.2 Verify Import",
            "lineNumber": 113
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 114
          },
          {
            "text": "npx tsx scripts/check-db-content.ts",
            "lineNumber": 115
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "---",
            "lineNumber": 118
          },
          {
            "lineNumber": 119
          },
          {
            "text": "## Phase 4: Image Migration ‚úÖ COMPLETE",
            "lineNumber": 120
          },
          {
            "lineNumber": 121
          },
          {
            "text": "### 4.1 Create Storage Bucket",
            "lineNumber": 122
          },
          {
            "text": "1. Go to Supabase Dashboard ‚Üí Storage",
            "lineNumber": 123
          },
          {
            "text": "2. Create bucket named &#96;uploads&#96;",
            "lineNumber": 124
          },
          {
            "text": "3. Set to **Public**",
            "lineNumber": 125
          },
          {
            "lineNumber": 126
          },
          {
            "text": "### 4.2 Add Storage Credentials",
            "lineNumber": 127
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 128
          },
          {
            "text": "# Add to .env.local",
            "lineNumber": 129
          },
          {
            "text": "NEXT_PUBLIC_SUPABASE_URL=\"https://[project-id].supabase.co\"",
            "lineNumber": 130
          },
          {
            "text": "SUPABASE_SERVICE_ROLE_KEY=\"your-service-role-key\"  # Needed for uploads (bypasses RLS)",
            "lineNumber": 131
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 132
          },
          {
            "lineNumber": 133
          },
          {
            "text": "### 4.3 Run Image Migration",
            "lineNumber": 134
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 135
          },
          {
            "text": "npm run wp:migrate-images",
            "lineNumber": 136
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 137
          },
          {
            "lineNumber": 138
          },
          {
            "text": "**What this does:**",
            "lineNumber": 139
          },
          {
            "text": "1. Scans database for all &#96;hiiiwav.org/wp-content/uploads/&#96; URLs",
            "lineNumber": 140
          },
          {
            "text": "2. Finds corresponding files in local WordPress installation",
            "lineNumber": 141
          },
          {
            "text": "3. Uploads to Supabase Storage",
            "lineNumber": 142
          },
          {
            "text": "4. Updates all URLs in database",
            "lineNumber": 143
          },
          {
            "lineNumber": 144
          },
          {
            "text": "**Completed: December 7, 2024**",
            "lineNumber": 145
          },
          {
            "text": "- Images uploaded: 356 ‚úÖ",
            "lineNumber": 146
          },
          {
            "text": "- Failed: 1 (special character in filename)",
            "lineNumber": 147
          },
          {
            "text": "- Posts updated: 20",
            "lineNumber": 148
          },
          {
            "text": "- Pages updated: 22",
            "lineNumber": 149
          },
          {
            "text": "- Storage URL: &#96;https://pzoyeigicwgmmlngxowj.supabase.co/storage/v1/object/public/uploads/&#96;",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "### 4.4 Automation Opportunity: Auto-Create Storage Bucket",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 154
          }
        ]
      },
      "score": 0.2750290632247925
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./scripts/migrate-images-to-supabase.ts",
        "range": {
          "startPosition": {
            "line": 164,
            "column": 1
          },
          "endPosition": {
            "line": 219,
            "column": 1
          }
        },
        "contents": "async function main() {\n  console.log('üöÄ Starting image migration to Supabase Storage\\n')\n  \n  // Dynamically import db modules after env is loaded\n  const dbModule = await import('../db')\n  const schemaModule = await import('../db/schema')\n  const drizzleModule = await import('drizzle-orm')\n  db = dbModule.db\n  posts = schemaModule.posts\n  pages = schemaModule.pages\n  eq = drizzleModule.eq\n  \n  console.log(&#96;üìÅ Local WordPress uploads: ${WP_UPLOADS_PATH}&#96;)\n  console.log(&#96;‚òÅÔ∏è  Supabase URL: ${SUPABASE_URL}&#96;)\n  console.log(&#96;ü™£ Bucket: ${BUCKET_NAME}\\n&#96;)\n  \n  // Extract all image URLs from database\n  console.log('üîç Extracting image URLs from database...')\n  const wpUrls = await extractImageUrls()\n  console.log(&#96;   Found ${wpUrls.size} unique images\\n&#96;)\n  \n  // Upload each image and build URL map\n  console.log('üì§ Uploading images to Supabase...')\n  const urlMap = new Map&lt;string, string&gt;()\n  let uploaded = 0\n  let failed = 0\n  \n  for (const wpUrl of wpUrls) {\n    const newUrl = await uploadImage(wpUrl)\n    if (newUrl) {\n      urlMap.set(wpUrl, newUrl)\n      uploaded++\n      console.log(&#96;  ‚úì [${uploaded}/${wpUrls.size}] ${path.basename(wpUrl)}&#96;)\n    } else {\n      failed++\n    }\n  }\n  \n  console.log(&#96;\\n‚úÖ Uploaded: ${uploaded}&#96;)\n  console.log(&#96;‚ùå Failed: ${failed}&#96;)\n  \n  // Update database with new URLs\n  if (urlMap.size &gt; 0) {\n    await updateDatabaseUrls(urlMap)\n  }\n  \n  console.log('\\nüéâ Migration complete!')\n  process.exit(0)\n}\n\nmain().catch(err =&gt; {\n  console.error('‚ùå Migration failed:', err)\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function main() {",
            "lineNumber": 167,
            "isSignature": true
          },
          {
            "text": "  console.log('üöÄ Starting image migration to Supabase Storage\\n')",
            "lineNumber": 168
          },
          {
            "text": "  ",
            "lineNumber": 169
          },
          {
            "text": "  // Dynamically import db modules after env is loaded",
            "lineNumber": 170
          },
          {
            "text": "  const dbModule = await import('../db')",
            "lineNumber": 171
          },
          {
            "text": "  const schemaModule = await import('../db/schema')",
            "lineNumber": 172
          },
          {
            "text": "  const drizzleModule = await import('drizzle-orm')",
            "lineNumber": 173
          },
          {
            "text": "  db = dbModule.db",
            "lineNumber": 174
          },
          {
            "text": "  posts = schemaModule.posts",
            "lineNumber": 175
          },
          {
            "text": "  pages = schemaModule.pages",
            "lineNumber": 176
          },
          {
            "text": "  eq = drizzleModule.eq",
            "lineNumber": 177
          },
          {
            "text": "  ",
            "lineNumber": 178
          },
          {
            "text": "  console.log(&#96;üìÅ Local WordPress uploads: ${WP_UPLOADS_PATH}&#96;)",
            "lineNumber": 179
          },
          {
            "text": "  console.log(&#96;‚òÅÔ∏è  Supabase URL: ${SUPABASE_URL}&#96;)",
            "lineNumber": 180
          },
          {
            "text": "  console.log(&#96;ü™£ Bucket: ${BUCKET_NAME}\\n&#96;)",
            "lineNumber": 181
          },
          {
            "text": "  ",
            "lineNumber": 182
          },
          {
            "text": "  // Extract all image URLs from database",
            "lineNumber": 183
          },
          {
            "text": "  console.log('üîç Extracting image URLs from database...')",
            "lineNumber": 184
          },
          {
            "text": "  const wpUrls = await extractImageUrls()",
            "lineNumber": 185
          },
          {
            "text": "  console.log(&#96;   Found ${wpUrls.size} unique images\\n&#96;)",
            "lineNumber": 186
          },
          {
            "text": "  ",
            "lineNumber": 187
          },
          {
            "text": "  // Upload each image and build URL map",
            "lineNumber": 188
          },
          {
            "text": "  console.log('üì§ Uploading images to Supabase...')",
            "lineNumber": 189
          },
          {
            "text": "  const urlMap = new Map&lt;string, string&gt;()",
            "lineNumber": 190
          },
          {
            "text": "  let uploaded = 0",
            "lineNumber": 191
          },
          {
            "text": "  let failed = 0",
            "lineNumber": 192
          },
          {
            "text": "  ",
            "lineNumber": 193
          },
          {
            "text": "  for (const wpUrl of wpUrls) {",
            "lineNumber": 194
          },
          {
            "text": "    const newUrl = await uploadImage(wpUrl)",
            "lineNumber": 195
          },
          {
            "text": "    if (newUrl) {",
            "lineNumber": 196
          },
          {
            "text": "      urlMap.set(wpUrl, newUrl)",
            "lineNumber": 197
          },
          {
            "text": "      uploaded++",
            "lineNumber": 198
          },
          {
            "text": "      console.log(&#96;  ‚úì [${uploaded}/${wpUrls.size}] ${path.basename(wpUrl)}&#96;)",
            "lineNumber": 199
          },
          {
            "text": "    } else {",
            "lineNumber": 200
          },
          {
            "text": "      failed++",
            "lineNumber": 201
          },
          {
            "text": "    }",
            "lineNumber": 202
          },
          {
            "text": "  }",
            "lineNumber": 203
          },
          {
            "text": "  ",
            "lineNumber": 204
          },
          {
            "text": "  console.log(&#96;\\n‚úÖ Uploaded: ${uploaded}&#96;)",
            "lineNumber": 205
          },
          {
            "text": "  console.log(&#96;‚ùå Failed: ${failed}&#96;)",
            "lineNumber": 206
          },
          {
            "text": "  ",
            "lineNumber": 207
          },
          {
            "text": "  // Update database with new URLs",
            "lineNumber": 208
          },
          {
            "text": "  if (urlMap.size &gt; 0) {",
            "lineNumber": 209
          },
          {
            "text": "    await updateDatabaseUrls(urlMap)",
            "lineNumber": 210
          },
          {
            "text": "  }",
            "lineNumber": 211
          },
          {
            "text": "  ",
            "lineNumber": 212
          },
          {
            "text": "  console.log('\\nüéâ Migration complete!')",
            "lineNumber": 213
          },
          {
            "text": "  process.exit(0)",
            "lineNumber": 214
          },
          {
            "text": "}",
            "lineNumber": 215,
            "isSignature": true
          },
          {
            "lineNumber": 216
          },
          {
            "text": "main().catch(err =&gt; {",
            "lineNumber": 217
          },
          {
            "text": "  console.error('‚ùå Migration failed:', err)",
            "lineNumber": 218
          },
          {
            "text": "}",
            "lineNumber": 220
          }
        ]
      },
      "score": 0.2685602009296417
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./.next/dev/server/chunks/ssr/[root-of-the-server]__b590eaa1._.js",
        "range": {
          "startPosition": {
            "line": 257,
            "column": 47
          },
          "endPosition": {
            "line": 305,
            "column": 1
          }
        },
        "contents": " ((__turbopack_context__) =&gt; {\n\"use strict\";\n\n__turbopack_context__.s([\n    \"db\",\n    ()=&gt;db\n]);\nvar __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$postgres$2d$js$2f$driver$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/node_modules/drizzle-orm/postgres-js/driver.js [app-rsc] (ecmascript)\");\nvar __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$postgres$2f$src$2f$index$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/node_modules/postgres/src/index.js [app-rsc] (ecmascript)\");\nvar __TURBOPACK__imported__module__$5b$project$5d2f$db$2f$schema$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/db/schema.ts [app-rsc] (ecmascript)\");\n;\n;\n;\nfunction getDb() {\n    if (!process.env.DATABASE_URL) {\n        throw new Error('DATABASE_URL is not set. Please add it to .env.local');\n    }\n    const client = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$postgres$2f$src$2f$index$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"default\"])(process.env.DATABASE_URL, {\n        connect_timeout: 60,\n        idle_timeout: 20,\n        max_lifetime: 60 * 30\n    });\n    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$postgres$2d$js$2f$driver$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"drizzle\"])(client, {\n        schema: __TURBOPACK__imported__module__$5b$project$5d2f$db$2f$schema$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__\n    });\n}\nconst db = getDb();\n}),\n\"[externals]/tty [external] (tty, cjs)\", ((__turbopack_context__, module, exports) =&gt; {\n\nconst mod = __turbopack_context__.x(\"tty\", () =&gt; require(\"tty\"));\n\nmodule.exports = mod;\n}),\n\"[externals]/node:path [external] (node:path, cjs)\", ((__turbopack_context__, module, exports) =&gt; {\n\nconst mod = __turbopack_context__.x(\"node:path\", () =&gt; require(\"node:path\"));\n\nmodule.exports = mod;\n}),\n\"[externals]/node:path [external] (node:path, cjs) &lt;export default as minpath&gt;\", ((__turbopack_context__) =&gt; {\n\"use strict\";\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": " ((__turbopack_context__) =&gt; {",
            "lineNumber": 258
          },
          {
            "text": "\"use strict\";",
            "lineNumber": 259
          },
          {
            "lineNumber": 260
          },
          {
            "text": "__turbopack_context__.s([",
            "lineNumber": 261
          },
          {
            "text": "    \"db\",",
            "lineNumber": 262
          },
          {
            "text": "    ()=&gt;db",
            "lineNumber": 263
          },
          {
            "text": "]);",
            "lineNumber": 264
          },
          {
            "text": "var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$postgres$2d$js$2f$driver$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/node_modules/drizzle-orm/postgres-js/driver.js [app-rsc] (ecmascript)\");",
            "lineNumber": 265
          },
          {
            "text": "var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$postgres$2f$src$2f$index$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/node_modules/postgres/src/index.js [app-rsc] (ecmascript)\");",
            "lineNumber": 266
          },
          {
            "text": "var __TURBOPACK__imported__module__$5b$project$5d2f$db$2f$schema$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_context__.i(\"[project]/db/schema.ts [app-rsc] (ecmascript)\");",
            "lineNumber": 267
          },
          {
            "text": ";",
            "lineNumber": 268
          },
          {
            "text": ";",
            "lineNumber": 269
          },
          {
            "text": ";",
            "lineNumber": 270
          },
          {
            "text": "function getDb() {",
            "lineNumber": 271
          },
          {
            "text": "    if (!process.env.DATABASE_URL) {",
            "lineNumber": 272
          },
          {
            "text": "        throw new Error('DATABASE_URL is not set. Please add it to .env.local');",
            "lineNumber": 273
          },
          {
            "text": "    }",
            "lineNumber": 274
          },
          {
            "text": "    const client = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$postgres$2f$src$2f$index$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"default\"])(process.env.DATABASE_URL, {",
            "lineNumber": 275
          },
          {
            "text": "        connect_timeout: 60,",
            "lineNumber": 276
          },
          {
            "text": "        idle_timeout: 20,",
            "lineNumber": 277
          },
          {
            "text": "        max_lifetime: 60 * 30",
            "lineNumber": 278
          },
          {
            "text": "    });",
            "lineNumber": 279
          },
          {
            "text": "    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$drizzle$2d$orm$2f$postgres$2d$js$2f$driver$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__[\"drizzle\"])(client, {",
            "lineNumber": 280
          },
          {
            "text": "        schema: __TURBOPACK__imported__module__$5b$project$5d2f$db$2f$schema$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__",
            "lineNumber": 281
          },
          {
            "text": "    });",
            "lineNumber": 282
          },
          {
            "text": "}",
            "lineNumber": 283
          },
          {
            "text": "const db = getDb();",
            "lineNumber": 284
          },
          {
            "text": "}),",
            "lineNumber": 285
          },
          {
            "text": "\"[externals]/tty [external] (tty, cjs)\", ((__turbopack_context__, module, exports) =&gt; {",
            "lineNumber": 286
          },
          {
            "lineNumber": 287
          },
          {
            "text": "const mod = __turbopack_context__.x(\"tty\", () =&gt; require(\"tty\"));",
            "lineNumber": 288
          },
          {
            "lineNumber": 289
          },
          {
            "text": "module.exports = mod;",
            "lineNumber": 290
          },
          {
            "text": "}),",
            "lineNumber": 291
          },
          {
            "text": "\"[externals]/node:path [external] (node:path, cjs)\", ((__turbopack_context__, module, exports) =&gt; {",
            "lineNumber": 292
          },
          {
            "lineNumber": 293
          },
          {
            "text": "const mod = __turbopack_context__.x(\"node:path\", () =&gt; require(\"node:path\"));",
            "lineNumber": 294
          },
          {
            "lineNumber": 295
          },
          {
            "text": "module.exports = mod;",
            "lineNumber": 296
          },
          {
            "text": "}),",
            "lineNumber": 297
          },
          {
            "text": "\"[externals]/node:path [external] (node:path, cjs) &lt;export default as minpath&gt;\", ((__turbopack_context__) =&gt; {",
            "lineNumber": 298
          },
          {
            "text": "\"use strict\";",
            "lineNumber": 299
          },
          {
            "text": "}",
            "lineNumber": 306
          }
        ]
      },
      "score": 0.26115360856056213
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/wordpress_to_next.js_migration_plan.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 62
          }
        },
        "contents": "# WordPress to Next.js Migration Plan\n## HIIIWAV.org ‚Üí Dynamic Next.js App with AI Features\n\n**Last Updated:** November 15, 2025  \n**Domain:** hiiiwav.org  \n**Goal:** Migrate from WordPress to a modern, AI-powered Next.js application that's easy to iterate on with Cursor/Lovable\n\n---\n\n## Architecture Decision\n\n### ‚ùå NOT Using (and Why)\n- **Static MDX/Contentlayer** - Too limiting for interactive features and AI integration\n- **Headless WordPress** - Vendor lock-in, can't easily add custom AI features, monthly costs\n- **External CMS (Sanity/Contentful)** - Vendor lock-in, harder to iterate with Cursor, unnecessary complexity\n\n### ‚úÖ USING: Dynamic Next.js + Postgres + Custom Admin\n**Why:** Full control, type-safe, Cursor/Lovable can iterate fast, integrate AI anywhere, zero vendor lock-in, cheap to run\n\n---\n\n## Tech Stack\n\n### Core Framework\n- **Next.js 15** (App Router, React Server Components)\n- **React 19**\n- **TypeScript** (strict mode)\n- **Tailwind CSS** + **shadcn/ui** (copy-paste components, full control)\n\n### Database &amp; ORM\n- **Postgres** (Neon free tier or Vercel Postgres)\n- **Drizzle ORM** (type-safe, migrations in code, excellent Cursor autocomplete)\n\n### Authentication\n- **NextAuth.js v5 (Auth.js)** for admin login\n- Support for email/password + OAuth providers\n\n### Content Management\n- **Custom-built admin dashboard** (no external CMS)\n- **TipTap** or **Lexical** for rich text editing (React-based, extensible)\n- **React Hook Form** + **Zod** for type-safe forms\n\n### AI Features\n- **Vercel AI SDK** (streaming, RSC-compatible)\n- **OpenAI** (GPT-4o) or **Anthropic** (Claude)\n- Use cases:\n  - Chat widget (context-aware assistant)\n  - Content generation (meta descriptions, summaries)\n  - AI-powered search\n  - Content suggestions/autocomplete in editor\n\n### Media Storage\n- **Uploadthing** or **Vercel Blob** (S3-compatible)\n- Direct client uploads\n- One-time migration of WordPress media\n\n### Deployment\n- **Vercel** (serverless + edge runtime)\n- Preview branches for staging\n- Environment variables for secrets\n\n### Additional Tools",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# WordPress to Next.js Migration Plan",
            "lineNumber": 1
          },
          {
            "text": "## HIIIWAV.org ‚Üí Dynamic Next.js App with AI Features",
            "lineNumber": 2
          },
          {
            "lineNumber": 3
          },
          {
            "text": "**Last Updated:** November 15, 2025  ",
            "lineNumber": 4
          },
          {
            "text": "**Domain:** hiiiwav.org  ",
            "lineNumber": 5
          },
          {
            "text": "**Goal:** Migrate from WordPress to a modern, AI-powered Next.js application that's easy to iterate on with Cursor/Lovable",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "---",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "## Architecture Decision",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "### ‚ùå NOT Using (and Why)",
            "lineNumber": 12
          },
          {
            "text": "- **Static MDX/Contentlayer** - Too limiting for interactive features and AI integration",
            "lineNumber": 13
          },
          {
            "text": "- **Headless WordPress** - Vendor lock-in, can't easily add custom AI features, monthly costs",
            "lineNumber": 14
          },
          {
            "text": "- **External CMS (Sanity/Contentful)** - Vendor lock-in, harder to iterate with Cursor, unnecessary complexity",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "### ‚úÖ USING: Dynamic Next.js + Postgres + Custom Admin",
            "lineNumber": 17
          },
          {
            "text": "**Why:** Full control, type-safe, Cursor/Lovable can iterate fast, integrate AI anywhere, zero vendor lock-in, cheap to run",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "---",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "text": "## Tech Stack",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "### Core Framework",
            "lineNumber": 24
          },
          {
            "text": "- **Next.js 15** (App Router, React Server Components)",
            "lineNumber": 25
          },
          {
            "text": "- **React 19**",
            "lineNumber": 26
          },
          {
            "text": "- **TypeScript** (strict mode)",
            "lineNumber": 27
          },
          {
            "text": "- **Tailwind CSS** + **shadcn/ui** (copy-paste components, full control)",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "### Database &amp; ORM",
            "lineNumber": 30
          },
          {
            "text": "- **Postgres** (Neon free tier or Vercel Postgres)",
            "lineNumber": 31
          },
          {
            "text": "- **Drizzle ORM** (type-safe, migrations in code, excellent Cursor autocomplete)",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "text": "### Authentication",
            "lineNumber": 34
          },
          {
            "text": "- **NextAuth.js v5 (Auth.js)** for admin login",
            "lineNumber": 35
          },
          {
            "text": "- Support for email/password + OAuth providers",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "### Content Management",
            "lineNumber": 38
          },
          {
            "text": "- **Custom-built admin dashboard** (no external CMS)",
            "lineNumber": 39
          },
          {
            "text": "- **TipTap** or **Lexical** for rich text editing (React-based, extensible)",
            "lineNumber": 40
          },
          {
            "text": "- **React Hook Form** + **Zod** for type-safe forms",
            "lineNumber": 41
          },
          {
            "lineNumber": 42
          },
          {
            "text": "### AI Features",
            "lineNumber": 43
          },
          {
            "text": "- **Vercel AI SDK** (streaming, RSC-compatible)",
            "lineNumber": 44
          },
          {
            "text": "- **OpenAI** (GPT-4o) or **Anthropic** (Claude)",
            "lineNumber": 45
          },
          {
            "text": "- Use cases:",
            "lineNumber": 46
          },
          {
            "text": "  - Chat widget (context-aware assistant)",
            "lineNumber": 47
          },
          {
            "text": "  - Content generation (meta descriptions, summaries)",
            "lineNumber": 48
          },
          {
            "text": "  - AI-powered search",
            "lineNumber": 49
          },
          {
            "text": "  - Content suggestions/autocomplete in editor",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "### Media Storage",
            "lineNumber": 52
          },
          {
            "text": "- **Uploadthing** or **Vercel Blob** (S3-compatible)",
            "lineNumber": 53
          },
          {
            "text": "- Direct client uploads",
            "lineNumber": 54
          },
          {
            "text": "- One-time migration of WordPress media",
            "lineNumber": 55
          },
          {
            "lineNumber": 56
          },
          {
            "text": "### Deployment",
            "lineNumber": 57
          },
          {
            "text": "- **Vercel** (serverless + edge runtime)",
            "lineNumber": 58
          },
          {
            "text": "- Preview branches for staging",
            "lineNumber": 59
          },
          {
            "text": "- Environment variables for secrets",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "### Additional Tools",
            "lineNumber": 62
          }
        ]
      },
      "score": 0.2598051428794861
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/wordpress_to_next.js_migration_plan.md",
        "range": {
          "startPosition": {
            "line": 167
          },
          "endPosition": {
            "line": 232
          }
        },
        "contents": "‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ post-list.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ ai/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chat-widget.tsx    # Floating chat bubble\n‚îÇ   ‚îú‚îÄ‚îÄ site-header.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ site-footer.tsx\n‚îÇ   ‚îî‚îÄ‚îÄ seo-head.tsx\n‚îú‚îÄ‚îÄ db/\n‚îÇ   ‚îú‚îÄ‚îÄ index.ts               # Drizzle client\n‚îÇ   ‚îú‚îÄ‚îÄ schema.ts              # Tables\n‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # SQL migrations\n‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îú‚îÄ‚îÄ auth.ts                # NextAuth config\n‚îÇ   ‚îú‚îÄ‚îÄ seo.ts                 # SEO helpers\n‚îÇ   ‚îî‚îÄ‚îÄ utils.ts\n‚îú‚îÄ‚îÄ scripts/\n‚îÇ   ‚îú‚îÄ‚îÄ import-wp-to-db.ts     # One-time WP migration\n‚îÇ   ‚îî‚îÄ‚îÄ download-wp-media.ts   # Download all WP uploads\n‚îú‚îÄ‚îÄ public/\n‚îÇ   ‚îî‚îÄ‚îÄ uploads/               # Migrated media (or use Blob)\n‚îú‚îÄ‚îÄ docs/\n‚îÇ   ‚îî‚îÄ‚îÄ wordpress_to_next.js_migration_plan.md  # This file\n‚îú‚îÄ‚îÄ drizzle.config.ts\n‚îú‚îÄ‚îÄ next.config.ts\n‚îú‚îÄ‚îÄ tailwind.config.ts\n‚îú‚îÄ‚îÄ tsconfig.json\n‚îî‚îÄ‚îÄ package.json\n&#96;&#96;&#96;\n\n---\n\n## Migration Strategy\n\n### Phase 1: Foundation (Week 1)\n**Status:** Pending\n\n1. **Scaffold Next.js project**\n   &#96;&#96;&#96;bash\n   npx create-next-app@latest . --ts --app --tailwind --eslint --src-dir=false --import-alias \"@/*\"\n   &#96;&#96;&#96;\n\n2. **Install dependencies**\n   &#96;&#96;&#96;bash\n   pnpm add drizzle-orm postgres @neondatabase/serverless\n   pnpm add next-auth@beta zod react-hook-form @hookform/resolvers\n   pnpm add @tiptap/react @tiptap/starter-kit\n   pnpm add ai @ai-sdk/openai @ai-sdk/anthropic\n   pnpm add uploadthing @uploadthing/react\n   pnpm add next-seo next-sitemap\n   pnpm add -D drizzle-kit tsx @types/node\n   &#96;&#96;&#96;\n\n3. **Set up Drizzle + Postgres**\n   - Create Neon database\n   - Configure &#96;drizzle.config.ts&#96;\n   - Create schema in &#96;db/schema.ts&#96;\n   - Run migrations: &#96;pnpm drizzle-kit push&#96;\n\n4. **Set up NextAuth**\n   - Configure providers (email/password, Google OAuth)\n   - Add session middleware\n   - Create protected admin routes\n\n5. **Add shadcn/ui components**\n   &#96;&#96;&#96;bash\n   pnpm dlx shadcn-ui@latest init",
        "signatures": {},
        "detailedLines": [
          {
            "text": "‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ post-list.tsx",
            "lineNumber": 168
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ ai/",
            "lineNumber": 169
          },
          {
            "text": "‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chat-widget.tsx    # Floating chat bubble",
            "lineNumber": 170
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ site-header.tsx",
            "lineNumber": 171
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ site-footer.tsx",
            "lineNumber": 172
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ seo-head.tsx",
            "lineNumber": 173
          },
          {
            "text": "‚îú‚îÄ‚îÄ db/",
            "lineNumber": 174
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ index.ts               # Drizzle client",
            "lineNumber": 175
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ schema.ts              # Tables",
            "lineNumber": 176
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # SQL migrations",
            "lineNumber": 177
          },
          {
            "text": "‚îú‚îÄ‚îÄ lib/",
            "lineNumber": 178
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ auth.ts                # NextAuth config",
            "lineNumber": 179
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ seo.ts                 # SEO helpers",
            "lineNumber": 180
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ utils.ts",
            "lineNumber": 181
          },
          {
            "text": "‚îú‚îÄ‚îÄ scripts/",
            "lineNumber": 182
          },
          {
            "text": "‚îÇ   ‚îú‚îÄ‚îÄ import-wp-to-db.ts     # One-time WP migration",
            "lineNumber": 183
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ download-wp-media.ts   # Download all WP uploads",
            "lineNumber": 184
          },
          {
            "text": "‚îú‚îÄ‚îÄ public/",
            "lineNumber": 185
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ uploads/               # Migrated media (or use Blob)",
            "lineNumber": 186
          },
          {
            "text": "‚îú‚îÄ‚îÄ docs/",
            "lineNumber": 187
          },
          {
            "text": "‚îÇ   ‚îî‚îÄ‚îÄ wordpress_to_next.js_migration_plan.md  # This file",
            "lineNumber": 188
          },
          {
            "text": "‚îú‚îÄ‚îÄ drizzle.config.ts",
            "lineNumber": 189
          },
          {
            "text": "‚îú‚îÄ‚îÄ next.config.ts",
            "lineNumber": 190
          },
          {
            "text": "‚îú‚îÄ‚îÄ tailwind.config.ts",
            "lineNumber": 191
          },
          {
            "text": "‚îú‚îÄ‚îÄ tsconfig.json",
            "lineNumber": 192
          },
          {
            "text": "‚îî‚îÄ‚îÄ package.json",
            "lineNumber": 193
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 194
          },
          {
            "lineNumber": 195
          },
          {
            "text": "---",
            "lineNumber": 196
          },
          {
            "lineNumber": 197
          },
          {
            "text": "## Migration Strategy",
            "lineNumber": 198
          },
          {
            "lineNumber": 199
          },
          {
            "text": "### Phase 1: Foundation (Week 1)",
            "lineNumber": 200
          },
          {
            "text": "**Status:** Pending",
            "lineNumber": 201
          },
          {
            "lineNumber": 202
          },
          {
            "text": "1. **Scaffold Next.js project**",
            "lineNumber": 203
          },
          {
            "text": "   &#96;&#96;&#96;bash",
            "lineNumber": 204
          },
          {
            "text": "   npx create-next-app@latest . --ts --app --tailwind --eslint --src-dir=false --import-alias \"@/*\"",
            "lineNumber": 205
          },
          {
            "text": "   &#96;&#96;&#96;",
            "lineNumber": 206
          },
          {
            "lineNumber": 207
          },
          {
            "text": "2. **Install dependencies**",
            "lineNumber": 208
          },
          {
            "text": "   &#96;&#96;&#96;bash",
            "lineNumber": 209
          },
          {
            "text": "   pnpm add drizzle-orm postgres @neondatabase/serverless",
            "lineNumber": 210
          },
          {
            "text": "   pnpm add next-auth@beta zod react-hook-form @hookform/resolvers",
            "lineNumber": 211
          },
          {
            "text": "   pnpm add @tiptap/react @tiptap/starter-kit",
            "lineNumber": 212
          },
          {
            "text": "   pnpm add ai @ai-sdk/openai @ai-sdk/anthropic",
            "lineNumber": 213
          },
          {
            "text": "   pnpm add uploadthing @uploadthing/react",
            "lineNumber": 214
          },
          {
            "text": "   pnpm add next-seo next-sitemap",
            "lineNumber": 215
          },
          {
            "text": "   pnpm add -D drizzle-kit tsx @types/node",
            "lineNumber": 216
          },
          {
            "text": "   &#96;&#96;&#96;",
            "lineNumber": 217
          },
          {
            "lineNumber": 218
          },
          {
            "text": "3. **Set up Drizzle + Postgres**",
            "lineNumber": 219
          },
          {
            "text": "   - Create Neon database",
            "lineNumber": 220
          },
          {
            "text": "   - Configure &#96;drizzle.config.ts&#96;",
            "lineNumber": 221
          },
          {
            "text": "   - Create schema in &#96;db/schema.ts&#96;",
            "lineNumber": 222
          },
          {
            "text": "   - Run migrations: &#96;pnpm drizzle-kit push&#96;",
            "lineNumber": 223
          },
          {
            "lineNumber": 224
          },
          {
            "text": "4. **Set up NextAuth**",
            "lineNumber": 225
          },
          {
            "text": "   - Configure providers (email/password, Google OAuth)",
            "lineNumber": 226
          },
          {
            "text": "   - Add session middleware",
            "lineNumber": 227
          },
          {
            "text": "   - Create protected admin routes",
            "lineNumber": 228
          },
          {
            "lineNumber": 229
          },
          {
            "text": "5. **Add shadcn/ui components**",
            "lineNumber": 230
          },
          {
            "text": "   &#96;&#96;&#96;bash",
            "lineNumber": 231
          },
          {
            "text": "   pnpm dlx shadcn-ui@latest init",
            "lineNumber": 232
          }
        ]
      },
      "score": 0.24859583377838135
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./drizzle.config.ts",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 14
          }
        },
        "contents": "import type { Config } from 'drizzle-kit'\nimport { config } from 'dotenv'\nimport { resolve } from 'path'\n\n// Load .env.local file\nconfig({ path: resolve(process.cwd(), '.env.local') })\n\nexport default {\n  schema: './db/schema.ts',\n  out: './db/migrations',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import type { Config } from 'drizzle-kit'",
            "lineNumber": 1
          },
          {
            "text": "import { config } from 'dotenv'",
            "lineNumber": 2
          },
          {
            "text": "import { resolve } from 'path'",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "// Load .env.local file",
            "lineNumber": 5
          },
          {
            "text": "config({ path: resolve(process.cwd(), '.env.local') })",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "export default {",
            "lineNumber": 8
          },
          {
            "text": "  schema: './db/schema.ts',",
            "lineNumber": 9
          },
          {
            "text": "  out: './db/migrations',",
            "lineNumber": 10
          }
        ]
      },
      "score": 0.24498963356018066
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/dev-studio-README.md",
        "range": {
          "startPosition": {
            "line": 143
          },
          "endPosition": {
            "line": 218
          }
        },
        "contents": "2. Import to Vercel (uses existing account)\n3. Add environment variables in Vercel dashboard:\n   - &#96;NEXT_PUBLIC_SUPABASE_URL&#96;\n   - &#96;NEXT_PUBLIC_SUPABASE_ANON_KEY&#96;\n   - &#96;SUPABASE_SERVICE_ROLE_KEY&#96;\n4. Every push to &#96;main&#96; ‚Üí production deploy\n5. Every PR/branch ‚Üí preview deploy with unique URL\n\n---\n\n## Collaboration Workflow\n\n### Sharing Draft Sites with Collaborators\n\nVercel preview deployments are perfect for design/dev collaboration:\n\n1. **Create a branch** for the feature/version\n2. **Push to GitHub** ‚Üí Vercel auto-deploys to &#96;your-project-abc123.vercel.app&#96;\n3. **Share the preview URL** with designer/developer\n4. Each new push updates the same preview URL\n5. Different branches = different preview URLs for comparing versions\n\n### Optional: Password Protection\n\nFor sensitive drafts, add basic auth middleware:\n\n&#96;&#96;&#96;ts\n// src/middleware.ts\nimport { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\nexport function middleware(request: NextRequest) {\n  const authHeader = request.headers.get('authorization');\n  \n  if (!authHeader) {\n    return new NextResponse('Authentication required', {\n      status: 401,\n      headers: { 'WWW-Authenticate': 'Basic realm=\"Secure Area\"' },\n    });\n  }\n\n  const [, credentials] = authHeader.split(' ');\n  const [user, pass] = atob(credentials).split(':');\n\n  if (user === process.env.PREVIEW_USER &amp;&amp; pass === process.env.PREVIEW_PASS) {\n    return NextResponse.next();\n  }\n\n  return new NextResponse('Invalid credentials', { status: 401 });\n}\n\nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],\n};\n&#96;&#96;&#96;\n\n---\n\n## Existing Schemas\n\n| Schema | Purpose | Status |\n|--------|---------|--------|\n| &#96;core&#96; | Shared users, settings | Planned |\n| &#96;chatbot_app&#96; | Chatbot sessions &amp; messages | Planned |\n| &#96;crm_agent&#96; | CRM contacts &amp; interactions | Planned |\n| &#96;sites&#96; | Website projects | Planned |\n| &#96;experiments&#96; | Quick prototypes | Planned |\n\n---\n\n## Project Checklist\n\nWhen creating a new project using Dev Studio:\n\n- [ ] Create new GitHub repo",
        "signatures": {},
        "detailedLines": [
          {
            "text": "2. Import to Vercel (uses existing account)",
            "lineNumber": 144
          },
          {
            "text": "3. Add environment variables in Vercel dashboard:",
            "lineNumber": 145
          },
          {
            "text": "   - &#96;NEXT_PUBLIC_SUPABASE_URL&#96;",
            "lineNumber": 146
          },
          {
            "text": "   - &#96;NEXT_PUBLIC_SUPABASE_ANON_KEY&#96;",
            "lineNumber": 147
          },
          {
            "text": "   - &#96;SUPABASE_SERVICE_ROLE_KEY&#96;",
            "lineNumber": 148
          },
          {
            "text": "4. Every push to &#96;main&#96; ‚Üí production deploy",
            "lineNumber": 149
          },
          {
            "text": "5. Every PR/branch ‚Üí preview deploy with unique URL",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "---",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "## Collaboration Workflow",
            "lineNumber": 154
          },
          {
            "lineNumber": 155
          },
          {
            "text": "### Sharing Draft Sites with Collaborators",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "Vercel preview deployments are perfect for design/dev collaboration:",
            "lineNumber": 158
          },
          {
            "lineNumber": 159
          },
          {
            "text": "1. **Create a branch** for the feature/version",
            "lineNumber": 160
          },
          {
            "text": "2. **Push to GitHub** ‚Üí Vercel auto-deploys to &#96;your-project-abc123.vercel.app&#96;",
            "lineNumber": 161
          },
          {
            "text": "3. **Share the preview URL** with designer/developer",
            "lineNumber": 162
          },
          {
            "text": "4. Each new push updates the same preview URL",
            "lineNumber": 163
          },
          {
            "text": "5. Different branches = different preview URLs for comparing versions",
            "lineNumber": 164
          },
          {
            "lineNumber": 165
          },
          {
            "text": "### Optional: Password Protection",
            "lineNumber": 166
          },
          {
            "lineNumber": 167
          },
          {
            "text": "For sensitive drafts, add basic auth middleware:",
            "lineNumber": 168
          },
          {
            "lineNumber": 169
          },
          {
            "text": "&#96;&#96;&#96;ts",
            "lineNumber": 170
          },
          {
            "text": "// src/middleware.ts",
            "lineNumber": 171
          },
          {
            "text": "import { NextResponse } from 'next/server';",
            "lineNumber": 172
          },
          {
            "text": "import type { NextRequest } from 'next/server';",
            "lineNumber": 173
          },
          {
            "lineNumber": 174
          },
          {
            "text": "export function middleware(request: NextRequest) {",
            "lineNumber": 175
          },
          {
            "text": "  const authHeader = request.headers.get('authorization');",
            "lineNumber": 176
          },
          {
            "text": "  ",
            "lineNumber": 177
          },
          {
            "text": "  if (!authHeader) {",
            "lineNumber": 178
          },
          {
            "text": "    return new NextResponse('Authentication required', {",
            "lineNumber": 179
          },
          {
            "text": "      status: 401,",
            "lineNumber": 180
          },
          {
            "text": "      headers: { 'WWW-Authenticate': 'Basic realm=\"Secure Area\"' },",
            "lineNumber": 181
          },
          {
            "text": "    });",
            "lineNumber": 182
          },
          {
            "text": "  }",
            "lineNumber": 183
          },
          {
            "lineNumber": 184
          },
          {
            "text": "  const [, credentials] = authHeader.split(' ');",
            "lineNumber": 185
          },
          {
            "text": "  const [user, pass] = atob(credentials).split(':');",
            "lineNumber": 186
          },
          {
            "lineNumber": 187
          },
          {
            "text": "  if (user === process.env.PREVIEW_USER &amp;&amp; pass === process.env.PREVIEW_PASS) {",
            "lineNumber": 188
          },
          {
            "text": "    return NextResponse.next();",
            "lineNumber": 189
          },
          {
            "text": "  }",
            "lineNumber": 190
          },
          {
            "lineNumber": 191
          },
          {
            "text": "  return new NextResponse('Invalid credentials', { status: 401 });",
            "lineNumber": 192
          },
          {
            "text": "}",
            "lineNumber": 193
          },
          {
            "lineNumber": 194
          },
          {
            "text": "export const config = {",
            "lineNumber": 195
          },
          {
            "text": "  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],",
            "lineNumber": 196
          },
          {
            "text": "};",
            "lineNumber": 197
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 198
          },
          {
            "lineNumber": 199
          },
          {
            "text": "---",
            "lineNumber": 200
          },
          {
            "lineNumber": 201
          },
          {
            "text": "## Existing Schemas",
            "lineNumber": 202
          },
          {
            "lineNumber": 203
          },
          {
            "text": "| Schema | Purpose | Status |",
            "lineNumber": 204
          },
          {
            "text": "|--------|---------|--------|",
            "lineNumber": 205
          },
          {
            "text": "| &#96;core&#96; | Shared users, settings | Planned |",
            "lineNumber": 206
          },
          {
            "text": "| &#96;chatbot_app&#96; | Chatbot sessions &amp; messages | Planned |",
            "lineNumber": 207
          },
          {
            "text": "| &#96;crm_agent&#96; | CRM contacts &amp; interactions | Planned |",
            "lineNumber": 208
          },
          {
            "text": "| &#96;sites&#96; | Website projects | Planned |",
            "lineNumber": 209
          },
          {
            "text": "| &#96;experiments&#96; | Quick prototypes | Planned |",
            "lineNumber": 210
          },
          {
            "lineNumber": 211
          },
          {
            "text": "---",
            "lineNumber": 212
          },
          {
            "lineNumber": 213
          },
          {
            "text": "## Project Checklist",
            "lineNumber": 214
          },
          {
            "lineNumber": 215
          },
          {
            "text": "When creating a new project using Dev Studio:",
            "lineNumber": 216
          },
          {
            "lineNumber": 217
          },
          {
            "text": "- [ ] Create new GitHub repo",
            "lineNumber": 218
          }
        ]
      },
      "score": 0.2444894015789032
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./README.md",
        "range": {
          "startPosition": {
            "line": 82
          },
          "endPosition": {
            "line": 131
          }
        },
        "contents": "‚îî‚îÄ‚îÄ docs/                  # Documentation\n&#96;&#96;&#96;\n\n## Key Features\n\n- ‚úÖ Modern Next.js 15 with App Router\n- ‚úÖ Type-safe database with Drizzle ORM\n- ‚úÖ Rich text editor (TipTap)\n- ‚úÖ AI chat widget (Vercel AI SDK)\n- ‚úÖ SEO-optimized (next-seo, sitemap)\n- ‚úÖ Admin dashboard for content management\n- ‚úÖ One-time WordPress import script\n\n## Scripts\n\n- &#96;npm run dev&#96; - Start development server\n- &#96;npm run build&#96; - Build for production\n- &#96;npm run start&#96; - Start production server\n- &#96;npm run db:push&#96; - Push schema to database\n- &#96;npm run db:studio&#96; - Open Drizzle Studio\n- &#96;npm run wp:import&#96; - Import WordPress content\n\n## Environment Variables\n\nSee &#96;.env.local.example&#96; for required variables:\n\n- &#96;DATABASE_URL&#96; - Postgres connection string\n- &#96;NEXTAUTH_SECRET&#96; - Auth secret (generate with &#96;openssl rand -base64 32&#96;)\n- &#96;OPENAI_API_KEY&#96; - For AI features\n- &#96;NEXTAUTH_URL&#96; - Site URL (http://localhost:3000 in dev)\n\n## Deployment\n\n### Deploy to Vercel\n\n1. Push code to GitHub\n2. Import project in Vercel\n3. Add environment variables\n4. Deploy!\n\nVercel will auto-detect Next.js and configure everything.\n\n## Documentation\n\nSee &#96;docs/wordpress_to_next.js_migration_plan.md&#96; for the full migration plan.\n\n## License\n\nPrivate",
        "signatures": {},
        "detailedLines": [
          {
            "text": "‚îî‚îÄ‚îÄ docs/                  # Documentation",
            "lineNumber": 83
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 84
          },
          {
            "lineNumber": 85
          },
          {
            "text": "## Key Features",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "- ‚úÖ Modern Next.js 15 with App Router",
            "lineNumber": 88
          },
          {
            "text": "- ‚úÖ Type-safe database with Drizzle ORM",
            "lineNumber": 89
          },
          {
            "text": "- ‚úÖ Rich text editor (TipTap)",
            "lineNumber": 90
          },
          {
            "text": "- ‚úÖ AI chat widget (Vercel AI SDK)",
            "lineNumber": 91
          },
          {
            "text": "- ‚úÖ SEO-optimized (next-seo, sitemap)",
            "lineNumber": 92
          },
          {
            "text": "- ‚úÖ Admin dashboard for content management",
            "lineNumber": 93
          },
          {
            "text": "- ‚úÖ One-time WordPress import script",
            "lineNumber": 94
          },
          {
            "lineNumber": 95
          },
          {
            "text": "## Scripts",
            "lineNumber": 96
          },
          {
            "lineNumber": 97
          },
          {
            "text": "- &#96;npm run dev&#96; - Start development server",
            "lineNumber": 98
          },
          {
            "text": "- &#96;npm run build&#96; - Build for production",
            "lineNumber": 99
          },
          {
            "text": "- &#96;npm run start&#96; - Start production server",
            "lineNumber": 100
          },
          {
            "text": "- &#96;npm run db:push&#96; - Push schema to database",
            "lineNumber": 101
          },
          {
            "text": "- &#96;npm run db:studio&#96; - Open Drizzle Studio",
            "lineNumber": 102
          },
          {
            "text": "- &#96;npm run wp:import&#96; - Import WordPress content",
            "lineNumber": 103
          },
          {
            "lineNumber": 104
          },
          {
            "text": "## Environment Variables",
            "lineNumber": 105
          },
          {
            "lineNumber": 106
          },
          {
            "text": "See &#96;.env.local.example&#96; for required variables:",
            "lineNumber": 107
          },
          {
            "lineNumber": 108
          },
          {
            "text": "- &#96;DATABASE_URL&#96; - Postgres connection string",
            "lineNumber": 109
          },
          {
            "text": "- &#96;NEXTAUTH_SECRET&#96; - Auth secret (generate with &#96;openssl rand -base64 32&#96;)",
            "lineNumber": 110
          },
          {
            "text": "- &#96;OPENAI_API_KEY&#96; - For AI features",
            "lineNumber": 111
          },
          {
            "text": "- &#96;NEXTAUTH_URL&#96; - Site URL (http://localhost:3000 in dev)",
            "lineNumber": 112
          },
          {
            "lineNumber": 113
          },
          {
            "text": "## Deployment",
            "lineNumber": 114
          },
          {
            "lineNumber": 115
          },
          {
            "text": "### Deploy to Vercel",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "1. Push code to GitHub",
            "lineNumber": 118
          },
          {
            "text": "2. Import project in Vercel",
            "lineNumber": 119
          },
          {
            "text": "3. Add environment variables",
            "lineNumber": 120
          },
          {
            "text": "4. Deploy!",
            "lineNumber": 121
          },
          {
            "lineNumber": 122
          },
          {
            "text": "Vercel will auto-detect Next.js and configure everything.",
            "lineNumber": 123
          },
          {
            "lineNumber": 124
          },
          {
            "text": "## Documentation",
            "lineNumber": 125
          },
          {
            "lineNumber": 126
          },
          {
            "text": "See &#96;docs/wordpress_to_next.js_migration_plan.md&#96; for the full migration plan.",
            "lineNumber": 127
          },
          {
            "lineNumber": 128
          },
          {
            "text": "## License",
            "lineNumber": 129
          },
          {
            "lineNumber": 130
          },
          {
            "text": "Private",
            "lineNumber": 131
          }
        ]
      },
      "score": 0.23989629745483398
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/WORDPRESS_MIGRATION_PLAYBOOK.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 72
          }
        },
        "contents": "# WordPress to Next.js Migration Playbook\n\n&gt; Step-by-step guide for migrating WordPress sites to Next.js with Supabase  \n&gt; **Status:** In Progress | **Last Updated:** December 7, 2024\n\n---\n\n## Overview\n\nThis playbook documents the complete process of migrating a WordPress site to a modern Next.js stack. It's designed to be repeatable for future WordPress ‚Üí Next.js migrations.\n\n### Tech Stack\n- **Frontend:** Next.js 15 (App Router)\n- **Database:** Supabase (PostgreSQL)\n- **Storage:** Supabase Storage\n- **Hosting:** Vercel\n- **ORM:** Drizzle\n\n---\n\n## Pre-Migration Checklist\n\n- [x] Access to WordPress admin\n- [x] Access to WordPress hosting (Kinsta, WP Engine, etc.)\n- [x] Domain registrar access\n- [x] Supabase account created\n- [x] Vercel account created\n- [x] Local development environment set up\n\n---\n\n## Phase 1: Backup &amp; Archive ‚úÖ\n\n### 1.1 Create Static Archive\n&#96;&#96;&#96;bash\n# Mirror the entire WordPress site as static HTML\nwget --mirror --convert-links --adjust-extension --page-requisites \\\n  --no-parent --reject \"xmlrpc.php,wp-login.php,wp-admin/*\" \\\n  -e robots=off https://your-site.com/\n\n# Commit to a separate repo for safekeeping\ngit init\ngit add -A\ngit commit -m \"WordPress archive - $(date +%Y-%m-%d)\"\ngit remote add origin https://github.com/you/site-wordpress-archive.git\ngit push -u origin main\n&#96;&#96;&#96;\n\n**Automation opportunity:** Script that takes a domain and creates the archive repo automatically.\n\n### 1.2 Export URL List for Redirects\n&#96;&#96;&#96;bash\n# Extract all URLs from the mirrored site\nfind site.com -name \"*.html\" | sed 's|site.com||' | sed 's|/index.html||' | sort -u &gt; url_list.txt\n&#96;&#96;&#96;\n\n### 1.3 Download Full Backup from Host\n- Export database (&#96;.sql&#96; file)\n- Download &#96;wp-content&#96; folder\n- Store in local WordPress environment (Local by Flywheel)\n\n**Completed:** \n- Static archive: &#96;hiiiwav-wordpress-archive&#96; repo\n- Local WordPress: &#96;/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/&#96;\n\n---\n\n## Phase 2: Database Setup ‚úÖ\n\n### 2.1 Create Supabase Project\n1. Go to https://supabase.com/dashboard\n2. Create new project",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# WordPress to Next.js Migration Playbook",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "&gt; Step-by-step guide for migrating WordPress sites to Next.js with Supabase  ",
            "lineNumber": 3
          },
          {
            "text": "&gt; **Status:** In Progress | **Last Updated:** December 7, 2024",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "---",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "## Overview",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "This playbook documents the complete process of migrating a WordPress site to a modern Next.js stack. It's designed to be repeatable for future WordPress ‚Üí Next.js migrations.",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "### Tech Stack",
            "lineNumber": 12
          },
          {
            "text": "- **Frontend:** Next.js 15 (App Router)",
            "lineNumber": 13
          },
          {
            "text": "- **Database:** Supabase (PostgreSQL)",
            "lineNumber": 14
          },
          {
            "text": "- **Storage:** Supabase Storage",
            "lineNumber": 15
          },
          {
            "text": "- **Hosting:** Vercel",
            "lineNumber": 16
          },
          {
            "text": "- **ORM:** Drizzle",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "---",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "## Pre-Migration Checklist",
            "lineNumber": 21
          },
          {
            "lineNumber": 22
          },
          {
            "text": "- [x] Access to WordPress admin",
            "lineNumber": 23
          },
          {
            "text": "- [x] Access to WordPress hosting (Kinsta, WP Engine, etc.)",
            "lineNumber": 24
          },
          {
            "text": "- [x] Domain registrar access",
            "lineNumber": 25
          },
          {
            "text": "- [x] Supabase account created",
            "lineNumber": 26
          },
          {
            "text": "- [x] Vercel account created",
            "lineNumber": 27
          },
          {
            "text": "- [x] Local development environment set up",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "---",
            "lineNumber": 30
          },
          {
            "lineNumber": 31
          },
          {
            "text": "## Phase 1: Backup &amp; Archive ‚úÖ",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "text": "### 1.1 Create Static Archive",
            "lineNumber": 34
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 35
          },
          {
            "text": "# Mirror the entire WordPress site as static HTML",
            "lineNumber": 36
          },
          {
            "text": "wget --mirror --convert-links --adjust-extension --page-requisites \\",
            "lineNumber": 37
          },
          {
            "text": "  --no-parent --reject \"xmlrpc.php,wp-login.php,wp-admin/*\" \\",
            "lineNumber": 38
          },
          {
            "text": "  -e robots=off https://your-site.com/",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "# Commit to a separate repo for safekeeping",
            "lineNumber": 41
          },
          {
            "text": "git init",
            "lineNumber": 42
          },
          {
            "text": "git add -A",
            "lineNumber": 43
          },
          {
            "text": "git commit -m \"WordPress archive - $(date +%Y-%m-%d)\"",
            "lineNumber": 44
          },
          {
            "text": "git remote add origin https://github.com/you/site-wordpress-archive.git",
            "lineNumber": 45
          },
          {
            "text": "git push -u origin main",
            "lineNumber": 46
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "**Automation opportunity:** Script that takes a domain and creates the archive repo automatically.",
            "lineNumber": 49
          },
          {
            "lineNumber": 50
          },
          {
            "text": "### 1.2 Export URL List for Redirects",
            "lineNumber": 51
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 52
          },
          {
            "text": "# Extract all URLs from the mirrored site",
            "lineNumber": 53
          },
          {
            "text": "find site.com -name \"*.html\" | sed 's|site.com||' | sed 's|/index.html||' | sort -u &gt; url_list.txt",
            "lineNumber": 54
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 55
          },
          {
            "lineNumber": 56
          },
          {
            "text": "### 1.3 Download Full Backup from Host",
            "lineNumber": 57
          },
          {
            "text": "- Export database (&#96;.sql&#96; file)",
            "lineNumber": 58
          },
          {
            "text": "- Download &#96;wp-content&#96; folder",
            "lineNumber": 59
          },
          {
            "text": "- Store in local WordPress environment (Local by Flywheel)",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "**Completed:** ",
            "lineNumber": 62
          },
          {
            "text": "- Static archive: &#96;hiiiwav-wordpress-archive&#96; repo",
            "lineNumber": 63
          },
          {
            "text": "- Local WordPress: &#96;/Users/boskombp16/Local Sites/hiiiwav-wordpress-local/&#96;",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "---",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "## Phase 2: Database Setup ‚úÖ",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "### 2.1 Create Supabase Project",
            "lineNumber": 70
          },
          {
            "text": "1. Go to https://supabase.com/dashboard",
            "lineNumber": 71
          },
          {
            "text": "2. Create new project",
            "lineNumber": 72
          }
        ]
      },
      "score": 0.23850199580192566
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./app/login/page.tsx",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 92,
            "column": 1
          }
        },
        "contents": "'use client'\n\nimport { useState } from 'react'\nimport { signIn } from 'next-auth/react'\nimport { useRouter } from 'next/navigation'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n  const router = useRouter()\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault()\n    setError('')\n    setLoading(true)\n\n    try {\n      const result = await signIn('credentials', {\n        email,\n        password,\n        redirect: false,\n      })\n\n      if (result?.error) {\n        setError('Invalid email or password')\n      } else {\n        router.push('/admin/dashboard')\n        router.refresh()\n      }\n    } catch (err) {\n      setError('An error occurred')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "'use client'",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "import { useState } from 'react'",
            "lineNumber": 3
          },
          {
            "text": "import { signIn } from 'next-auth/react'",
            "lineNumber": 4
          },
          {
            "text": "import { useRouter } from 'next/navigation'",
            "lineNumber": 5
          },
          {
            "text": "import { Button } from '@/components/ui/button'",
            "lineNumber": 6
          },
          {
            "text": "import { Input } from '@/components/ui/input'",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "export default function LoginPage() {",
            "lineNumber": 9,
            "isSignature": true
          },
          {
            "text": "  const [email, setEmail] = useState('')",
            "lineNumber": 10
          },
          {
            "text": "  const [password, setPassword] = useState('')",
            "lineNumber": 11
          },
          {
            "text": "  const [error, setError] = useState('')",
            "lineNumber": 12
          },
          {
            "text": "  const [loading, setLoading] = useState(false)",
            "lineNumber": 13
          },
          {
            "text": "  const router = useRouter()",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "  async function handleSubmit(e: React.FormEvent) {",
            "lineNumber": 16
          },
          {
            "text": "    e.preventDefault()",
            "lineNumber": 17
          },
          {
            "text": "    setError('')",
            "lineNumber": 18
          },
          {
            "text": "    setLoading(true)",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "    try {",
            "lineNumber": 21
          },
          {
            "text": "      const result = await signIn('credentials', {",
            "lineNumber": 22
          },
          {
            "text": "        email,",
            "lineNumber": 23
          },
          {
            "text": "        password,",
            "lineNumber": 24
          },
          {
            "text": "        redirect: false,",
            "lineNumber": 25
          },
          {
            "text": "      })",
            "lineNumber": 26
          },
          {
            "lineNumber": 27
          },
          {
            "text": "      if (result?.error) {",
            "lineNumber": 28
          },
          {
            "text": "        setError('Invalid email or password')",
            "lineNumber": 29
          },
          {
            "text": "      } else {",
            "lineNumber": 30
          },
          {
            "text": "        router.push('/admin/dashboard')",
            "lineNumber": 31
          },
          {
            "text": "        router.refresh()",
            "lineNumber": 32
          },
          {
            "text": "      }",
            "lineNumber": 33
          },
          {
            "text": "    } catch (err) {",
            "lineNumber": 34
          },
          {
            "text": "      setError('An error occurred')",
            "lineNumber": 35
          },
          {
            "text": "    } finally {",
            "lineNumber": 36
          },
          {
            "text": "      setLoading(false)",
            "lineNumber": 37
          },
          {
            "text": "    }",
            "lineNumber": 38
          },
          {
            "text": "  }",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "  return",
            "lineNumber": 41
          },
          {
            "text": "}",
            "lineNumber": 93,
            "isSignature": true
          }
        ]
      },
      "score": 0.23580460250377655
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": "./docs/agents/content-agent.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 64
          }
        },
        "contents": "# Content Infrastructure Agent\n\n## Your Role\nYou are responsible for the data layer, content models, and CMS infrastructure for the HiiiWAV website.\n\n## Key Files\n- &#96;/lib/types.ts&#96; - TypeScript interfaces (YOU OWN THIS)\n- &#96;/db/&#96; - Database schema and migrations\n- &#96;/lib/&#96; - Utility functions and data access\n- &#96;/app/api/&#96; - API routes for content\n\n## Immediate Tasks\n\n### 1. Set Up Database Schema\nCreate Drizzle schema matching the TypeScript interfaces in &#96;/lib/types.ts&#96;:\n- &#96;funds&#96; table (for HiiiWAV 50)\n- &#96;projects&#96; table (OTW, Code Vibes, FEST)\n- &#96;joint_ventures&#96; table\n- &#96;people&#96; table\n- &#96;blog_posts&#96; table\n- &#96;events&#96; table\n- &#96;leads&#96; table (for AI concierge)\n\n### 2. Create Seed Data\nPopulate the database with initial data:\n- HiiiWAV 50 Fund details\n- 3 primary projects (OTW, Code Vibes, FEST)\n- 6 Joint Ventures (Choice Scores, Ryan Nicole, Prospect Band, Alphabet Rockers, Sol Affirmations, Soul Slappers)\n- Key people/artists\n\n### 3. Build Content API Routes\nCreate API routes for:\n- &#96;GET /api/projects&#96; - List all projects\n- &#96;GET /api/projects/[slug]&#96; - Get single project\n- &#96;GET /api/joint-ventures&#96; - List all JVs\n- &#96;GET /api/joint-ventures/[slug]&#96; - Get single JV\n- &#96;GET /api/people&#96; - List people\n- &#96;GET /api/blog&#96; - List blog posts\n\n### 4. Set Up MDX Pipeline\nConfigure MDX for blog posts and rich content:\n- Install and configure &#96;@next/mdx&#96; or &#96;contentlayer&#96;\n- Create &#96;/content/blog/&#96; directory structure\n- Add sample blog posts\n\n## Constraints\n- Use Drizzle ORM (already installed)\n- Follow interfaces in &#96;/lib/types.ts&#96; exactly\n- Don't rename core entities without human approval\n- Preserve relationships for RAG and cross-linking\n\n## Dependencies\n- None - you can start immediately\n\n## Handoffs\n- AI Agent will use your content APIs for RAG\n- Ops Agent will use your lead schema\n- Pages will fetch from your APIs\n\n## Reference\nAlways check &#96;/docs/website_plan.md&#96; Section 3.2 for content model specifications.",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# Content Infrastructure Agent",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "## Your Role",
            "lineNumber": 3
          },
          {
            "text": "You are responsible for the data layer, content models, and CMS infrastructure for the HiiiWAV website.",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "## Key Files",
            "lineNumber": 6
          },
          {
            "text": "- &#96;/lib/types.ts&#96; - TypeScript interfaces (YOU OWN THIS)",
            "lineNumber": 7
          },
          {
            "text": "- &#96;/db/&#96; - Database schema and migrations",
            "lineNumber": 8
          },
          {
            "text": "- &#96;/lib/&#96; - Utility functions and data access",
            "lineNumber": 9
          },
          {
            "text": "- &#96;/app/api/&#96; - API routes for content",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "## Immediate Tasks",
            "lineNumber": 12
          },
          {
            "lineNumber": 13
          },
          {
            "text": "### 1. Set Up Database Schema",
            "lineNumber": 14
          },
          {
            "text": "Create Drizzle schema matching the TypeScript interfaces in &#96;/lib/types.ts&#96;:",
            "lineNumber": 15
          },
          {
            "text": "- &#96;funds&#96; table (for HiiiWAV 50)",
            "lineNumber": 16
          },
          {
            "text": "- &#96;projects&#96; table (OTW, Code Vibes, FEST)",
            "lineNumber": 17
          },
          {
            "text": "- &#96;joint_ventures&#96; table",
            "lineNumber": 18
          },
          {
            "text": "- &#96;people&#96; table",
            "lineNumber": 19
          },
          {
            "text": "- &#96;blog_posts&#96; table",
            "lineNumber": 20
          },
          {
            "text": "- &#96;events&#96; table",
            "lineNumber": 21
          },
          {
            "text": "- &#96;leads&#96; table (for AI concierge)",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "### 2. Create Seed Data",
            "lineNumber": 24
          },
          {
            "text": "Populate the database with initial data:",
            "lineNumber": 25
          },
          {
            "text": "- HiiiWAV 50 Fund details",
            "lineNumber": 26
          },
          {
            "text": "- 3 primary projects (OTW, Code Vibes, FEST)",
            "lineNumber": 27
          },
          {
            "text": "- 6 Joint Ventures (Choice Scores, Ryan Nicole, Prospect Band, Alphabet Rockers, Sol Affirmations, Soul Slappers)",
            "lineNumber": 28
          },
          {
            "text": "- Key people/artists",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "### 3. Build Content API Routes",
            "lineNumber": 31
          },
          {
            "text": "Create API routes for:",
            "lineNumber": 32
          },
          {
            "text": "- &#96;GET /api/projects&#96; - List all projects",
            "lineNumber": 33
          },
          {
            "text": "- &#96;GET /api/projects/[slug]&#96; - Get single project",
            "lineNumber": 34
          },
          {
            "text": "- &#96;GET /api/joint-ventures&#96; - List all JVs",
            "lineNumber": 35
          },
          {
            "text": "- &#96;GET /api/joint-ventures/[slug]&#96; - Get single JV",
            "lineNumber": 36
          },
          {
            "text": "- &#96;GET /api/people&#96; - List people",
            "lineNumber": 37
          },
          {
            "text": "- &#96;GET /api/blog&#96; - List blog posts",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "### 4. Set Up MDX Pipeline",
            "lineNumber": 40
          },
          {
            "text": "Configure MDX for blog posts and rich content:",
            "lineNumber": 41
          },
          {
            "text": "- Install and configure &#96;@next/mdx&#96; or &#96;contentlayer&#96;",
            "lineNumber": 42
          },
          {
            "text": "- Create &#96;/content/blog/&#96; directory structure",
            "lineNumber": 43
          },
          {
            "text": "- Add sample blog posts",
            "lineNumber": 44
          },
          {
            "lineNumber": 45
          },
          {
            "text": "## Constraints",
            "lineNumber": 46
          },
          {
            "text": "- Use Drizzle ORM (already installed)",
            "lineNumber": 47
          },
          {
            "text": "- Follow interfaces in &#96;/lib/types.ts&#96; exactly",
            "lineNumber": 48
          },
          {
            "text": "- Don't rename core entities without human approval",
            "lineNumber": 49
          },
          {
            "text": "- Preserve relationships for RAG and cross-linking",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "## Dependencies",
            "lineNumber": 52
          },
          {
            "text": "- None - you can start immediately",
            "lineNumber": 53
          },
          {
            "lineNumber": 54
          },
          {
            "text": "## Handoffs",
            "lineNumber": 55
          },
          {
            "text": "- AI Agent will use your content APIs for RAG",
            "lineNumber": 56
          },
          {
            "text": "- Ops Agent will use your lead schema",
            "lineNumber": 57
          },
          {
            "text": "- Pages will fetch from your APIs",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "## Reference",
            "lineNumber": 60
          },
          {
            "text": "Always check &#96;/docs/website_plan.md&#96; Section 3.2 for content model specifications.",
            "lineNumber": 61
          }
        ]
      },
      "score": 0.2312028408050537
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="read_file_v2">
<details>
<summary>Tool use: **read_file_v2**</summary>


Parameters:

```json
{
  "targetFile": "lib/auth.ts",
  "charsLimit": 1000000,
  "effectiveUri": "lib/auth.ts"
}
```
Result:

```json
{
  "contents": "import NextAuth from 'next-auth'\nimport Credentials from 'next-auth/providers/credentials'\nimport { db } from '@/db'\nimport { users } from '@/db/schema'\nimport { eq } from 'drizzle-orm'\nimport { compare } from 'bcryptjs'\n\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n  providers: [\n    Credentials({\n      credentials: {\n        email: { label: 'Email', type: 'email' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          return null\n        }\n\n        const user = await db\n          .select()\n          .from(users)\n          .where(eq(users.email, credentials.email as string))\n          .limit(1)\n          .then((rows) =&gt; rows[0])\n\n        if (!user || !user.passwordHash) {\n          return null\n        }\n\n        const isValid = await compare(credentials.password as string, user.passwordHash)\n\n        if (!isValid) {\n          return null\n        }\n\n        return {\n          id: user.id.toString(),\n          email: user.email,\n          name: user.name,\n          role: user.role,\n        }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.role = (user as any).role\n        token.id = user.id\n      }\n      return token\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        (session.user as any).role = token.role as string\n        (session.user as any).id = token.id as string\n      }\n      return session\n    },\n  },\n  pages: {\n    signIn: '/login',\n  },\n})\n\n",
  "totalLinesInFile": 67
}
```
Status: **completed**


</details>
</tool-use>

---



---


Checking for a Supabase client utility:


---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** ‚Ä¢ Searched codebase "undefined" ‚Ä¢ **0** result in **1** directory</summary>

Directory: **undefined** (0 file)

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "createClient.*supabase",
  "caseInsensitive": true
}
```
Result:

```json
{
  "success": {
    "pattern": "createClient.*supabase",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/boskombp16/GitHub/hiiiwav-website": {
        "content": {
          "matches": [
            {
              "file": "./.specstory/history/2025-12-03_04-32Z-backing-up-and-migrating-wordpress-site.md",
              "matches": [
                {
                  "lineNumber": 2839,
                  "content": "+ import { createClient } from '@supabase/supabase-js'"
                },
                {
                  "lineNumber": 2853,
                  "content": "+ const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)"
                },
                {
                  "lineNumber": 3776,
                  "content": "+ import { createClient } from '@supabase/supabase-js'"
                },
                {
                  "lineNumber": 4008,
                  "content": "+ import { createClient } from '@supabase/supabase-js'"
                },
                {
                  "lineNumber": 4038,
                  "content": "+   const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {"
                },
                {
                  "lineNumber": 4318,
                  "content": "- const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)"
                },
                {
                  "lineNumber": 4320,
                  "content": "+ const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {"
                },
                {
                  "lineNumber": 4457,
                  "content": "  import { createClient } from '@supabase/supabase-js'"
                }
              ]
            },
            {
              "file": "./docs/WORDPRESS_MIGRATION_PLAYBOOK.md",
              "matches": [
                {
                  "lineNumber": 156,
                  "content": "import { createClient } from '@supabase/supabase-js'"
                }
              ]
            },
            {
              "file": "./scripts/migrate-images-to-supabase.ts",
              "matches": [
                {
                  "lineNumber": 17,
                  "content": "import { createClient } from '@supabase/supabase-js'"
                },
                {
                  "lineNumber": 34,
                  "content": "const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {"
                }
              ]
            },
            {
              "file": "./scripts/setup-supabase-storage.ts",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "import { createClient } from '@supabase/supabase-js'"
                },
                {
                  "lineNumber": 45,
                  "content": "  const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY, {"
                }
              ]
            },
            {
              "file": "./docs/dev-studio-README.md",
              "matches": [
                {
                  "lineNumber": 98,
                  "content": "import { createClient } from '@supabase/supabase-js';"
                },
                {
                  "lineNumber": 110,
                  "content": "import { createClient } from '@supabase/supabase-js';"
                },
                {
                  "lineNumber": 269,
                  "content": "import { createClient } from '@supabase/supabase-js';"
                }
              ]
            }
          ],
          "totalLines": 16,
          "totalMatchedLines": 16
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---



---


Creating the media gallery: API route to fetch images and an admin page to display them.


---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** ‚Ä¢ Todo List</summary>

- [-] Create API route to list all images from Supabase Storage
- [ ] Create media gallery page in admin section
- [ ] Add media gallery link to admin navigation

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>


Parameters:

```json
{
  "relativeWorkspacePath": "app/api/media/route.ts"
}
```
Additional data:

```json
{
  "codeblockId": "75b1c74f-ef63-4a26-ab93-60e231385e43"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>


Parameters:

```json
{
  "relativeWorkspacePath": "app/admin/media/page.tsx"
}
```
Additional data:

```json
{
  "codeblockId": "e7e22fb3-6372-4b2a-89a5-f9b55ed554c7"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>


Parameters:

```json
{
  "relativeWorkspacePath": "app/admin/layout.tsx"
}
```
Additional data:

```json
{
  "codeblockId": "5385a7f6-87d0-41c2-bf89-6c5e6ffc589f"
}
```
Status: **completed**


</details>
</tool-use>

---



---


Improving the API route to handle nested directories recursively:


---

<tool-use data-tool-type="unknown" data-tool-name="read_lints">
<details>
<summary>Tool use: **read_lints**</summary>


Parameters:

```json
{
  "paths": [
    "app/api/media/route.ts",
    "app/admin/media/page.tsx"
  ]
}
```
Result:

```json
{
  "linterErrorsByFile": [
    {
      "relativeWorkspacePath": "app/api/media/route.ts"
    },
    {
      "relativeWorkspacePath": "app/admin/media/page.tsx"
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>


Parameters:

```json
{
  "relativeWorkspacePath": "app/api/media/route.ts"
}
```
Additional data:

```json
{
  "codeblockId": "5a26360e-d575-4d30-a5d3-958d07eb8639"
}
```
Status: **completed**


</details>
</tool-use>

---



---


Simplifying the API route for better performance:


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>


Parameters:

```json
{
  "relativeWorkspacePath": "app/api/media/route.ts"
}
```
Additional data:

```json
{
  "codeblockId": "853b2782-ea41-4e1d-878e-669632f0d392"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** ‚Ä¢ Todo List</summary>

- [x] Create API route to list all images from Supabase Storage
- [x] Create media gallery page in admin section
- [x] Add media gallery link to admin navigation

</details>
</tool-use>

---



---


Created a media gallery for your admin section.

## What I Built:

1. **API Route** (`/app/api/media/route.ts`):
   - Lists all images from your Supabase Storage `uploads` bucket
   - Recursively searches subdirectories (up to 2 levels deep for WordPress year/month structure)
   - Returns image URLs, metadata, and file info

2. **Media Gallery Page** (`/app/admin/media/page.tsx`):
   - Grid view of all images
   - Search by filename or path
   - Hover to copy image URL to clipboard
   - Shows file size and name
   - Refresh button to reload images

3. **Admin Navigation**:
   - Added "Media Gallery" link to the admin sidebar

## Features:

- **Visual Grid**: Responsive grid layout (2-5 columns based on screen size)
- **Search**: Filter images by name or path
- **Copy URLs**: Hover over an image and click "Copy URL" to get the Supabase public URL
- **File Info**: Shows filename and file size on hover
- **Lazy Loading**: Images load as you scroll

Access it at `/admin/media` in your admin section. The gallery fetches all images from your Supabase Storage bucket and displays them for easy browsing and URL copying.

---

